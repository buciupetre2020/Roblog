[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Analize socio-economice cu R",
    "section": "",
    "text": "Posturi\n\n\n\nAbonare\n\n\n\nPrimiți notificări pe mail:\n\n     \n\n\n\n\n\n\n\n\n\n   \n     \n     \n       Order By\n       Default\n         \n          Title\n        \n         \n          Date - Oldest\n        \n         \n          Date - Newest\n        \n         \n          Author\n        \n     \n  \n    \n      \n      \n    \n\n\n\n\n\n\n\n\n\n\nDespre profitabilitatea multinaţionalelor\n\n\n\nmicroeconomice\n\n\n\nO încercare de inferenţă cauzală\n\n\n\nPetre Buciu\n\n\nAug 15, 2023\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFactorii determinaţi ai importurilor româneşti\n\n\n\ninput-output\n\n\n\nO analiză de tip input-output a importurilor din România\n\n\n\nPetre Buciu\n\n\nJun 27, 2023\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTiparele geografice ale mortalităţii infantile\n\n\n\ndemografie\n\n\nsociale\n\n\n\nÎn Europa\n\n\n\nPetre Buciu\n\n\nJun 17, 2023\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTiparele poluării cu dioxid de carbon în capitală\n\n\n\necologie\n\n\n\nCe factori explică variaţiile zilnice ale dioxidului de carbon ?\n\n\n\nPetre Buciu\n\n\nJun 16, 2023\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nO analiză a veniturilor bugetare în Europa\n\n\n\nmacroeconomice\n\n\nfiscalitate\n\n\n\nCare este structura veniturilor la buget\n\n\n\nPetre Buciu\n\n\nJun 13, 2023\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPovara fiscală conform OECD\n\n\n\nmacroeconomice\n\n\nfiscalitate\n\n\n\nCe povară fiscală suportă diferitele categorii de venituri în ţările OECD (şi nu numai)\n\n\n\nPetre Buciu\n\n\nJun 12, 2023\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nLa ce categorii de cheltuieli se remarcă România ?\n\n\n\nanaliza multivariată\n\n\nmacroeconomice\n\n\n\nO aplicaţie a analizei multivariate\n\n\n\nPetre Buciu\n\n\nJun 11, 2023\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCum au trecut firmele prin pandemie ?\n\n\n\nmicroeconomice\n\n\n\nO analiză sumară a bilanţurilor financiare depuse de firme în anii 2019-2021\n\n\n\nPetre Buciu\n\n\nJun 11, 2023\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCare este structura deficitului comercial al României ?\n\n\n\nmacroeconomice\n\n\nteoria retelelor\n\n\n\nO analiză a deficitului comercial\n\n\n\nPetre Buciu\n\n\nJun 7, 2023\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nGeografia excesului de mortalitate\n\n\n\nsociale\n\n\n\nÎn ce regiuni a lovit pandemia cel mai tare ?\n\n\n\nPetre Buciu\n\n\nJun 7, 2023\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nInegalitatea României în context european\n\n\n\ninegalitate\n\n\n\nPentru prima dată în ţara noastră\n\n\n\nPetre Buciu\n\n\nMay 28, 2023\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nDinamica datoriei publice în Europa\n\n\n\nmacroeconomice\n\n\n\nÎn toate țările a crescut datoria publică, iar România în rând cu media.\n\n\n\nPetre Buciu\n\n\nJun 3, 2021\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nDistribuția geografică a personalului medical\n\n\n\nsociale\n\n\n\nCum stăm cu Sănătatea în rural\n\n\n\nPetre Buciu\n\n\nJun 3, 2021\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCum și cât s-a construit în România în ultimii 30 de ani ?\n\n\n\nsociale\n\n\n\nO analiză pe datele de la INS\n\n\n\nPetre Buciu\n\n\nJun 2, 2021\n\n\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "posts/2023-05-28-inegalitea-romniei-n-context-european/inegalitea-romniei-n-context-european.html",
    "href": "posts/2023-05-28-inegalitea-romniei-n-context-european/inegalitea-romniei-n-context-european.html",
    "title": "Inegalitatea României în context european",
    "section": "",
    "text": "Cum a evoluat inegalitatea la noi\nUn nou set de date oferit de World Inequality Database ne permite să urmărim în timp şi spaţiu procentele de venit naţional care revine diferitelor percentile atât pre-taxare cât şi post-taxare. Datele au fost create conform metodologiei DINA (Distributional National Accounts).\n\n\nCode\nlibrary(tidyverse)\n\ntheme_set(hrbrthemes::theme_ipsum_tw(strip_text_size = 14, \n                                     strip_text_family = \"Roboto\",\n                                     strip_text_face = \"italic\",\n                                     axis_title_size = 12,\n                                     axis_text_size = 10,\n                                     base_family = \"Roboto\",\n                                     plot_title_family = \"Roboto\",\n                                     subtitle_family = \"Roboto\",\n                                     caption_family = \"Roboto\", \n                                     caption_size = 10,\n                                     plot_title_size = 16,\n                                     subtitle_size = 12) +\n  theme(legend.text = element_text(size=10), \n        legend.title = element_text(size=12),\n        legend.key.size = unit(0.5, \"cm\")))  #setam tema graficelor \n\n\ntari &lt;- read_delim(here::here(\"/home/petre/R/proiecte/taxare/Carte/database\", \"WID\", \"WID_countries.csv\"), \n                  delim=\";\") %&gt;% drop_na() %&gt;% filter(region==\"Europe\") %&gt;%\n        inner_join(read_csv(here::here(\"/home/petre/R/proiecte/taxare/Carte/database\", \"dictionar_tari.csv\")) %&gt;%\n                   rename(shortname=geo)) %&gt;% select(-shortname) %&gt;% \n        rename(geo=tari) %&gt;% select(-region) %&gt;% rename(region=region2)\n\nmetadata &lt;- read_delim(here::here(\"/home/petre/R/proiecte/taxare/Carte/database\", \"WID\", \n                                  \"WID_metadata_RO.csv\")) %&gt;%\n            select(variable, shortname, shorttype)\n\ndf &lt;- here::here(\"/home/petre/R/proiecte/taxare/Carte/database\", \"WID\", \n                 paste0(\"WID_data_\", tari$alpha2, \".csv\")) %&gt;%\n      map_dfr(., ~ read_delim(.x, delim=';') %&gt;% \n               rename(alpha2=country) %&gt;% \n               inner_join(tari %&gt;% select(-titlename)) %&gt;% \n               mutate(age=as.character(age)) %&gt;% \n               rename(country=alpha2)) %&gt;%\n               filter(year&gt;1989)\n\n\nProcentul din venitul naţional înaintea taxelor care revine diferitelor categorii de distribuţie este afişat în graficul următor:\n\n\nCode\ndf %&gt;% filter(grepl(\"sdiincj992|sptincj992\", variable)) %&gt;% \n  spread(variable, value) %&gt;% \n  filter(percentile%in%c(\"p0p20\", \"p0p50\", \"p90p100\", \"p99p100\")) %&gt;% \n  ggplot(aes(x=year, y=sptincj992, group=geo)) + \n  geom_line(aes(colour=geo), size=1) + \n  facet_wrap(~percentile, ncol=2, scales='free') + \n  gghighlight::gghighlight(geo%in%c(\"Romania\", \"Bulgaria\", \n                                    \"Polonia\", \"Ungaria\"),\n                           calculate_per_facet = T, use_direct_label = F) +\n  theme(legend.position = \"top\") + \n  labs(title=\"Distribuţia venitului naţional înaintea taxelor\", \n       subtitle=\"După distribuţie\", colour='Ţară', y=NULL, x=\"Anul\") +\n  scale_y_continuous(labels=scales::percent_format()) +\n  ggthemes::scale_color_tableau()\n\n\n\n\n\nŞi post-taxe:\n\n\nCode\ndf %&gt;% filter(grepl(\"sdiincj992|sptincj992\", variable)) %&gt;%\nspread(variable, value) %&gt;% filter(geo!=\"Cipru\") %&gt;%\nfilter(percentile%in%c(\"p0p10\", \"p0p50\", \"p90p100\", \"p99p100\")) %&gt;%\nggplot(aes(x=year, y=sdiincj992, group=geo)) +\ngeom_line(aes(colour=geo), size=1) +\nfacet_wrap(~percentile, ncol=2, scales='free') +\ngghighlight::gghighlight(geo%in%c(\"Romania\", \"Bulgaria\",\n                                  \"Polonia\", \"Ungaria\"),\n                         calculate_per_facet = T, use_direct_label = F) +\ntheme(legend.position = \"top\") +\nlabs(title=\"Distribuţia veniturilor naţionale după taxare\",\n     subtitle=\"După distribuţie\", colour='Ţară', y=NULL, x=\"Anul\") +\nscale_y_continuous(labels=scales::percent_format()) +\nggthemes::scale_color_tableau()\n\n\n\n\n\nRomânia, dar şi alte ţări din Europa de Est stau destul de rău la capitolul inegalitate, fiind în top atât înainte cât şi după taxe. În cazul României venitul revenit celor mai bogaţi 1 % din societate e totuşi mai scăzut după taxare, dar la categoria top 10 % situaţia e tot acută comparativ cu restul ţărilor europene. Probabil că avem o disproporţie din cadrul celor top 1 % care trăiesc din salarii versus capital, mai puţin taxat.\nVom calcula raportul dintre procentele de venit naţional care revin celor top 10 % şi ultimilor 50 % atât pentru venitul pre-taxe cât şi pentru venitul post-taxe. Cele două rapoarte vor fi pe axele x, respectiv y în graficul următor. Urmărim aceşti doi indicatori pentru media perioadei 2012-2021 (ultimii zece ani).\n\n\nCode\nratios &lt;- df %&gt;% \n    filter(grepl(\"adiincj992|aptincj992\", variable)) %&gt;% \n    filter(year&gt;1989, age==\"992\") %&gt;% select(-age, -pop) %&gt;%\n    spread(variable, value) %&gt;% \n    filter(percentile%in%c(\"p0p50\", \"p90p100\")) %&gt;% \n    pivot_wider(names_from=percentile, \n                values_from = c(adiincj992, aptincj992)) %&gt;% \n    mutate(ratio_pre = aptincj992_p90p100/aptincj992_p0p50, \n           ratio_post = adiincj992_p90p100/adiincj992_p0p50) %&gt;% \n    filter(year&gt;2011) %&gt;%\n    group_by(geo, region) %&gt;% \n    summarise(ratio_pre = mean(ratio_pre), \n              ratio_post=mean(ratio_post)) %&gt;% ungroup() \n\nratios %&gt;% filter(!geo%in%\"Lituania\") %&gt;% \n  ggplot(aes(x=ratio_pre, y=ratio_post)) + \n  geom_point(colour='red3') + \n  ggrepel::geom_text_repel(aes(label=geo)) + \n  labs(title=\"Raportul veniturilor pentru top 10% vs bottom 50%\", \n       subtitle=\"Media 2012-2021\", x=\"Pre-taxe\", y=\"Post-taxe\") + \n  geom_smooth(method='lm', linetype=2, fill=\"#EEA100\") \n\n\n\n\n\nObservăm că România are cel mai mare raport atât pre cât şi post taxare. Acest lucru sugerează că sistemul fiscal nu redistribuie suficient către cei din decilele inferioare ale distribuţiei. Acest lucru se întâmplă în ţara cu cea mai mare inegalitate din Europa dacă excludem Serbia (nu apare în imagine). Merită să calculăm şi procentele cu care sistemul fiscal reduce inegalitatea pre-taxe pentru fiecare ţară, media pe ultimii zece ani.\n\n\nCode\ndf %&gt;% \n    filter(grepl(\"adiincj992|aptincj992\", variable)) %&gt;% \n    filter(year &gt; 2011, age==\"992\") %&gt;% select(-age, -pop) %&gt;%\n    spread(variable, value) %&gt;% \n    group_by(country, percentile, region, geo) %&gt;%\n    summarise(across(adiincj992:aptincj992, mean)) %&gt;%\n    ungroup() %&gt;%\n    filter(percentile%in%c(\"p0p50\", \"p90p100\")) %&gt;% \n    pivot_wider(names_from=percentile, \n                values_from = c(adiincj992, aptincj992)) %&gt;% \n    mutate(ratio_pre = aptincj992_p90p100/aptincj992_p0p50, \n           ratio_post = adiincj992_p90p100/adiincj992_p0p50) %&gt;% \n    mutate(delta = 100*(ratio_pre - ratio_post)/ratio_pre) %&gt;% \n    select(geo, region, delta) %&gt;% \n    filter(!grepl(\"Cipru|Lituania\",geo)) %&gt;% \n    mutate(geo=fct_reorder(geo, delta)) %&gt;% \n    ggplot(aes(x=geo, y=delta)) + geom_col(fill=\"#EEA100\") + \n    theme(axis.text.x = element_text(angle=90, size=12)) +\n    labs(title=\"Reducerea inegalităţii pre-taxe de sistemul fiscal\", \n         x=\"Ţară\", subtitle=\"Media 2012 - 2021\", y=\"Procent (%)\", colour=\"Ţară\") +\n    scale_y_continuous(labels=scales::percent_format(scale=1)) \n\n\n\n\n\nObservăm că România se află printre ţările cu cele mai mici raporturi ale reducerii inegalităţii pre-taxe prin taxare. Combinaţia de inegalitate mare pre-taxare combinată cu redistribuţia scăzută duce la situaţia actuală. Procentele mici pentru Spania şi Italia nu trebuie să ne mire, întrucât aceste state cheltuiesc mult cu pensiile (populaţii îmbătrânite), lucru care uniformizează inegalitatea pre-taxe într-o oarecare măsură (inegalitatea pre-taxe este calculată conform autorilor ca venitul naţional revenit factorilor de producţie minus contribuţiile pentru pensii şi asigurări sociale plus distribuţiile pentru ele). Ele au oricum o inegalitate pre-taxe mai redusă în primul rând.\n\n\nMuncă sau capital ?\nMai este ceva interesant de văzut, dar folosim un alt (nou) set de date, de data aceasta de la Banca Mondială: taxarea efectivă a capitalului versus muncii. Practic cât la sută din venitul din cele două surse este plătit sub formă de taxe.\n\n\nCode\nread_csv(\"https://raw.githubusercontent.com/pierrebachas/Globalization_Factor_Taxation/main/globalETR_bfjz.csv\") %&gt;% \n  select(country_name, year, region, ETR_L, ETR_K) %&gt;% \n  filter(country_name%in%c(\"Romania\", \"Hungary\", \"Bulgaria\", \"Poland\", \"France\", \"Denmark\")) %&gt;% \n  gather(ETR_L:ETR_K, key=\"tax_rate\", value='valoare') %&gt;% \n  mutate(country_name=gsub(\"Poland\", \"Polonia\", country_name) %&gt;% \n                      gsub(\"Hungary\", \"Ungaria\", .) %&gt;% \n                      gsub(\"Denmark\", \"Danemarca\", .) %&gt;%\n                      gsub(\"France\", \"Franţa\", .)) %&gt;%\n  mutate(tax_rate = gsub(\"ETR_K\", \"Capital\", tax_rate) %&gt;% \n                    gsub(\"ETR_L\", \"Muncă\", .)) %&gt;% \n  ggplot(aes(x=year, y=valoare, group=tax_rate)) + \n  geom_line(aes(colour=tax_rate), size=1) + \n  facet_wrap(~country_name, ncol=2, scales='free') +\n  scale_y_continuous(labels=scales::percent_format(scale=100)) +\n  labs(title = \"Rata de taxare efectivă capital-muncă\", \n       subtitle=\"Sursa: Banca Mondială\",\n       x=\"Anul\", y=NULL, colour=\"Indicator\") +\n  theme(legend.position = \"top\") +\n  ggthemes::scale_color_tableau()\n\n\n\n\n\nObservăm că Franţa şi Danemarca taxează mai mult capitalul decât munca. Şi nu o duc rău deloc."
  },
  {
    "objectID": "posts/2021-06-03-dinamica-datoriei-publice-n-europa/dinamica-datoriei-publice-n-europa.html",
    "href": "posts/2021-06-03-dinamica-datoriei-publice-n-europa/dinamica-datoriei-publice-n-europa.html",
    "title": "Dinamica datoriei publice în Europa",
    "section": "",
    "text": "Datoria publică este un subiect controversat și creșterea recentă a datoriei publice a României este un fapt pus într-o anumită lumină de unii comentatori politici. Mai exact se caută prezentarea acestui fenomen ca și cum ar fi cauzat factori strict locali: voința partidului de la guvernare, “străinii”, UE, freza prim-ministrului, etc. Realitatea este că datoria publică a crescut peste tot în Europa, în mod universal, nicio țară nu a trecut prin anul 2020 fără să adauge la ponderea datoriei în PIB.\n\n\nCode\nlibrary(tidyverse)\nlibrary(hrbrthemes)\nlibrary(eurostat)\nlibrary(gt)\nlibrary(ggthemes)\n\ntheme_set(hrbrthemes::theme_ipsum_tw(strip_text_size = 14, \n                                     strip_text_family = \"Frutiger Bold\",\n                                     strip_text_face = \"italic\",\n                                     axis_title_size = 10,\n                                     axis_text_size = 8,\n                                     base_family = \"Frutiger\",\n                                     plot_title_family = \"Frutiger Bold\",\n                                     subtitle_family = \"Frutiger\",\n                                     caption_family = \"Frutiger\", \n                                     caption_size = 8,\n                                     plot_title_size = 14,\n                                     subtitle_size = 10) +\n  theme(legend.text = element_text(size=8), \n        legend.title = element_text(size=10),\n        legend.key.size = unit(0.5, \"cm\")))\n\n\n\n\nCode\nx &lt;- get_eurostat(id=\"teina230\") %&gt;% \n     label_eurostat() %&gt;% select(-1,-2) %&gt;% \n     filter(grepl(\"Percentage.+\", unit)) %&gt;% select(-1) %&gt;%\n     mutate(geo = gsub(\"\\\\(.+\\\\)|\\\\-.+$\", \"\", geo) %&gt;% trimws())\n\nx %&gt;% \n  ggplot(aes(x=time, y=values, group=geo)) + \n  geom_line(aes(colour=geo), size=1.2) + \n  gghighlight::gghighlight(grepl(\"Romania|European\", geo), \n                           use_direct_label = F) +\n  theme(legend.position = \"top\") + \n  labs(title = \"Datoria publică în Europa\", x=NULL, y=NULL, \n       colour=\"Regiune\", caption=\"Sursa: Eurostat, teina230\") + \n  scale_y_percent(scale=1) +\n  scale_colour_tableau()\n\n\n\n\n\n\n\n\n\nSă punem rezultatele și sub forma unui tabel. Delta măsoară diferența dintre procentele lunii octombrie (ultimul punct pentru care avem datele) 2021 față de aceeași lună a anului 2020. Avem astfel acoperită mare parte din perioada pandemiei și a măsurilor fiscale care au fost luate cu ocazia ei.\n\n\nCode\nx %&gt;% filter(grepl(\"-10-\", time)) %&gt;% \n  spread(time, values) %&gt;% \n  mutate(Delta = `2021-10-01`-`2020-10-01`) %&gt;% \n  arrange(desc(Delta)) %&gt;% select(-4) %&gt;%\n  gt::gt() %&gt;% gtExtras::gt_theme_538() %&gt;%\n  tab_header(title = \"Datoria publică în Europa\", \n             subtitle=\"Sursa: Eurostat, teina230\") %&gt;%\n  tab_style(cell_fill(color=\"#EEA100\"), cells_column_labels()) %&gt;%\n  gtExtras::gt_highlight_rows(rows=c(5, 13))\n\n\n\n\n\n\n  \n    \n      Datoria publică în Europa\n    \n    \n      Sursa: Eurostat, teina230\n    \n    \n      geo\n      2020-10-01\n      2021-10-01\n      Delta\n    \n  \n  \n    Czechia\n37.7\n42.0\n4.3\n    Slovakia\n58.9\n62.2\n3.3\n    Malta\n52.9\n55.1\n2.2\n    Latvia\n42.0\n43.7\n1.7\n    Romania\n46.9\n48.6\n1.7\n    Germany\n68.7\n69.3\n0.6\n    Luxembourg\n24.5\n24.5\n0.0\n    Bulgaria\n24.5\n23.9\n-0.6\n    Austria\n82.9\n82.3\n-0.6\n    Estonia\n18.5\n17.6\n-0.9\n    Euro area – 20 countries\n97.2\n95.5\n-1.7\n    Euro area\n97.3\n95.5\n-1.8\n    European Union\n90.0\n88.0\n-2.0\n    France\n115.0\n112.9\n-2.1\n    Finland\n74.7\n72.6\n-2.1\n    Spain\n120.4\n118.3\n-2.1\n    Netherlands\n54.7\n52.5\n-2.2\n    Lithuania\n46.3\n43.7\n-2.6\n    Hungary\n79.3\n76.6\n-2.7\n    Norway\n45.2\n42.5\n-2.7\n    Belgium\n112.0\n109.1\n-2.9\n    Ireland\n58.4\n55.4\n-3.0\n    Sweden\n39.8\n36.5\n-3.3\n    Poland\n57.2\n53.6\n-3.6\n    Italy\n154.9\n149.9\n-5.0\n    Slovenia\n79.6\n74.5\n-5.1\n    Denmark\n42.2\n36.7\n-5.5\n    Croatia\n87.0\n78.4\n-8.6\n    Portugal\n134.9\n125.4\n-9.5\n    Greece\n206.3\n194.6\n-11.7\n    Cyprus\n113.8\n101.2\n-12.6\n  \n  \n  \n\n\n\n\nRomânia ocupă locul al cincilea în acest tabel, din treizeci de țări disponibile. Se poate spune că creșterea ei, de doar 1.7 puncte procentuale, iese în evidență în peisaj european.\n\n\nCode\nx %&gt;% \n  filter(grepl(\"2021-10-|2020-10-\", time)) %&gt;% \n  spread(time, values) %&gt;% \n  mutate(delta = `2021-10-01`-`2020-10-01`) %&gt;% \n  mutate(geo = fct_reorder(geo, delta)) %&gt;% \n  ggplot(aes(x=geo, y=`2020-10-01`)) + \n  geom_point() + coord_flip() + \n  geom_point(aes(x=geo, y=`2021-10-01`), colour=\"red2\") + \n  geom_segment(aes(x=geo, xend=geo, y=`2020-10-01`, yend=`2021-10-01`), \n               colour=\"grey50\", arrow = arrow(angle=30, length = unit(2, \"mm\"))) +\n  labs(title = \"Datoria publică ca procent din PIB\", x=NULL, y=NULL, colour=\"Țară\")\n\n\n\n\n\n\n\n\n\nGraficul confirmă și vizual același lucru, dar mai greu de citit întrucât diferenţele sunt mici. Nu mai punem la socoteală că România a intrat în această perioadă și cu un deficit bugetar semnificativ."
  },
  {
    "objectID": "posts/2021-06-06-o-analiz-a-deficitului-comercial/o-analiz-a-deficitului-comercial.html",
    "href": "posts/2021-06-06-o-analiz-a-deficitului-comercial/o-analiz-a-deficitului-comercial.html",
    "title": "Care este structura deficitului comercial al României ?",
    "section": "",
    "text": "În acest post vom ilustra imaginea de ansamblu a deficitului comercial cu bunuri al României. Vom vedea ce exportăm, ce importăm, cu ce țări avem deficit, ce fel de firme se implică în acest proces, etc. Pentru început vom explora datele de la INS, foile EXP101F și EXP102F (exporturi FOB și importuri CIF) după grupele de mărfuri conform Nomenclatorului Combinat (NC). Acest lucru ne permite un grad superior de granularitate a analizei, întrucât datele sunt colectate la nivelul a peste 1000 de categorii de mărfuri. Să începem cu explorarea indicatorilor generali. Pentru început, trendurile exporturilor și importurilor totale, în valori absolute și procente din PIB.\n\n\nCode\nlibrary(tidyverse)\nlibrary(TEMPO)\nlibrary(eurostat)\nlibrary(ggraph)\nlibrary(tidygraph)\nlibrary(eurostat)\nlibrary(ggthemes)\n\ntheme_set(hrbrthemes::theme_ipsum_tw(strip_text_size = 14, \n                                     strip_text_family = \"Roboto\",\n                                     strip_text_face = \"italic\",\n                                     axis_title_size = 12,\n                                     axis_text_size = 10,\n                                     base_family = \"Roboto\",\n                                     plot_title_family = \"Roboto\",\n                                     subtitle_family = \"Roboto\",\n                                     caption_family = \"Roboto\", \n                                     caption_size = 10,\n                                     plot_title_size = 16,\n                                     subtitle_size = 12) +\n  theme(legend.text = element_text(size=10), \n        legend.title = element_text(size=12),\n        legend.key.size = unit(0.5, \"cm\")))  #setam tema graficelor \n\n\n#Descărcăm fișierele\n#tempo_bulk(codes=\"EXP101F\", directory = here::here(\"data/post-6\"))\n#tempo_bulk(codes=\"EXP102F\", directory=here::here(\"data/post-6\"))\n#tempo_bulk(codes=\"EXP101B\", directory = here::here(\"data/post-6\"))\n#tempo_bulk(codes=\"EXP102E\", directory=here::here(\"data/post-6\"))\n\n\n\n\nCode\nexp &lt;- read_csv(here::here(\"data/post-6/EXP101F.csv\")) %&gt;% \n       set_names(c(\"grupe\", \"ani\", \"valuta\", \"valoare\")) %&gt;% \n       filter(grepl(\"EURO\", valuta)) %&gt;% select(-valuta) %&gt;%\n       mutate(ani = parse_number(ani)) %&gt;% filter(ani&gt;1994) %&gt;%\n       rename(export=valoare)\n\nimp &lt;- read_csv(here::here(\"data/post-6/EXP102F.csv\")) %&gt;%\n       set_names(c(\"grupe\", \"ani\", \"valuta\", \"valoare\")) %&gt;%\n       filter(grepl(\"EURO\", valuta)) %&gt;% select(-valuta) %&gt;%\n       mutate(ani = parse_number(ani)) %&gt;% filter(ani&gt;1994) %&gt;%\n       rename(import=valoare)\n\npib &lt;- get_eurostat(id=\"nama_10_gdp\") %&gt;% label_eurostat() %&gt;%\n       filter(grepl(\"Current prices.+euro\", unit), \n              grepl(\"domestic product at\", na_item), geo==\"Romania\") %&gt;%\n       select(time, values) %&gt;% rename(ani=time, PIB=values) %&gt;%\n       mutate(ani = lubridate::year(ani)) %&gt;%\n       mutate(PIB = PIB*1000)\ntabel &lt;- inner_join(imp, exp) %&gt;% inner_join(pib)\n\n\n\n\nCode\ntabel %&gt;% \n  filter(grupe==\"Total\") %&gt;% \n  select(-grupe, -PIB) %&gt;% \n  gather(import:export, key=\"Indicator\", value=\"Valoare\") %&gt;% \n  mutate(Valoare=Valoare/1000000) %&gt;%\n  ggplot(aes(x=ani, y=Valoare, group=Indicator)) + \n  geom_line(aes(colour=Indicator), size=1.2) + \n  scale_color_discrete(direction=-1) +\n  labs(title = \"Valoarea importurilor/exporturilor\", x=NULL, \n       y=\"Miliarde EURO\", \n       caption=\"Sursa: Eurostat nama_10_gdp, INS EXP101F/102F\") +\n  hrbrthemes::scale_y_comma() +\n  ggthemes::scale_color_tableau()\n\n\n\n\n\n\n\n\n\n\n\nCode\ntabel %&gt;% \n  filter(grupe==\"Total\") %&gt;% \n  mutate_at(vars(import:export), ~100*./PIB) %&gt;% \n  select(-grupe, -PIB) %&gt;% \n  gather(import:export, key=\"Indicator\", value=\"Valoare\") %&gt;% \n  ggplot(aes(x=ani, y=Valoare, group=Indicator)) + \n  geom_line(aes(colour=Indicator), size=1.2) + \n  scale_color_discrete(direction=-1) +\n  labs(title = \"Procentul importurilor/exporturilor din PIB\", \n       x=NULL, y=NULL, \n       caption=\"Sursa: Eurostat nama_10_gdp, INS EXP101F/102F\") +\n  hrbrthemes::scale_y_percent(scale=1) +\n  scale_color_tableau()\n\n\n\n\n\n\n\n\n\nDin prima figură remarcăm o creștere susținută a ambilor indicatori, întreruptă temporar doar de Marea Criză din 2008-2009 și de criza coronavirus. Din a doua figură reiese că atât importurile cât și exporturile sunt undeva în jurul pragului de 35-40 % din PIB. Importurile au crescut însă ușor mai repede, mai ales în perioadele de creștere economică, cu cerere mare, astfel că deficitul comercial s-a adâncit începând cu anul 2015 după o perioadă de aparentă echilibrare.\n\n\nCode\ntabel %&gt;% \n  filter(grupe==\"Total\") %&gt;% \n  mutate_at(vars(import:export), ~100*./PIB) %&gt;% \n  select(-grupe, -PIB) %&gt;% \n  mutate(deficit = export - import) %&gt;%\n  ggplot(aes(x=ani, y=deficit)) + \n  geom_col(fill=\"#EEA100\") + \n  labs(title = \"Deficitul comercial\", subtitle=\"ca % din PIB\", \n       x=NULL, y=NULL, \n       caption=\"Sursa: Eurostat nama_10_gdp, INS EXP101F/102F\") +\n  hrbrthemes::scale_y_percent(scale=1)\n\n\n\n\n\n\n\n\n\nSă vedem niște topuri din anul 2022 pentru mărfuri, atât export cât și import. Vom ilustra rezultatele sub forma tabelului interactiv de mai jos.\n\n\nCode\ntabel %&gt;% \n  filter(grupe!=\"Total\", ani==2022) %&gt;% \n  arrange(desc(export)) %&gt;% select(-ani, -PIB) %&gt;% \n  rename(Grupe=grupe, Import=import, Export=export) %&gt;%\n  mutate(Deficit = Export - Import) %&gt;%\n  DT::datatable(extensions = 'Buttons', \n                options = list(dom = 'Bfrtip',\n                               buttons = c('copy', 'print', 'csv', 'pdf'))) %&gt;%\n  DT::formatRound(columns=2:4,digits=0) %&gt;%\n  DT::formatStyle(columns=1:4, fontSize: '80%')\n\n\n\n\n\n\n\nAstfel vedem că cel mai exportat bun produs de România sunt părțile și accesoriile de autovehicule, autoturismele, fire, cabluri, tablouri electrice, anvelope, grâu, porumb, iar la polul opus, deficitul cel mai mare se înregistrează pentru uleiuri din petrol, medicamente şi circuite integrate electronice. Toate cele peste 1000 de categorii sunt în acest tabel. Mai observăm că și la importuri pe prima poziție figurează autovehicule, întocmai ca la export. Importăm niște părți, exportăm părțile prelucrate, lucru tipic unei economii specializate în lanțuri cu valoarea adăugată mică. Pe poziția doi importăm medicamente, din nou autoturisme, uleiuri din petrol, telefoane, din nou fire și cabluri, circuite, etc. Analizând variabila Deficit din tabel observăm categoriile de mărfuri la care avem cel mai mare surplus: autoturisme, părți din autovehicule, tablouri, fire, anvelope, porumb, grâu, țigări de foi, tutun, dar și categoriile la care avem cel mai mare deficit: uleiul de petrol, medicamentele, etc. Aceste prime 10 categorii contribuie cu 52 % din deficitul comercial al României ! Doar autoturismele și părțile de autovehicule contribuie cu -26 % la deficitul comercial - adică îl ameliorează cu un sfert.\nPentru a descoperi creșterile disproporționate între grupe calculăm contribuțiile la deficitul comercial total pentru fiecare categorie și pentru fiecare an, alegem doi ani (unul e 2020, celălalt, de exemplu, 2010) și ordonăm grupele după cea mai mare diferență între contribuțiile din acești doi ani. În acest fel aflăm grupele care și-au crescut cel mai mult ponderea în deficit - fie pentru că se exportau și nu se mai exportă sau că erau importate și sunt importate și mai mult. Cea mai dramatică schimbare a avut loc pentru uleiurile din petrol, unde aveam o contribuție negativă de -6.9 % în 2010 și de doar -0.8 % în 2020. Din exportator net important a ajuns aproape echilibrat. La celălalt capăt avem tot uleuri de petrol (brute,de această dată) care și-au scăzut contribuția la deficit de la 26 % la doar 11 %. În acest fel această variație a ameliorat deficitul comercial total. Probabil că una este materie brută pentru cealaltă, care joacă rol de materie finită. Vom ilustra aceste rezultate tot sub forma unui tabel interactiv (cea mai bună formă pentru acest tip de date cu mult prea multe categorii și cu nume prea lungi pentru graficele convenționale).\n\n\nCode\ntabel %&gt;% \n    filter(grupe!=\"Total\") %&gt;% \n    arrange(desc(export)) %&gt;% select(-PIB) %&gt;% \n    rename(Grupe=grupe, Import=import, Export=export) %&gt;%\n    mutate(Deficit = Export - Import) %&gt;% \n    arrange(desc(Deficit)) %&gt;% group_by(ani) %&gt;% \n    mutate(ratio = 100*Deficit/sum(Deficit, na.rm=T)) %&gt;% \n    select(Grupe, ratio, ani) %&gt;% filter(ani%in%c(2010, 2020)) %&gt;% \n    spread(ani, ratio) %&gt;% mutate(delta = `2020`-`2010`) %&gt;% \n    arrange(desc(delta)) %&gt;% mutate_at(2:4, ~round(., digits=2)) %&gt;%\n    DT::datatable(extensions = 'Buttons', options = list(dom = 'Bfrtip', \n                  buttons = c('copy', 'print', 'csv', 'pdf'))) %&gt;%\n    DT::formatStyle(columns=1:4, fontSize: '80%')\n\n\n\n\n\n\n\nÎn concluzie, avem cele mai mari schimbări în sensul agravării deficitului comercial în uleiurile din petrol, pacheboturi, nave de croazieră, deșeuri și resturi de fontă, fier sau oțel, telefoane , încălțăminte, etc. Aceste produse în general se exportau și nu se mai exportă la fel de mult în 2020. La polul opus, în sensul ameliorării deficitului comercial avem cele mai mari variații tot în domeniul petrolier (materie brută), tablouri, console, dulapuri, părți de autovehicule, gaz de sondă, autoturisme, tutunul, construcțiile (poduri), cauciuc, etc. De departe cea mai mare amploare o au grupele aparținând petrolului."
  },
  {
    "objectID": "posts/2021-06-06-o-analiz-a-deficitului-comercial/o-analiz-a-deficitului-comercial.html#o-privire-de-ansamblu",
    "href": "posts/2021-06-06-o-analiz-a-deficitului-comercial/o-analiz-a-deficitului-comercial.html#o-privire-de-ansamblu",
    "title": "Care este structura deficitului comercial al României ?",
    "section": "",
    "text": "În acest post vom ilustra imaginea de ansamblu a deficitului comercial cu bunuri al României. Vom vedea ce exportăm, ce importăm, cu ce țări avem deficit, ce fel de firme se implică în acest proces, etc. Pentru început vom explora datele de la INS, foile EXP101F și EXP102F (exporturi FOB și importuri CIF) după grupele de mărfuri conform Nomenclatorului Combinat (NC). Acest lucru ne permite un grad superior de granularitate a analizei, întrucât datele sunt colectate la nivelul a peste 1000 de categorii de mărfuri. Să începem cu explorarea indicatorilor generali. Pentru început, trendurile exporturilor și importurilor totale, în valori absolute și procente din PIB.\n\n\nCode\nlibrary(tidyverse)\nlibrary(TEMPO)\nlibrary(eurostat)\nlibrary(ggraph)\nlibrary(tidygraph)\nlibrary(eurostat)\nlibrary(ggthemes)\n\ntheme_set(hrbrthemes::theme_ipsum_tw(strip_text_size = 14, \n                                     strip_text_family = \"Roboto\",\n                                     strip_text_face = \"italic\",\n                                     axis_title_size = 12,\n                                     axis_text_size = 10,\n                                     base_family = \"Roboto\",\n                                     plot_title_family = \"Roboto\",\n                                     subtitle_family = \"Roboto\",\n                                     caption_family = \"Roboto\", \n                                     caption_size = 10,\n                                     plot_title_size = 16,\n                                     subtitle_size = 12) +\n  theme(legend.text = element_text(size=10), \n        legend.title = element_text(size=12),\n        legend.key.size = unit(0.5, \"cm\")))  #setam tema graficelor \n\n\n#Descărcăm fișierele\n#tempo_bulk(codes=\"EXP101F\", directory = here::here(\"data/post-6\"))\n#tempo_bulk(codes=\"EXP102F\", directory=here::here(\"data/post-6\"))\n#tempo_bulk(codes=\"EXP101B\", directory = here::here(\"data/post-6\"))\n#tempo_bulk(codes=\"EXP102E\", directory=here::here(\"data/post-6\"))\n\n\n\n\nCode\nexp &lt;- read_csv(here::here(\"data/post-6/EXP101F.csv\")) %&gt;% \n       set_names(c(\"grupe\", \"ani\", \"valuta\", \"valoare\")) %&gt;% \n       filter(grepl(\"EURO\", valuta)) %&gt;% select(-valuta) %&gt;%\n       mutate(ani = parse_number(ani)) %&gt;% filter(ani&gt;1994) %&gt;%\n       rename(export=valoare)\n\nimp &lt;- read_csv(here::here(\"data/post-6/EXP102F.csv\")) %&gt;%\n       set_names(c(\"grupe\", \"ani\", \"valuta\", \"valoare\")) %&gt;%\n       filter(grepl(\"EURO\", valuta)) %&gt;% select(-valuta) %&gt;%\n       mutate(ani = parse_number(ani)) %&gt;% filter(ani&gt;1994) %&gt;%\n       rename(import=valoare)\n\npib &lt;- get_eurostat(id=\"nama_10_gdp\") %&gt;% label_eurostat() %&gt;%\n       filter(grepl(\"Current prices.+euro\", unit), \n              grepl(\"domestic product at\", na_item), geo==\"Romania\") %&gt;%\n       select(time, values) %&gt;% rename(ani=time, PIB=values) %&gt;%\n       mutate(ani = lubridate::year(ani)) %&gt;%\n       mutate(PIB = PIB*1000)\ntabel &lt;- inner_join(imp, exp) %&gt;% inner_join(pib)\n\n\n\n\nCode\ntabel %&gt;% \n  filter(grupe==\"Total\") %&gt;% \n  select(-grupe, -PIB) %&gt;% \n  gather(import:export, key=\"Indicator\", value=\"Valoare\") %&gt;% \n  mutate(Valoare=Valoare/1000000) %&gt;%\n  ggplot(aes(x=ani, y=Valoare, group=Indicator)) + \n  geom_line(aes(colour=Indicator), size=1.2) + \n  scale_color_discrete(direction=-1) +\n  labs(title = \"Valoarea importurilor/exporturilor\", x=NULL, \n       y=\"Miliarde EURO\", \n       caption=\"Sursa: Eurostat nama_10_gdp, INS EXP101F/102F\") +\n  hrbrthemes::scale_y_comma() +\n  ggthemes::scale_color_tableau()\n\n\n\n\n\n\n\n\n\n\n\nCode\ntabel %&gt;% \n  filter(grupe==\"Total\") %&gt;% \n  mutate_at(vars(import:export), ~100*./PIB) %&gt;% \n  select(-grupe, -PIB) %&gt;% \n  gather(import:export, key=\"Indicator\", value=\"Valoare\") %&gt;% \n  ggplot(aes(x=ani, y=Valoare, group=Indicator)) + \n  geom_line(aes(colour=Indicator), size=1.2) + \n  scale_color_discrete(direction=-1) +\n  labs(title = \"Procentul importurilor/exporturilor din PIB\", \n       x=NULL, y=NULL, \n       caption=\"Sursa: Eurostat nama_10_gdp, INS EXP101F/102F\") +\n  hrbrthemes::scale_y_percent(scale=1) +\n  scale_color_tableau()\n\n\n\n\n\n\n\n\n\nDin prima figură remarcăm o creștere susținută a ambilor indicatori, întreruptă temporar doar de Marea Criză din 2008-2009 și de criza coronavirus. Din a doua figură reiese că atât importurile cât și exporturile sunt undeva în jurul pragului de 35-40 % din PIB. Importurile au crescut însă ușor mai repede, mai ales în perioadele de creștere economică, cu cerere mare, astfel că deficitul comercial s-a adâncit începând cu anul 2015 după o perioadă de aparentă echilibrare.\n\n\nCode\ntabel %&gt;% \n  filter(grupe==\"Total\") %&gt;% \n  mutate_at(vars(import:export), ~100*./PIB) %&gt;% \n  select(-grupe, -PIB) %&gt;% \n  mutate(deficit = export - import) %&gt;%\n  ggplot(aes(x=ani, y=deficit)) + \n  geom_col(fill=\"#EEA100\") + \n  labs(title = \"Deficitul comercial\", subtitle=\"ca % din PIB\", \n       x=NULL, y=NULL, \n       caption=\"Sursa: Eurostat nama_10_gdp, INS EXP101F/102F\") +\n  hrbrthemes::scale_y_percent(scale=1)\n\n\n\n\n\n\n\n\n\nSă vedem niște topuri din anul 2022 pentru mărfuri, atât export cât și import. Vom ilustra rezultatele sub forma tabelului interactiv de mai jos.\n\n\nCode\ntabel %&gt;% \n  filter(grupe!=\"Total\", ani==2022) %&gt;% \n  arrange(desc(export)) %&gt;% select(-ani, -PIB) %&gt;% \n  rename(Grupe=grupe, Import=import, Export=export) %&gt;%\n  mutate(Deficit = Export - Import) %&gt;%\n  DT::datatable(extensions = 'Buttons', \n                options = list(dom = 'Bfrtip',\n                               buttons = c('copy', 'print', 'csv', 'pdf'))) %&gt;%\n  DT::formatRound(columns=2:4,digits=0) %&gt;%\n  DT::formatStyle(columns=1:4, fontSize: '80%')\n\n\n\n\n\n\n\nAstfel vedem că cel mai exportat bun produs de România sunt părțile și accesoriile de autovehicule, autoturismele, fire, cabluri, tablouri electrice, anvelope, grâu, porumb, iar la polul opus, deficitul cel mai mare se înregistrează pentru uleiuri din petrol, medicamente şi circuite integrate electronice. Toate cele peste 1000 de categorii sunt în acest tabel. Mai observăm că și la importuri pe prima poziție figurează autovehicule, întocmai ca la export. Importăm niște părți, exportăm părțile prelucrate, lucru tipic unei economii specializate în lanțuri cu valoarea adăugată mică. Pe poziția doi importăm medicamente, din nou autoturisme, uleiuri din petrol, telefoane, din nou fire și cabluri, circuite, etc. Analizând variabila Deficit din tabel observăm categoriile de mărfuri la care avem cel mai mare surplus: autoturisme, părți din autovehicule, tablouri, fire, anvelope, porumb, grâu, țigări de foi, tutun, dar și categoriile la care avem cel mai mare deficit: uleiul de petrol, medicamentele, etc. Aceste prime 10 categorii contribuie cu 52 % din deficitul comercial al României ! Doar autoturismele și părțile de autovehicule contribuie cu -26 % la deficitul comercial - adică îl ameliorează cu un sfert.\nPentru a descoperi creșterile disproporționate între grupe calculăm contribuțiile la deficitul comercial total pentru fiecare categorie și pentru fiecare an, alegem doi ani (unul e 2020, celălalt, de exemplu, 2010) și ordonăm grupele după cea mai mare diferență între contribuțiile din acești doi ani. În acest fel aflăm grupele care și-au crescut cel mai mult ponderea în deficit - fie pentru că se exportau și nu se mai exportă sau că erau importate și sunt importate și mai mult. Cea mai dramatică schimbare a avut loc pentru uleiurile din petrol, unde aveam o contribuție negativă de -6.9 % în 2010 și de doar -0.8 % în 2020. Din exportator net important a ajuns aproape echilibrat. La celălalt capăt avem tot uleuri de petrol (brute,de această dată) care și-au scăzut contribuția la deficit de la 26 % la doar 11 %. În acest fel această variație a ameliorat deficitul comercial total. Probabil că una este materie brută pentru cealaltă, care joacă rol de materie finită. Vom ilustra aceste rezultate tot sub forma unui tabel interactiv (cea mai bună formă pentru acest tip de date cu mult prea multe categorii și cu nume prea lungi pentru graficele convenționale).\n\n\nCode\ntabel %&gt;% \n    filter(grupe!=\"Total\") %&gt;% \n    arrange(desc(export)) %&gt;% select(-PIB) %&gt;% \n    rename(Grupe=grupe, Import=import, Export=export) %&gt;%\n    mutate(Deficit = Export - Import) %&gt;% \n    arrange(desc(Deficit)) %&gt;% group_by(ani) %&gt;% \n    mutate(ratio = 100*Deficit/sum(Deficit, na.rm=T)) %&gt;% \n    select(Grupe, ratio, ani) %&gt;% filter(ani%in%c(2010, 2020)) %&gt;% \n    spread(ani, ratio) %&gt;% mutate(delta = `2020`-`2010`) %&gt;% \n    arrange(desc(delta)) %&gt;% mutate_at(2:4, ~round(., digits=2)) %&gt;%\n    DT::datatable(extensions = 'Buttons', options = list(dom = 'Bfrtip', \n                  buttons = c('copy', 'print', 'csv', 'pdf'))) %&gt;%\n    DT::formatStyle(columns=1:4, fontSize: '80%')\n\n\n\n\n\n\n\nÎn concluzie, avem cele mai mari schimbări în sensul agravării deficitului comercial în uleiurile din petrol, pacheboturi, nave de croazieră, deșeuri și resturi de fontă, fier sau oțel, telefoane , încălțăminte, etc. Aceste produse în general se exportau și nu se mai exportă la fel de mult în 2020. La polul opus, în sensul ameliorării deficitului comercial avem cele mai mari variații tot în domeniul petrolier (materie brută), tablouri, console, dulapuri, părți de autovehicule, gaz de sondă, autoturisme, tutunul, construcțiile (poduri), cauciuc, etc. De departe cea mai mare amploare o au grupele aparținând petrolului."
  },
  {
    "objectID": "posts/2021-06-06-o-analiz-a-deficitului-comercial/o-analiz-a-deficitului-comercial.html#contextul-internaţional",
    "href": "posts/2021-06-06-o-analiz-a-deficitului-comercial/o-analiz-a-deficitului-comercial.html#contextul-internaţional",
    "title": "Care este structura deficitului comercial al României ?",
    "section": "Contextul internaţional",
    "text": "Contextul internaţional\nÎn acest capitol analizăm contextul internațional în care se realizează acest deficit comercial, mai precis țările cu care înregistrăm deficite și/sau excedente comerciale. În acest scop vom folosi datele de la INS - foile EXP101B și EXP102E (exporturi și importuri) care detaliază țările de origine pentru importurile și exporturile României. Vom vizualiza la final și rețeaua comerțului internațional în Europa, cu care avem în jur de trei sferturi din relațiile comerciale pentru a înțelege rolul și poziția României în această piață extinsă. Să începem prin a vizualiza cei mai importanți parteneri de export, respectiv import pentru România și balanța comercială după parteneri pentru anul 2020.\n\n\nCode\n#tempo_bulk(codes=c(\"EXP102G\"), directory=here::here(\"data/post-6\"))\nexp &lt;- read_csv(here::here(\"data/post-6/EXP101B.csv\")) %&gt;%\n       set_names(c(\"tari\", \"ani\", \"valuta\", \"valoare\")) %&gt;% \n       filter(tari!=\"Total\", grepl(\"EURO\", valuta)) %&gt;% \n       select(-valuta) %&gt;% mutate(ani = parse_number(ani)) %&gt;% \n       rename(export=valoare)\n\nimp &lt;- read_csv(here::here(\"data/post-6/EXP102E.csv\")) %&gt;%\n       set_names(c(\"tari\", \"ani\", \"valuta\", \"valoare\")) %&gt;% \n       filter(tari!=\"Total\", grepl(\"EURO\", valuta)) %&gt;% \n       select(-valuta) %&gt;% mutate(ani = parse_number(ani)) %&gt;% \n       rename(import=valoare)\n\nimp_2 &lt;- read_csv(here::here(\"data/post-6/EXP102G.csv\")) %&gt;%\n         set_names(c(\"tari\", \"ani\", \"valuta\", \"valoare\")) %&gt;% \n         filter(tari!=\"Total\", grepl(\"EURO\", valuta)) %&gt;% \n         select(-valuta) %&gt;% mutate(ani = parse_number(ani)) %&gt;% \n         rename(import=valoare)\n\nimp &lt;- imp %&gt;% bind_rows(imp_2)\ntabel &lt;- inner_join(exp, imp) %&gt;% mutate(delta = export-import) \n\n\n\n\nCode\ntabel %&gt;% mutate(export = export/1000) %&gt;%\n  filter(ani==2022) %&gt;% arrange(desc(export)) %&gt;% \n  slice(1:20) %&gt;% mutate(tari=fct_reorder(tari, export)) %&gt;% \n  ggplot(aes(x=tari, y=export)) + \n  geom_col(fill=\"#EEA100\") + coord_flip() + \n  hrbrthemes::scale_y_comma() +\n  labs(title = \"Cei mai importanți parteneri de export\",\n       subtitle=\"Pentru România\",\n       y=\"Milioane EURO\", x=NULL, \n       caption=\"Sursa: INS EXP101B/102E/102G\")\n\n\n\n\n\n\n\n\n\n\n\nCode\ntabel %&gt;% mutate(import = import/1000) %&gt;%\n  filter(ani==2022) %&gt;% arrange(desc(import)) %&gt;% \n  slice(1:20) %&gt;% mutate(tari=fct_reorder(tari, import)) %&gt;% \n  ggplot(aes(x=tari, y=import)) + \n  geom_col(fill=\"#EEA100\") + coord_flip() + hrbrthemes::scale_y_comma() +\n  labs(title = \"Cei mai importanți parteneri de import\",\n       subtitle=\"Pentru România\",\n       y=\"Milioane EURO\", x=NULL, caption=\"Sursa: INS EXP101B/102E/102G\")\n\n\n\n\n\n\n\n\n\n\n\nCode\ntabel %&gt;% rename(deficit=delta) %&gt;% mutate(deficit=deficit/1000) %&gt;%\n    filter(ani==2022) %&gt;% arrange(desc(abs(deficit))) %&gt;% \n    slice(1:20) %&gt;% mutate(tari=fct_reorder(tari, deficit)) %&gt;% \n    mutate(index = deficit&gt;0) %&gt;%\n    ggplot(aes(x=tari, y=deficit)) + \n    geom_col(aes(fill=index), show.legend = FALSE) + \n    coord_flip() + hrbrthemes::scale_y_comma() +\n    labs(title = \"Balanța comercială după parteneri\", \n         y=\"Milioane EURO\", x=NULL, caption=\"Sursa: INS EXP101B/102E/102G\") +\n    scale_fill_tableau()\n\n\n\n\n\n\n\n\n\nȚara cu care avem cel mai mare deficit comercial este, desigur, China. Și avem cel mai mare excedent comercial cu Regatul Unit. Avem deficite comerciale foarte mari și cu vecinii noștri, Ungaria și Polonia. Să vizualizăm rețeaua exporturilor europene pentru anul 2021, creată pe baza foii ext_tec03 din cadrul Eurostat, din care reiese că poziția României nu e una cu totul marginală. Suntem bine ancorați la hubul principal format din Germania, Franța și Italia. Culorile semnifică importanța nodurilor în rețea (centralitatea), de la albastru (important, central) spre roșu (marginal, periferic). Desigur, centralitatea unui nod în rețea nu este un concept cu totul bine definit, astfel că există diferite măsuri ale centralității, cu diferite rezultate în urma aplicării lor. Dar România rămâne consistent în categoria intermediară (nu galben-portocalie) pentru câteva măsuri importante. Cu cât suma este mai mică, cu atât săgețile sunt mai transparente. Selectăm doar cinci cele mai mari conexiuni pentru fiecare țară întrucât rețeaua și-ar pierde sensul - totul ar fi conectat cu totul.\n\n\nCode\ntec &lt;- get_eurostat(id=\"ext_tec03\") %&gt;%  \n       label_eurostat() %&gt;%\n       filter(grepl(\"Thousand\", unit)) %&gt;% select(-unit)\n\nnetwork &lt;- tec %&gt;%\n            filter(grepl(\"Total - all NACE\", nace_r2), \n                   grepl(\"2020\", time), stk_flow==\"Exports\") %&gt;%\n            select(geo, partner, values) %&gt;%\n            rename(from = geo,\n                   to = partner) %&gt;%\n            mutate(from = gsub(\"Germany.*\", \"Germany\", from),\n                   to = gsub(\"Germany.*\", \"Germany\", to)) %&gt;%\n            filter(!from%in%c(\"Cyprus\", \"Luxembourg\", \"Malta\", \"Ireland\")) %&gt;%\n            filter(to%in%from) \n\nretea_prel &lt;- network %&gt;% group_by(from) %&gt;%\n              arrange(desc(values)) %&gt;% top_n(5) %&gt;%\n              ungroup() %&gt;% tidygraph::as_tbl_graph()            \n  \nnetwork_plot &lt;- retea_prel %&gt;% \n                  activate(nodes) %&gt;%\n                  mutate(centralitatea1 = as.factor(round(centrality_eigen(),1)), centralitate = centrality_eigen()) %&gt;%\n                  ggraph(layout=\"fr\") + \n                  geom_edge_fan(aes(edge_alpha=values), \n                                arrow = arrow(length = unit(2, 'mm')), \n                  start_cap = circle(10, 'mm'),\n                  end_cap = circle(10, 'mm'), show.legend=FALSE) + \n                  geom_node_point(aes(colour=centralitatea1, \n                                      size=centralitate), \n                                  show.legend = F) + \n                  scale_color_tableau(type = \"ordered-sequential\", \n                                      palette = \"Green-Gold\") +\n                  geom_node_text(aes(label = name), size=2.8) + \n                  theme_graph() +\n                  theme(legend.key.height = unit(0.4, \"cm\"),\n                        legend.key.width = unit(0.4, \"cm\")) +\n                  scale_size_continuous(range=c(8, 24))\nnetwork_plot\n\n\n\n\n\n\n\n\n\nSă inspectăm și rețeaua deficitelor comerciale între țări.\n\n\nCode\n#deficite cu partenerii\ndeficite_network &lt;- tec %&gt;%\n            filter(grepl(\"Total - all NACE\", nace_r2), \n                   grepl(\"2020\", time)) %&gt;%\n            spread(stk_flow, values) %&gt;%\n            mutate(deficit = Exports - Imports) %&gt;%\n            select(geo, partner, deficit) %&gt;%\n            rename(from = geo,\n                   to = partner) %&gt;%\n            mutate(from = gsub(\"Germany.*\", \"Germany\", from),\n                   to = gsub(\"Germany.*\", \"Germany\", to)) %&gt;%\n            filter(!from%in%c(\"Cyprus\", \"Luxembourg\", \"Malta\", \"Ireland\")) %&gt;%\n            filter(to%in%from)\n\ndeficite_prel &lt;- deficite_network %&gt;%\n                group_by(from) %&gt;%\n                     arrange(((deficit))) %&gt;%\n                     filter(row_number() &lt;=5) %&gt;%\n                     ungroup() %&gt;%\n                as_tbl_graph()            \n  \ndeficite_net_plot &lt;- deficite_prel %&gt;% \n                  activate(nodes) %&gt;%\n                  mutate(centralitatea = as.factor(round(centrality_eigen(),1)), centralitate = centrality_eigen()) %&gt;%\n                  ggraph(layout=\"kk\") + \n                  geom_edge_fan(aes(edge_alpha=abs(deficit)), \n                                arrow = arrow(length = unit(3, 'mm')), \n                  start_cap = circle(10, 'mm'),\n                  end_cap = circle(10, 'mm'), show.legend=FALSE) + \n                  geom_node_point(aes(colour=centralitatea, \n                                      size=centralitate), show.legend = F) + \n                  scale_color_tableau(type=\"ordered-sequential\", \n                                      palette = \"Green-Gold\") +\n                  geom_node_text(aes(label = name), size=2.8) + \n                  theme_graph() +\n                  theme(legend.key.size=unit(0.4, \"cm\")) +\n                  scale_size_continuous(range=c(8, 24))\ndeficite_net_plot\n\n\n\n\n\n\n\n\n\nGraficul acesta trebuie interpretat în felul următor: direcția săgeții arată țara cu care ai deficit: România cu Germania, etc."
  },
  {
    "objectID": "posts/2021-06-06-o-analiz-a-deficitului-comercial/o-analiz-a-deficitului-comercial.html#caracteristicile-importatorilor-şi-exportatorilor-români",
    "href": "posts/2021-06-06-o-analiz-a-deficitului-comercial/o-analiz-a-deficitului-comercial.html#caracteristicile-importatorilor-şi-exportatorilor-români",
    "title": "Care este structura deficitului comercial al României ?",
    "section": "Caracteristicile importatorilor şi exportatorilor români",
    "text": "Caracteristicile importatorilor şi exportatorilor români\nÎn cele din urmă nicio analiză de acest fel nu poate fi completă fără o privire asupra firmelor implicate în comerțul internațional. Cât sunt ele de mari, ce capital au ? În acest sens avem datele de la INS, foile EXP101O și EXP102O pentru a investiga mărimea firmelor și EXP101R și EXP102R pentru tipul capitalului: românesc sau străin. În acest fel putem afla mai multe despre firmele care alcătuiesc prin activitatea lor economică acest deficit comercial. Să începem cu analiza după clasele de mărime ale firmelor exportatoare/importatoare.\n\n\nCode\n#TEMPO::tempo_bulk(codes=c(\"EXP101O\", \"EXP102O\", \"EXP101R\", \"EXP102R\"),\n#                  directory=here::here(\"data/post-6\"))\nfmimp &lt;- read_csv(here::here(\"data/post-6/EXP102O.csv\"))\nfmexp &lt;- read_csv(here::here(\"data/post-6/EXP101O.csv\"))\nfmimp %&gt;% \n  set_names(c(\"clase\", \"ani\", \"unitate\", \"valoare\")) %&gt;% \n  filter(clase!=\"Total\") %&gt;% mutate(ani = parse_number(ani)) %&gt;% \n  mutate(ani = paste0(ani, \"-01-01\") %&gt;% as.Date()) %&gt;%\n  ggplot(aes(x=ani, y=valoare, group=clase)) + \n  geom_line(aes(colour=clase), size=1.2) + \n  hrbrthemes::scale_y_comma() + \n  labs(title = \"Caracteristicile de mărime ale firmelor importatoare\", \n       x=NULL, y=NULL, caption=\"Sursa: INS EXP102O/EXP101O\") +\n  facet_wrap(~unitate, ncol=2, scales=\"free\") + \n  theme(legend.position=\"top\") +\n  scale_color_tableau()\n\n\n\n\n\n\n\n\n\nObservăm că deși majoritatea firmelor importatoare sunt cele mici (care sunt majoritare și în economia românească în general), la nivel de sumă majoritatea importurilor sunt făcute de firmele foarte puține numeric, dar cu peste 250 de salariați și, în mai mică măsură, cu 10-249 de salariați.\n\n\nCode\nfmexp %&gt;% \n  set_names(c(\"clase\", \"ani\", \"unitate\", \"valoare\")) %&gt;% \n  filter(clase!=\"Total\") %&gt;% mutate(ani = parse_number(ani)) %&gt;% \n  mutate(ani = paste0(ani, \"-01-01\") %&gt;% as.Date()) %&gt;%\n  ggplot(aes(x=ani, y=valoare, group=clase)) + \n  geom_line(aes(colour=clase), size=1.2) + \n  hrbrthemes::scale_y_comma() + \n  labs(title = \"Caracteristicile de mărime ale firmelor exportatoare\", \n       x=NULL, y=NULL, caption=\"Sursa: INS EXP101O/102O\") +\n  facet_wrap(~unitate, ncol=2, scales=\"free\") + \n  theme(legend.position=\"top\") +\n  scale_color_tableau()\n\n\n\n\n\n\n\n\n\nÎn privința firmelor exportatoare situația este similară, cu excepția faptului că firmele cu 10-249 salariați exportă în număr mai mare decât cele cu 0-4 salariați. Firmele mici sunt importatori la noi - peste 50.000 de firme importă, dar sub 10.000 exportă. În privința sumelor, fenomenul de concentrare este și mai accentuat, firmele cu peste 250 de salariați exportă mult mai mult decât celelalte. Să vedem și celalaltă caracteristică despre care avem date, naționalitatea capitalului.\n\n\nCode\n#tempo_bulk(codes=c(\"EXP102R\", \"EXP101R\"), directory=here::here(\"data/post-6\"))\nfcimp &lt;- read_csv(here::here(\"data/post-6/EXP102R.csv\"))\nfcexp &lt;- read_csv(here::here(\"data/post-6/EXP101R.csv\"))\n\nfcimp %&gt;% \n  set_names(c(\"capital\", \"ani\", \"unitate\", \"valoare\")) %&gt;% \n  filter(capital!=\"Total\") %&gt;% mutate(ani = parse_number(ani)) %&gt;% \n  mutate(ani = paste0(ani, \"-01-01\") %&gt;% as.Date()) %&gt;%\n  ggplot(aes(x=ani, y=valoare, group=capital)) + \n  geom_line(aes(colour=capital), size=1.2) + \n  hrbrthemes::scale_y_comma() + \n  labs(title = \"Caracteristicile de capital ale firmelor importatoare\", \n       x=NULL, y=NULL, caption=\"Sursa: INS EXP101R/102R\") +\n  facet_wrap(~unitate, ncol=2, scales=\"free\") + \n  theme(legend.position=\"top\") +\n  scale_color_tableau()\n\n\n\n\n\n\n\n\n\nObservăm că capitalul integral străin importă covârșitor în sumă, deși aceste firme sunt în număr foarte mic relativ la cele cu capital românesc.\n\n\nCode\nfcexp %&gt;% \n  set_names(c(\"capital\", \"ani\", \"unitate\", \"valoare\")) %&gt;% \n  filter(capital!=\"Total\") %&gt;% mutate(ani = parse_number(ani)) %&gt;% \n  mutate(ani = paste0(ani, \"-01-01\") %&gt;% as.Date()) %&gt;%\n  ggplot(aes(x=ani, y=valoare, group=capital)) + \n  geom_line(aes(colour=capital), size=1.2) + \n  hrbrthemes::scale_y_comma() + \n  labs(title = \"Caracteristicile de capital ale firmelor exportatoare\", \n       x=NULL, y=NULL, caption=\"Sursa: INS 101R/102R\") +\n  facet_wrap(~unitate, ncol=2, scales=\"free\") + \n  theme(legend.position=\"top\") +\n  scale_color_tableau()\n\n\n\n\n\n\n\n\n\nSituația este similară și pentru exportatori. Concluzia pe care o putem trage din aceste observații este că firmele românești sunt jucători relativ modești pe piața internațională, un procent mic exportă, foarte multe importă, dar grosul importurilor este făcut de capital străin mare, însă la fel stă treaba și pentru grosul exporturilor. S-ar putea face mai multe lucruri pentru a încuraja firmele românești să participe la export !"
  },
  {
    "objectID": "posts/2021-06-03-distribuia-geografic-a-personalului-medical/distribuia-geografic-a-personalului-medical.html",
    "href": "posts/2021-06-03-distribuia-geografic-a-personalului-medical/distribuia-geografic-a-personalului-medical.html",
    "title": "Distribuția geografică a personalului medical",
    "section": "",
    "text": "Câți medici avem în țară ? Unde există deficitul ? Vom folosi datele de la INS, mai precis foaia SAN104B, pentru a răspunde la aceste întrebări.\n\n\nCode\nlibrary(tidyverse)\nlibrary(sf)             #pentru harti si date spatiale\nlibrary(TEMPO)          #pentru a extrage datele de pe INS\nlibrary(gt)\nlibrary(ggthemes)\nlibrary(gtExtras)\nlibrary(hrbrthemes)     \n\n#tema graficelor\ntheme_set(hrbrthemes::theme_ipsum_tw(strip_text_size = 14, \n                                     strip_text_family = \"Roboto\",\n                                     strip_text_face = \"italic\",\n                                     axis_title_size = 12,\n                                     axis_text_size = 10,\n                                     base_family = \"Roboto\",\n                                     plot_title_family = \"Roboto\",\n                                     subtitle_family = \"Roboto\",\n                                     caption_family = \"Roboto\", \n                                     caption_size = 10,\n                                     plot_title_size = 16,\n                                     subtitle_size = 12) +\n  theme(legend.text = element_text(size=10), \n        legend.title = element_text(size=12),\n        legend.key.size = unit(0.5, \"cm\")))  #setam tema graficelor \n\n\n#descarcam foile SAN104B de pe INS:\n#TEMPO::tempo_bulk(codes=\"SAN104B\", directory = here::here(\"data/post-4\"))\n\nx &lt;- read_csv(here::here(\"data/post-4/SAN104B.csv\")) %&gt;%\n     set_names(c(\"Categorii\", \"Proprietate\", \"Judete\", \n                 \"Localitati\", \"Ani\", \"Numar\", \"Valoare\")) %&gt;% \n     mutate(Ani = parse_number(Ani)) %&gt;%  \n     mutate(Categorii = gsub(\"din total medici.+\", \n                             \"Medici familie\", Categorii)) %&gt;%\n     select(-Numar) %&gt;% \n     filter(!grepl(\"mixta\", Proprietate), Categorii!=\"Farmacisti\")\n\nharta &lt;- sf::read_sf(here::here(\"data\", \"post-2\", \"ro_uat_poligon.geojson\"))\nharta[grepl(\"Bucure.ti\", harta$name), \"natcode\"] &lt;- rep(\"179132\", 6)\n\n     \nx %&gt;% \n  filter(Localitati==\"TOTAL\", Judete==\"TOTAL\") %&gt;% \n  ggplot(aes(x=Ani, y=Valoare, group=Proprietate)) +\n  geom_line(aes(colour=Proprietate), size=1) +\n  facet_wrap(~Categorii, ncol=2, scales='free') +\n  labs(title = \"Personalul medico-sanitar în România\", x=NULL, y=NULL,\n       caption=\"Sursa: INS, SAN104B\") +\n  scale_y_comma() +\n  scale_color_tableau() +\n  theme(legend.position = \"top\")\n\n\n\n\n\n\n\n\n\nObservăm un trend general de creștere pentru personalul sanitar angajat în proprietatea privată pentru toate categoriile. În cazul medicilor de familie, numărul celor angajați în proprietate publică a scăzut accentuat după 2012-2013 ajungând în ultima perioadă la o valoare nesemnificativă. Categoria “Medici” trebuie interpretată ca totalul medicilor, incluzând și pe cei de familie. Aceste date pot fi puse și sub forma unui tabel.\n\n\nCode\nx %&gt;% \n  filter(Localitati==\"TOTAL\", Judete==\"TOTAL\") %&gt;% \n  filter(Ani%in%c(2003,2008,2013,2018)) %&gt;% \n  spread(Ani, Valoare) %&gt;% select(-Judete,-Localitati) %&gt;% arrange(desc(Proprietate)) %&gt;%\n  gt::gt(rowname_col = \"Categorii\", groupname_col = \"Proprietate\") %&gt;%\n  gtExtras::gt_theme_538() %&gt;%\n  gt::opt_table_font(font=\"Roboto\") %&gt;%\n  gt::cols_width(matches(\"[0-9]+\") ~ \"100px\") %&gt;%\n  gt::tab_stubhead(label = \"Categorii\") %&gt;%\n  gt::fmt_number(columns=2:6, sep_mark = \",\", decimals = 0) %&gt;%\n  gt::tab_style(style = cell_text(\"black\", weight = \"bold\"), \n                locations = cells_row_groups()) %&gt;%\n  gt::tab_style(style=cell_fill(color=\"#daae91\"), \n                locations=cells_row_groups()) %&gt;%\n  gt::tab_style(cell_text(color='black'), \n                locations=cells_column_labels()) %&gt;%\n  gt::tab_options(column_labels.background.color = \"#EEA100\") %&gt;%\n  gt::tab_header(subtitle = \"Sursa: INS, SAN104B\", \n                 title=\"Personal sanitar după forme de proprietate\") %&gt;%\n  gt::tab_style(cell_text(color='black', weight = \"bold\"), \n                cells_title(groups = \"title\")) %&gt;%\n  gt::tab_style(cell_text(weight='bold'), cells_column_labels())\n\n\n\n\n\n\n  \n    \n    \n    \n    \n    \n  \n  \n    \n      Personal sanitar după forme de proprietate\n    \n    \n      Sursa: INS, SAN104B\n    \n    \n      Categorii\n      2003\n      2008\n      2013\n      2018\n    \n  \n  \n    \n      Proprietate publica\n    \n    Medici\n42,538\n42,699\n40,058\n38,064\n    Medici familie\n9,623\n8,825\n6,682\n886\n    Personal sanitar mediu\n109,668\n112,321\n93,679\n94,355\n    Stomatologi\n4,919\n4,067\n2,809\n1,603\n    \n      Proprietate privata\n    \n    Medici\n4,381\n7,568\n14,028\n22,521\n    Medici familie\n1,811\n2,742\n6,054\n11,141\n    Personal sanitar mediu\n10,979\n20,143\n33,181\n50,962\n    Stomatologi\n4,528\n7,834\n11,473\n14,854\n  \n  \n  \n\n\n\n\nSă vizualizăm aceleași trenduri doar pentru medici însă pe medii de rezidență. Observăm că trendul constant pentru personalul medical angajat în proprietatea publică este de fapt unul divergent la nivel rural-urbal: pe când în municipii numărul lor a crescut ușor, în rural și urbanul mic el a scăzut, dând astfel un număr relativ constant la nivel național. În privința celor angajați în privat, trendul este de creștere pentru toate mediile, mai accentuat, desigur, pentru urbanul mare. Lecția acestui grafic: ne izbește procentul mic de medici și personal sanitar în general în mediul rural, proporția fiind și de 5-10 ori mai mică în rural față de urbanul mare.\n\n\nCode\nx &lt;- x %&gt;% \n  filter(Judete!=\"TOTAL\", Localitati!=\"TOTAL\") %&gt;% \n  mutate(natcode = parse_number(Localitati)) %&gt;%\n  mutate(mediu = str_extract(Localitati, \"ORAS|MUNICIPIUL\") %&gt;% \n                 replace_na(\"COMUNA\")) %&gt;% \n  mutate(natcode=as.character(natcode))\n\n\n\n\nCode\nx %&gt;% inner_join(harta) %&gt;%\n  group_by(Categorii, Proprietate, mediu, Ani) %&gt;% \n  summarise(total = 1000*sum(Valoare)/sum(pop2015)) %&gt;% ungroup() %&gt;% \n  filter(Categorii==\"Medici\") %&gt;% \n  ggplot(aes(x=Ani, y=total, group=mediu)) + \n  geom_line(aes(colour=mediu), size=1.2) + \n  facet_wrap(~Proprietate, ncol=2, scales='free') + \n  labs(title = \"Medici la 1000 de locuitori pe medii de rezidență\", \n       x=NULL, y=NULL, colour=\"Mediu\", caption=\"Sursa: INS, SAN104B\") +\n  scale_y_percent(suffix=\"‰\", scale = 1) +\n  scale_color_tableau() +\n  theme(legend.position = \"top\")\n\n\n\n\n\n\n\n\n\nSă repetăm același lucru și pentru medicii de familie și personalul sanitar mediu.\n\n\nCode\nx %&gt;% inner_join(harta) %&gt;%\n  group_by(Categorii, Proprietate, mediu, Ani) %&gt;% \n  summarise(total = 1000*sum(Valoare)/sum(pop2015)) %&gt;% ungroup() %&gt;% \n  filter(Categorii==\"Medici familie\") %&gt;% \n  ggplot(aes(x=Ani, y=total, group=mediu)) + \n  geom_line(aes(colour=mediu), size=1.2) + \n  facet_wrap(~Proprietate, ncol=2, scales='free') + \n  labs(title = \"Medici de familie pe medii de rezidență\", \n       x=NULL, y=NULL, colour=\"Mediu\", caption=\"Sursa: INS, SAN104B\") +\n  scale_y_continuous(labels= function(x) paste(x, \"‰\"))+\n  theme(legend.position=\"top\") +\n  scale_color_tableau() \n\n\n\n\n\n\n\n\n\n\n\nCode\nx %&gt;% inner_join(harta) %&gt;%\n  group_by(Categorii, Proprietate, mediu, Ani) %&gt;% \n  summarise(total = 1000*sum(Valoare)/sum(pop2015)) %&gt;% ungroup() %&gt;% \n  filter(grepl(\"Personal\", Categorii)) %&gt;% \n  ggplot(aes(x=Ani, y=total, group=mediu)) + \n  geom_line(aes(colour=mediu), size=1.2) + \n  facet_wrap(~Proprietate, ncol=2, scales=\"free\") + \n  labs(title = \"Personal sanitar mediu pe medii de rezidență\", \n       x=NULL, y=NULL, colour=\"Mediu\", caption='Sursa: INS, SAN104B') +\n  scale_y_percent(suffix=\"‰\", scale=1) +\n  theme(legend.position=\"top\") +\n  scale_color_tableau()\n\n\n\n\n\n\n\n\n\nÎn aceste două cazuri lucrurile stau simplu: trendurile sunt aceleași ca la nivel național.\n\n\nCode\nx %&gt;% \n  filter(Ani==2019, Judete!=\"TOTAL\", Localitati!=\"TOTAL\") %&gt;% \n  group_by(Categorii, Localitati, natcode) %&gt;% \n  summarise(total = sum(Valoare)) %&gt;% \n  ungroup() %&gt;% filter(Categorii==\"Medici\") %&gt;% \n  inner_join(harta) %&gt;% st_as_sf() %&gt;% mutate(total = 1000*total/pop2015) %&gt;%\n  mutate(total = cut_number(total, n=10)) %&gt;%\n  ggplot() + geom_sf(aes(fill=total), size=0.1) + \n  labs(title = \"Număr total medici la 1000 de locuitori\", fill=\"Total\") +\n  guides(guide_colorbar(height=unit(10, \"cm\"))) +\n  theme(plot.title = element_text(size=12), \n        axis.text.x = element_text(size=6), \n        axis.text.y = element_text(size=6),\n        legend.key.height = unit(0.4, \"cm\"),\n        legend.key.width = unit(0.4, \"cm\"),\n        legend.text = element_text(size=6)) +\n  scale_fill_tableau(palette=\"Classic Orange-Blue\", \n                     type='ordered-diverging')\n\n\n\n\n\n\n\n\n\nVedem 288 de localități fără niciun medic, public sau privat. Să le ordonăm după mărimea populației în următorul tabel.\n\n\nCode\nx %&gt;% \n    filter(Ani==2019, Judete!=\"TOTAL\", Localitati!=\"TOTAL\") %&gt;% \n    group_by(Categorii, Localitati, natcode) %&gt;% \n    summarise(total = sum(Valoare)) %&gt;% \n    ungroup() %&gt;% filter(Categorii==\"Medici\") %&gt;% \n    right_join(harta) %&gt;% filter(is.na(total)) %&gt;% \n    arrange(desc(pop2015)) %&gt;% .[-c(1:6),] %&gt;% select(name, county, pop2015) %&gt;%\n    rename(Populatie = pop2015, Localitate=name, Judet=county) %&gt;%\n    rmarkdown::paged_table()\n\n\n\n\n  \n\n\n\nȘi numărul de localități fără niciun medic după județe:\n\n\nCode\nx %&gt;% \n    filter(Ani==2019, Judete!=\"TOTAL\", Localitati!=\"TOTAL\") %&gt;% \n    group_by(Categorii, Localitati, natcode) %&gt;% \n    summarise(total = sum(Valoare)) %&gt;% \n    ungroup() %&gt;% filter(Categorii==\"Medici\") %&gt;% \n    right_join(harta) %&gt;% filter(is.na(total)) %&gt;% \n    arrange(desc(pop2015)) %&gt;% .[-c(1:6),] %&gt;% \n    select(name, county, pop2015) %&gt;% count(county, sort=T) %&gt;% \n    mutate(county=fct_reorder(county, n)) %&gt;% slice(1:15) %&gt;% \n    ggplot(aes(x=county, y=n)) + \n    geom_col(fill=\"#EEA100\") + coord_flip() + \n    labs(title = \"Numărul de localități fără niciun medic\", x=NULL, y=NULL, \n         caption='Sursa: INS, SAN104B')\n\n\n\n\n\n\n\n\n\nVedem că cele mai multe sunt în Hunedoara, Buzău, Vaslui."
  },
  {
    "objectID": "posts/2023-06-11-la-ce-categorii-de-cheltuieli-se-remarca-romania/la-ce-categorii-de-cheltuieli-se-remarca-romania.html",
    "href": "posts/2023-06-11-la-ce-categorii-de-cheltuieli-se-remarca-romania/la-ce-categorii-de-cheltuieli-se-remarca-romania.html",
    "title": "La ce categorii de cheltuieli se remarcă România ?",
    "section": "",
    "text": "PCA înseamnă Analiza componentelor principale, o metodă din cadrul statisticii multivariate, înrudită cu analiza factorială, care încearcă să descopere axe/dimensiuni (de obicei două, ca o hartă 2D) pe care poţi proiecta un set de date cu mai multe variabile astfel încât distorsia să fie minimă. E doar un fel de a vedea acestă metodă. Mai există şi alte interpretări echivalente. Axele respective sunt combinaţii liniare ale variabilelor originale astfel, coeficienţii liniari fiind aleşi în aşa fel încât varianţa datelor originale este prezervată la maximum posibil (date fiind constrângerile liniare) în noile axe. Tehnic vorbind, ea este eigen-decompoziţia matricei de covarianţă a datelor sau de corelaţie, după caz. Dacă se foloseşte matricea de corelaţie acest lucru este echivalent cu a standardiza datele înainte de eigen-decompoziţiei. Vă puteţi gândi la ea ca la o hartă care vă permite să vedeţi în mai multe dimensiuni proximitatea observaţiilor."
  },
  {
    "objectID": "posts/2023-06-11-la-ce-categorii-de-cheltuieli-se-remarca-romania/la-ce-categorii-de-cheltuieli-se-remarca-romania.html#o-introducere-în-pca",
    "href": "posts/2023-06-11-la-ce-categorii-de-cheltuieli-se-remarca-romania/la-ce-categorii-de-cheltuieli-se-remarca-romania.html#o-introducere-în-pca",
    "title": "La ce categorii de cheltuieli se remarcă România ?",
    "section": "",
    "text": "PCA înseamnă Analiza componentelor principale, o metodă din cadrul statisticii multivariate, înrudită cu analiza factorială, care încearcă să descopere axe/dimensiuni (de obicei două, ca o hartă 2D) pe care poţi proiecta un set de date cu mai multe variabile astfel încât distorsia să fie minimă. E doar un fel de a vedea acestă metodă. Mai există şi alte interpretări echivalente. Axele respective sunt combinaţii liniare ale variabilelor originale astfel, coeficienţii liniari fiind aleşi în aşa fel încât varianţa datelor originale este prezervată la maximum posibil (date fiind constrângerile liniare) în noile axe. Tehnic vorbind, ea este eigen-decompoziţia matricei de covarianţă a datelor sau de corelaţie, după caz. Dacă se foloseşte matricea de corelaţie acest lucru este echivalent cu a standardiza datele înainte de eigen-decompoziţiei. Vă puteţi gândi la ea ca la o hartă care vă permite să vedeţi în mai multe dimensiuni proximitatea observaţiilor."
  },
  {
    "objectID": "posts/2023-06-11-la-ce-categorii-de-cheltuieli-se-remarca-romania/la-ce-categorii-de-cheltuieli-se-remarca-romania.html#cheltuielile-statelor-europene",
    "href": "posts/2023-06-11-la-ce-categorii-de-cheltuieli-se-remarca-romania/la-ce-categorii-de-cheltuieli-se-remarca-romania.html#cheltuielile-statelor-europene",
    "title": "La ce categorii de cheltuieli se remarcă România ?",
    "section": "2 Cheltuielile statelor europene",
    "text": "2 Cheltuielile statelor europene\nStatele europene şi în general cele din lume cheltuie bani pe o sumedenie de lucruri, clasificate în multe categorii astfel că e greu să ai o idee cât de similare sunt ţările între ele după acest aspect. Şi, mai ales, care din categorii/variabile explică această similaritate. PCA poate face chiar acest lucru: o hartă a similarităţii traduse în proximitate plus explicaţii care justifică aceste proximităţi. Acest aspect dual al metodologiei PCA este ilustrat sub forma unui biplot: axele - harta similarităţii între observaţii, săgeţile (în cazul nostru albastre), direcţiile spre care cresc categoriile respective. Astfel, dacă România e în direcţia, să zicem, a cheltuielilor cu apărarea şi în sensul opus al săgeţii care indică cheltuieli sociale, interpretăm acest lucru în sensul că România cheltuie disproporţionat pe apărare şi mai puţin pe statul social luând în seamă tot setul nostru de observaţii. Sigur, matematic e mai complicat de atât, dar de foarte multe ori regula aceasta se menţine şi ajută interpretarea."
  },
  {
    "objectID": "posts/2023-06-11-la-ce-categorii-de-cheltuieli-se-remarca-romania/la-ce-categorii-de-cheltuieli-se-remarca-romania.html#profile-de-ţări-după-cheltuieli",
    "href": "posts/2023-06-11-la-ce-categorii-de-cheltuieli-se-remarca-romania/la-ce-categorii-de-cheltuieli-se-remarca-romania.html#profile-de-ţări-după-cheltuieli",
    "title": "La ce categorii de cheltuieli se remarcă România ?",
    "section": "3 Profile de ţări după cheltuieli",
    "text": "3 Profile de ţări după cheltuieli\nAcum vom descărca setul de date de la Eurostat gov_10a_exp şi vom selecta toate categoriile de cheltuieli ca procent din PIB. Setul e enorm, are 32 de milioane de linii de tabel. Sunt peste 70 de categorii de cheltuieli detaliate după funcţie şi cont (salarii, capital, transferuri, total, etc). De asemenea, pentru robusteţe vom face media ultimilor 5 ani disponibili, pentru a nu surprinde vreo variaţie întâmplătoare şi tranzitorie. Nu vom opta pentru toate subcategoriile, întrucât doresc să studiez şi clasificările după conturi, ci doar pentru cele 10 agregate largi, fiecare subîmpărţită în cheltuieli de capital, salarii şi total. Deci în total 30 de variabile pentru 30 de ţări plus media UE.\n\n\nCode\nlibrary(tidyverse)\nlibrary(eurostat)\nlibrary(hrbrthemes)\nlibrary(ggthemes)\nlibrary(gt)\nlibrary(gtExtras)\ntheme_set(hrbrthemes::theme_ipsum_tw(strip_text_size = 14, \n                                     strip_text_family = \"Roboto\",\n                                     strip_text_face = \"italic\",\n                                     axis_title_size = 12,\n                                     axis_text_size = 10,\n                                     base_family = \"Roboto\",\n                                     plot_title_family = \"Roboto\",\n                                     subtitle_family = \"Roboto\",\n                                     caption_family = \"Roboto\", \n                                     caption_size = 10,\n                                     plot_title_size = 16,\n                                     subtitle_size = 12) +\n  theme(legend.text = element_text(size=10), \n        legend.title = element_text(size=12),\n        legend.key.size = unit(0.5, \"cm\")))  #setam tema graficelor \n\n\n\n\nCode\n# funcţia care ne calculează şi afişează biplotul\nbiplot &lt;- function(mat, p=1, clusters=4, k=15, scale=TRUE){\n  x &lt;- mat[,apply(mat, MARGIN=2, FUN=mean)&gt;p, drop=F] %&gt;% colnames()\n  pca &lt;- prcomp(mat, scale=scale)\n  procent &lt;- pca$sdev^2/sum(pca$sdev^2)\n  procent &lt;- paste(round(100*procent[1:2], 1), \"%\")\n  rot &lt;- as_tibble(pca$rotation, rownames=\"var\") %&gt;% filter(var%in%x)\n  model &lt;- kmeans(pca$x[,1:2], centers=clusters)$cluster\n  coords &lt;- as_tibble(pca$x, rownames=\"geo\") %&gt;%\n    mutate(cluster = as.factor(model))\n  ggplot(coords, aes(x=PC1, y=PC2)) + \n    ggConvexHull::geom_convexhull(aes(x=PC1, y=PC2, group=cluster, fill=cluster), alpha=0.2) +\n    geom_point(colour='red3') + \n    ggrepel::geom_text_repel(aes(label=geo),nudge_y=0.3, max.overlaps = 10, size=3) +\n    geom_vline(xintercept = 0,linetype=2) +\n    geom_hline(yintercept=0, linetype=2) +\n    geom_segment(data=rot, aes(xend=k*PC1, x=0, yend=k*PC2, y=0), \n                 arrow = arrow(length = unit(0.25, \"cm\")), colour='steelblue4', alpha=0.9) +\n    ggrepel::geom_text_repel(data=rot, aes(label=var,x=k*PC1, y=k*PC2), \n                             alpha=0.9, colour='steelblue4', size=2.7) +\n    labs(title=\"PCA - Biplot\", subtitle=\"Componentele principale ale cheltuielilor COFOG99 pe 2017-2021\", \n         x=paste0(\"Dim1 (\", procent[1], \")\"), y=paste0(\"Dim2 (\", procent[2],\")\")) +\n    theme(axis.title = element_text(size=14)) +\n    scale_fill_tableau()\n  \n}\n\n\n\n\nCode\n#x &lt;- get_eurostat(id='gov_10a_exp') %&gt;%\n #    filter(grepl(\"^PC_GDP\", unit)) %&gt;% select(-unit) %&gt;%\n  #   filter(sector==\"S13\", na_item%in%c(\"TE\", \"D1\", \"P5\")) %&gt;% \n   #  select(-sector) %&gt;%\n    # filter(grepl(\"^GF[0-9]{2}$\", cofog99)) %&gt;%\n    # label_eurostat(fix_duplicated = TRUE) %&gt;%\n    # inner_join(read_csv(here::here(\"data\", \"dictionar_tari.csv\"))) %&gt;%\n    # select(-geo) %&gt;% rename(geo=tari) %&gt;%\n    # filter(time&gt;\"2016-01-01\") %&gt;% \n    # group_by(cofog99, na_item, geo) %&gt;% \n    # summarise(values=mean(values, na.rm=TRUE)) %&gt;% ungroup() %&gt;%\n    # mutate(na_item = gsub(\"Compensation.+\", \"S\", na_item) %&gt;% \n     #                 gsub(\"Gross.+\", \"C\", .) %&gt;% \n    #                  gsub(\"Total.+\", \"T\", .)) \n\n# write_csv(\"data/post-7/cofog.csv\")\n\nx &lt;- read_csv(here::here(\"data/post-7\", \"cofog.csv\"))\n\nmat &lt;- x %&gt;%\n     mutate(variable = paste0(cofog99, \"_\", na_item)) %&gt;%\n     select(-cofog99, -na_item) %&gt;% spread(variable, values) %&gt;%\n     column_to_rownames(\"geo\") \n\n\nCele treizeci de variabile se transformă într-o hartă a simitudinilor dintre ţări în biplotul din Figure 1.\n\n\nCode\nbiplot(mat, p=0.5, clusters=5, k=10, scale=TRUE)\n\n\n\n\n\nFigure 1: Biplot cu cheltuieli bugetare\n\n\n\n\nHarta e grăitoare în modul în care clasifică ţările în clusteri (după metoda uzuală k-means). Suntem alături de colegii bulgari la capătul extrem pozitiv al axei 1 (orizontala) care explică 20 % din variaţia originală a setului, direcţie corelată pozitiv cu cheltuieli de apărare şi ordine publică (poliţie, jandarmerie, etc) în special salariile din sectorul apărării şi ordinii publice (sufixul _S de la salarii). Danemarca, Finlanda, Suedia sunt la capătul opus al axei, înspre direcţia cheltuielilor cu asistenţa socială, educaţie, sănătate, lucru pe care-l cunoaştem deja şi ni-l confirmăm suplimentar aici. Ne putem gândi la această axă orizontală, principală, ca la axa progresist-reacţionar. La capătul drept sunt statele “de dreapta” - reacţionare, care investesc în poliţie şi armată, pe când la capătul stâng sunt statele progresiste care investesc în societate. Am descoperit din datele brute o axă care se transpune direct în ideologia politică stânga-dreapta economic. Axa a doua este mai greu de interpretat: direcţia de jos e corelată cu subvenţiile (economic affairs), direcţie de sus nu e corelată cu nimic în sens pozitiv, doar uşor cu cheltuielile totale în protecţia socială (numai parţial), ci doar negativ tot cu subvenţiile şi cheltuielile de cultură. E o axă a valorilor materiale mai mult, deşi este doar o părere subiectivă şi poate suprainterpretez. De asemenea, corelaţiile dintre variabilele originale şi unghiul dintre săgeţi se respectă mai bine când procentul de varianţă explicată e mai mare (valoarea din textul axelor). Altminteri corespundenţele vor fi doar aproximative. Pentru a aproxima corelaţiile originale s-ar putea să fie nevoie de mai multe axe, dar vor fi mai greu de vizualizat. În cazul nostru trei axe ar explica 50 % din variabilitatea datelor originale versus 37 % (20 orizontala, 17 verticala) cu două, cum avem aici.\nDar să mergem mai departe şi să verificăm dacă este aşa cum arată biplotul, analizând poziţia la care sunt aceste ţări la aceste cheltuieli în clasamentul european.\nPentru început, cheltuielile cu salariile din apărare vs cheltuielile de capital în servicii publice generale. Sunt pe axe opuse în biplot, deci ne aşteptăm să vedem o corelaţie negativă puternică între ele în graficul din Figure 2 .\n\n\nCode\n#|\nx %&gt;% mutate(variable=paste0(cofog99, \"_\", na_item)) %&gt;% \n  filter(grepl(\"Defence_S|General.+C$\", variable)) %&gt;% \n  select(-1,-na_item) %&gt;% spread(variable, values) %&gt;% \n  set_names(c(\"geo\", \"Apărare_S\", \"GPS_C\")) %&gt;% \n  ggplot(aes(x=Apărare_S, y=GPS_C)) + geom_point() + \n  ggrepel::geom_text_repel(aes(label=geo)) + \n  geom_smooth(method=\"lm\", fill=\"#EEA100\") +\n  labs(title=\"Relaţia dintre Defence_S şi General public services_C\", \n       caption=\"Sursa: Eurostat, gov_10a_exp\")  \n\n\n\n\n\nFigure 2: Relaţia dintre cheltuielile pe apărare (salariale) şi cele de capital pentru serviciile publice generale\n\n\n\n\nCorelaţia este într-adevăr negativă, deşi nu puternic (doar -0.29), însă este printre cele mai mari corelaţii negative pe care o are Defence_S cu oricare dintre variabile, după cum arată graficul următor din Figure 3.\n\n\nCode\nmat %&gt;% cor() %&gt;% \n  .[,grepl(\"Defence_S\", colnames(mat))] %&gt;% enframe() %&gt;% \n  mutate(name=fct_reorder(name, value)) %&gt;% \n  ggplot(aes(x=name, y=value)) + \n  geom_col(aes(fill=value), show.legend = F) + \n  coord_flip() + scale_fill_gradient2_tableau() +\n  labs(title=\"Corelaţiile Defence_S cu restul variabilelor\",\n       subtitle=\"Corelaţiile Pearson\",\n       caption=\"Sursa: calcule proprii pe Eurostat gov_10a_exp\") +\n  theme(plot.title.position = \"plot\",\n        panel.grid.major.y = element_blank())\n\n\n\n\n\nFigure 3: Corelaţiile Defence_S cu restul variabilelor\n\n\n\n\nOrdinea din grafic pare să respecte sensul acelor de ceasornic din biplot pentru săgeţi. Avem un unghi de aproximativ \\(90^o\\) între Defence_S şi Education_S, ceea ce se traduce prin corelaţie aproape de 0 (lipsa corelaţiei). România se remarcă prin cele mai mari cheltuieli în salariile din apărare (în afara Greciei) versus printre cele mai mici investiţii în servicii generale publice. Cam ca în toate sectoarele bugetare din România, salariile acoperă 60-80 % din totalul cheltuielilor. În cazul apărarii, raportul este de 72 %. În sectorul ordinii publice, el trece de 80 %. Chiar şi în educaţie el este aproape de 70 %. Vedeţi diferenţele dintre media europeană şi România în ceea ce priveşte procentul alocat salariilor din total în graficul următor.\n\n\nCode\nx %&gt;% spread(na_item, values) %&gt;% \n  mutate(ratio = 100*S/T) %&gt;% \n  filter(geo%in%c(\"Romania\", \"Media UE\")) %&gt;% \n  ggplot(aes(x=cofog99, y=ratio, fill=geo)) + \n  geom_col(position='dodge') + coord_flip() + \n  scale_fill_tableau() + \n  labs(title=\"Procentul salariilor din totalul cheltuielilor\", \n       caption='Sursa: Eurostat, gov_10a_exp', fill=\"Regiune\", \n       x=NULL, y=NULL) + theme(plot.title.position = \"plot\", \n                               legend.position = \"top\")\n\n\n\n\n\nFigure 4: Procentul de salarii din total cheltuieli\n\n\n\n\nSe pare că la apărare mare parte din cheltuielile cu care se mândreşte statul român sunt pe salarii disproporţionat mai mult decât media europeană.\nAşadar, putem interpreta biplotul cu încredere. România, împreună cu Bulgaria sunt cele mai extreme state în materie de cheltuieli cu armata şi ordinea publică conform Figure 1 . România, stat poliţienesc ! La polul opus, Danemarca este cel mai social stat. De curiozitate, axele 3 şi 4 nu au o intepretare facilă. Axa 3 poate fi interpretată ca o axă a cheltuielilor de capital vs salarii în general şi cam atât."
  },
  {
    "objectID": "posts/2023-06-11-la-ce-categorii-de-cheltuieli-se-remarca-romania/la-ce-categorii-de-cheltuieli-se-remarca-romania.html#concluzie",
    "href": "posts/2023-06-11-la-ce-categorii-de-cheltuieli-se-remarca-romania/la-ce-categorii-de-cheltuieli-se-remarca-romania.html#concluzie",
    "title": "La ce categorii de cheltuieli se remarcă România ?",
    "section": "4 Concluzie",
    "text": "4 Concluzie\nPuteţi folosi PCA într-o multitudine de aplicaţii. Ori de câte ori aveţi variabile multiple şi doriţi să descoperiţi relaţiile dintre ele într-un mod facil această unealtă este la îndemână. Însă trebuie menţionat că e doar o unealtă, nu e universal aplicabilă. Poate fi viciată de outlieri, de dimensionalitatea intrinsecă înaltă a datelor (caz în care devine inutilă căci nu e nimic de proiectat într-un spaţiu dimensional mai jos). De asemenea toate interpretările de mai sus se aplică doar dacă se foloseşte versiunea care standardizează datele înainte. Altiminteri alte interpretări sunt disponibile, dar despre acest lucru cu altă ocazie. Ce se poate spune analizând cheltuielile bugetare din Europa cu această metodă este că suntem un stat cu profil preponderent miliţienesc. Suntem locul 2 în Europa la cheltuieli cu apărarea (din care majoritatea covârşitoare doar salarii) şi locul trei la ordine publică şi siguranţă, de asemenea mai degrabă salarii în comparaţie cu media europeană. Deşi avem un grad de colectare redus, cheltuim peste 2 % din PIB cu ordinea publică, pe când Danemarca cheltuie sub 1 %. Cu atât mai mult atârnă ca proporţie din bugetul total."
  },
  {
    "objectID": "posts/2023-06-11-cum-au-trecut-firmele-prin-pandemie/2023-06-11-cum-au-trecut-firmele-prin-pandemie.html",
    "href": "posts/2023-06-11-cum-au-trecut-firmele-prin-pandemie/2023-06-11-cum-au-trecut-firmele-prin-pandemie.html",
    "title": "Cum au trecut firmele prin pandemie ?",
    "section": "",
    "text": "Am descărcat bilanţurile financiare ale firmelor de pe data.gov.ro pentru anii 2019, 2020 şi 2021 (2022 încă nu e disponibil) pentru a analiza cum au trecut firmele prin pandemia de COVID. Când vor apărea datele pentru 2022, vom putea analiza şi cauzele inflaţiei din România din perioada prezentă. Pentru început ne mulţumim să vedem cum au trecut firmele prin pandemia de COVID în vremurile restricţiilor. Ce firme au fost scutite de la plata impozitelor pe profit ? Ce sectoare au avut profitabilitate ridicată ? Şi aşa mai departe.\n\n\nCode\nlibrary(tidyverse)\nlibrary(hrbrthemes)\nlibrary(ggthemes)\nlibrary(gt)\nlibrary(gtExtras)\ntheme_set(hrbrthemes::theme_ipsum_tw(strip_text_size = 14, \n                                     strip_text_family = \"Roboto\",\n                                     strip_text_face = \"italic\",\n                                     axis_title_size = 12,\n                                     axis_text_size = 10,\n                                     base_family = \"Roboto\",\n                                     plot_title_family = \"Roboto\",\n                                     subtitle_family = \"Roboto\",\n                                     caption_family = \"Roboto\", \n                                     caption_size = 10,\n                                     plot_title_size = 16,\n                                     subtitle_size = 12) +\n  theme(legend.text = element_text(size=10), \n        legend.title = element_text(size=12),\n        legend.key.size = unit(0.5, \"cm\")))  #setam tema graficelor \n\nx &lt;- bind_rows(read_csv(here::here(\"data/post-8\", \n                                   \"bl_bs_sl+ir+uu_2019.csv\")) %&gt;% \n               mutate(year = 2019),\n               read_csv(here::here(\"data/post-8\", \n                                   \"bl_bs_sl+ir+uu_2020.csv\")) %&gt;%\n               mutate(year=2020),\n               read_csv(here::here(\"data/post-8\", \n                                   \"bl_bs_sl+ir+uu_2021.csv\")) %&gt;%\n               mutate(year=2021)) %&gt;%\n    mutate(across(active_imobilizate_total:numar_mediu_de_salariati,\n                 ~replace_na(., 0))) %&gt;%\n    filter(numar_mediu_de_salariati &lt; 30000) %&gt;%\n    mutate(categorie = if_else(grepl(\"uu\", categorie), \n                             \"Simplificat\", \"CIT\"))\n\n\nSă vedem rata taxării efective (procent din profit plătit ca impozit) după categorii de firme: companii mari (corporaţii, IMM-uri şi microîntreprinderi). Nu ştim de la statul român care-i care, vom calcula noi pe baza acestor caracteristici de pe Wikipedia. Totuşi nu avem date despre cine deţine ce, aşa că ultimul criteriu, al treilea, nu va fi inclus. Bănuiesc că nu sunt multe firme în situaţia aceasta astfel încât să ne vicieze analiza. Dar e nevoie de nişte preprocesare înainte întrucât aceste date sunt foarte proaste: lipsesc valori, unele firme cu profit 0 au peste 100.000 de salariaţi, o firmă are 40 % din capitalul ţării şi multe asemenea lucruri.\n\n\nCode\nx &lt;- x %&gt;% mutate(tip = case_when((between(numar_mediu_de_salariati, 0, 9) & between(cifra_de_afaceri_neta, -30000000, 10000000)) ~ \"Microîntreprinderi\",\n                                  (between(numar_mediu_de_salariati, 10, 49) & between(cifra_de_afaceri_neta, 10000001, 50000000)) ~ \"Întreprinderi mici\",  (between(numar_mediu_de_salariati, 50, 249) & between(cifra_de_afaceri_neta, 50000001, 250000000)) ~ \"Întreprinderi medii\", \n                                  (between(numar_mediu_de_salariati, 250, 100000) & between(cifra_de_afaceri_neta, 250000001, 100000000000)) ~ \"Corporaţii\")) %&gt;% mutate(tip = replace_na(tip, \"Neclasificate\"))\n\n\nVom calcula rata taxării efective per tip de firmă şi tip de bilanţ depus (simplificat - 1 % din cifra de afaceri netă sau CIT - impozit pe profit 16 %). Acest lucru se face după următoarea formulă foarte simplă:\n\\[\nR = 100*\\frac{Profit_{brut}-Profit_{net}}{Profit_{brut}}\n\\]\n\n\nCode\nx %&gt;% filter(cui!=42443305) %&gt;% group_by(year, tip) %&gt;% \n  summarise(rate = 100*(sum(profit_brut)-sum(profit_net))/sum(profit_brut)) %&gt;% ungroup() %&gt;% spread(year, rate) %&gt;% gt::gt() %&gt;% \n  gtExtras::gt_theme_538() %&gt;% \n  tab_style(cell_fill(color=\"#EEA100\"), cells_column_labels()) %&gt;% \n  gt::opt_table_font(font=\"Roboto\") %&gt;% \n  tab_header(title=NULL, subtitle=\"Sursa: data.gov.ro\") %&gt;% \n  tab_style(cell_text(weight = 'bold'), cells_title(groups='title')) %&gt;% \n  gt::fmt_percent(columns=2:4, scale_values = F)\n\n\n\n\n\n\nTable 1:  Rata taxării efective după tipul de firmă \n  \n    \n    \n      tip\n      2019\n      2020\n      2021\n    \n  \n  \n    Corporaţii\n15.81%\n14.07%\n13.68%\n    Întreprinderi medii\n14.73%\n13.89%\n13.29%\n    Întreprinderi mici\n14.51%\n13.38%\n12.77%\n    Microîntreprinderi\n5.27%\n4.51%\n4.39%\n    Neclasificate\n11.99%\n11.39%\n10.88%\n  \n  \n  \n\n\n\n\n\nInteresant. Deşi sunt de zece ori mai multe decât restul companiilor împreună, microîntreprinderile plătesc doar 5 % din profit sub formă de impozit sub bilanţul simplificat, pe cifra de afaceri. E un regim foarte avantajos pentru ele, într-adevăr. La pragul foarte mare de 1 milion de EURO cifra de afaceri (din 2023 de “doar” 500.000 EURO), este clar că multe firme mari se ascund sub această umbrelă ca să scutească nişte bani la stat.\nCe mai observăm din Table 1 este că în 2021 au plătit cam toate categoriile şi mai puţin decât în 2020. Firmele neclasificate par a avea număr de salariaţi de ordinul zecilor, dar cifră de afaceri de microîntreprindere practic şi profituri de câteva sute de mii de RON. Sunt ceva mai ineficiente. De asemenea, sunt câteva firme care apar la bilanţ simplificat în date, dar nu sunt microîntreprinderi după clasificarea de mărime, nici după rata de taxare efectivă suportată. Alt viciu al datelor.\n\n\nCode\nconverteste &lt;- Vectorize(function(x){\n  if(nchar(x)==3){\n    paste0(\"0\", x)\n  } else { x }\n}, SIMPLIFY = TRUE)\n\nx &lt;- x %&gt;% mutate(caen= converteste(caen) %&gt;% substr(., 1, 2))\n\n\nSă vedem în următorul tabel rata taxării efective după sectoare CAEN, pentru anul 2020.\n\n\nCode\nx %&gt;% filter(cui!=42443305) %&gt;% filter(year==2020) %&gt;%\n  inner_join(read_delim(here::here(\"data\", \"caen.csv\"), delim='\\\",\\\"')) %&gt;% \n  select(-caen) %&gt;% relocate(sector) %&gt;% group_by(sector, tip) %&gt;% \n  summarise(rate = 100*(sum(profit_brut)-sum(profit_net))/sum(profit_brut)) %&gt;% ungroup() %&gt;% mutate(tip = gsub(\"[Îî]ntreprinderi\", \"\", tip)) %&gt;% \n  spread(tip, rate) %&gt;% #mutate_at(2:6, ~replace_na(., 0)) %&gt;% \n  relocate(sector, `Corporaţii`, ` medii`, \n           ` mici`, Micro, Neclasificate) %&gt;%\n  filter(!grepl(\"Învăţ|publică\", sector)) %&gt;%\n  gt::gt() %&gt;% gtExtras::gt_theme_538() %&gt;% \n  tab_style(cell_fill(color=\"#EEA100\"), cells_column_labels()) %&gt;% \n  gt::opt_table_font(font=\"Roboto\") %&gt;% \n  gtExtras::gt_color_rows(columns=2:6, palette=\"ggsci::orange_material\") %&gt;% \n  gt::fmt_percent(2:6, scale_values = F)\n\n\n\n\n\n\nTable 2:  Rata taxării efectivă după CAEN \n  \n    \n    \n      sector\n      Corporaţii\n       medii\n       mici\n      Micro\n      Neclasificate\n    \n  \n  \n    Activităţi profesionale \n14.71%\n14.13%\n6.92%\n3.27%\n9.65%\n    Agricultura\n11.23%\n11.73%\n10.34%\n4.89%\n10.33%\n    Alte servicii\nNA\n10.04%\n16.02%\n3.95%\n9.28%\n    Apă, salubritate, deşeuri\n18.85%\n15.09%\n13.87%\n4.25%\n13.83%\n    Comerţ\n14.04%\n14.60%\n14.12%\n7.61%\n13.79%\n    Construcţii\n10.66%\n13.56%\n14.63%\n4.23%\n10.90%\n    Energie\n14.35%\n10.72%\n10.38%\n2.54%\n5.99%\n    Finanţe & Asigurări\nNA\n15.72%\n6.51%\n0.55%\n9.21%\n    HORECA\n3.23%\n23.13%\n8.53%\n4.30%\n5.61%\n    Industrie extractivă\n10.06%\n10.76%\n12.10%\n3.09%\n3.14%\n    Industrie prelucrătoare\n15.31%\n13.48%\n13.56%\n5.09%\n11.89%\n    ITC\n14.86%\n13.25%\n13.84%\n3.12%\n12.59%\n    Recreative\n0.00%\n13.29%\n12.82%\n3.92%\n12.92%\n    Sănătate & asistenţă socială\n13.83%\n10.97%\n13.17%\n2.78%\n8.90%\n    Servicii administrative & suport\n13.52%\n20.97%\n13.62%\n3.76%\n11.12%\n    Transport şi depozitare\n15.18%\n14.15%\n14.38%\n6.29%\n11.99%\n    Tranzacţii imobiliare\nNaN\n13.44%\n16.79%\n4.92%\n12.01%\n  \n  \n  \n\n\n\n\n\nNe fac cu ochiul procentele mici plătite de firmele mici de asigurări şi intermedieri financiare, energie (însă nu corporaţiile) şi corporaţiile din construcţii care plătesc la jumătate, dar mai ales corporaţiile din HoReCa care plătesc un procent ruşinos în toţi aceşti ani. Dar sunt numai două la număr. Ca şi numărul de întreprinderi medii."
  },
  {
    "objectID": "posts/2023-06-11-cum-au-trecut-firmele-prin-pandemie/2023-06-11-cum-au-trecut-firmele-prin-pandemie.html#rata-taxării-efective",
    "href": "posts/2023-06-11-cum-au-trecut-firmele-prin-pandemie/2023-06-11-cum-au-trecut-firmele-prin-pandemie.html#rata-taxării-efective",
    "title": "Cum au trecut firmele prin pandemie ?",
    "section": "",
    "text": "Am descărcat bilanţurile financiare ale firmelor de pe data.gov.ro pentru anii 2019, 2020 şi 2021 (2022 încă nu e disponibil) pentru a analiza cum au trecut firmele prin pandemia de COVID. Când vor apărea datele pentru 2022, vom putea analiza şi cauzele inflaţiei din România din perioada prezentă. Pentru început ne mulţumim să vedem cum au trecut firmele prin pandemia de COVID în vremurile restricţiilor. Ce firme au fost scutite de la plata impozitelor pe profit ? Ce sectoare au avut profitabilitate ridicată ? Şi aşa mai departe.\n\n\nCode\nlibrary(tidyverse)\nlibrary(hrbrthemes)\nlibrary(ggthemes)\nlibrary(gt)\nlibrary(gtExtras)\ntheme_set(hrbrthemes::theme_ipsum_tw(strip_text_size = 14, \n                                     strip_text_family = \"Roboto\",\n                                     strip_text_face = \"italic\",\n                                     axis_title_size = 12,\n                                     axis_text_size = 10,\n                                     base_family = \"Roboto\",\n                                     plot_title_family = \"Roboto\",\n                                     subtitle_family = \"Roboto\",\n                                     caption_family = \"Roboto\", \n                                     caption_size = 10,\n                                     plot_title_size = 16,\n                                     subtitle_size = 12) +\n  theme(legend.text = element_text(size=10), \n        legend.title = element_text(size=12),\n        legend.key.size = unit(0.5, \"cm\")))  #setam tema graficelor \n\nx &lt;- bind_rows(read_csv(here::here(\"data/post-8\", \n                                   \"bl_bs_sl+ir+uu_2019.csv\")) %&gt;% \n               mutate(year = 2019),\n               read_csv(here::here(\"data/post-8\", \n                                   \"bl_bs_sl+ir+uu_2020.csv\")) %&gt;%\n               mutate(year=2020),\n               read_csv(here::here(\"data/post-8\", \n                                   \"bl_bs_sl+ir+uu_2021.csv\")) %&gt;%\n               mutate(year=2021)) %&gt;%\n    mutate(across(active_imobilizate_total:numar_mediu_de_salariati,\n                 ~replace_na(., 0))) %&gt;%\n    filter(numar_mediu_de_salariati &lt; 30000) %&gt;%\n    mutate(categorie = if_else(grepl(\"uu\", categorie), \n                             \"Simplificat\", \"CIT\"))\n\n\nSă vedem rata taxării efective (procent din profit plătit ca impozit) după categorii de firme: companii mari (corporaţii, IMM-uri şi microîntreprinderi). Nu ştim de la statul român care-i care, vom calcula noi pe baza acestor caracteristici de pe Wikipedia. Totuşi nu avem date despre cine deţine ce, aşa că ultimul criteriu, al treilea, nu va fi inclus. Bănuiesc că nu sunt multe firme în situaţia aceasta astfel încât să ne vicieze analiza. Dar e nevoie de nişte preprocesare înainte întrucât aceste date sunt foarte proaste: lipsesc valori, unele firme cu profit 0 au peste 100.000 de salariaţi, o firmă are 40 % din capitalul ţării şi multe asemenea lucruri.\n\n\nCode\nx &lt;- x %&gt;% mutate(tip = case_when((between(numar_mediu_de_salariati, 0, 9) & between(cifra_de_afaceri_neta, -30000000, 10000000)) ~ \"Microîntreprinderi\",\n                                  (between(numar_mediu_de_salariati, 10, 49) & between(cifra_de_afaceri_neta, 10000001, 50000000)) ~ \"Întreprinderi mici\",  (between(numar_mediu_de_salariati, 50, 249) & between(cifra_de_afaceri_neta, 50000001, 250000000)) ~ \"Întreprinderi medii\", \n                                  (between(numar_mediu_de_salariati, 250, 100000) & between(cifra_de_afaceri_neta, 250000001, 100000000000)) ~ \"Corporaţii\")) %&gt;% mutate(tip = replace_na(tip, \"Neclasificate\"))\n\n\nVom calcula rata taxării efective per tip de firmă şi tip de bilanţ depus (simplificat - 1 % din cifra de afaceri netă sau CIT - impozit pe profit 16 %). Acest lucru se face după următoarea formulă foarte simplă:\n\\[\nR = 100*\\frac{Profit_{brut}-Profit_{net}}{Profit_{brut}}\n\\]\n\n\nCode\nx %&gt;% filter(cui!=42443305) %&gt;% group_by(year, tip) %&gt;% \n  summarise(rate = 100*(sum(profit_brut)-sum(profit_net))/sum(profit_brut)) %&gt;% ungroup() %&gt;% spread(year, rate) %&gt;% gt::gt() %&gt;% \n  gtExtras::gt_theme_538() %&gt;% \n  tab_style(cell_fill(color=\"#EEA100\"), cells_column_labels()) %&gt;% \n  gt::opt_table_font(font=\"Roboto\") %&gt;% \n  tab_header(title=NULL, subtitle=\"Sursa: data.gov.ro\") %&gt;% \n  tab_style(cell_text(weight = 'bold'), cells_title(groups='title')) %&gt;% \n  gt::fmt_percent(columns=2:4, scale_values = F)\n\n\n\n\n\n\nTable 1:  Rata taxării efective după tipul de firmă \n  \n    \n    \n      tip\n      2019\n      2020\n      2021\n    \n  \n  \n    Corporaţii\n15.81%\n14.07%\n13.68%\n    Întreprinderi medii\n14.73%\n13.89%\n13.29%\n    Întreprinderi mici\n14.51%\n13.38%\n12.77%\n    Microîntreprinderi\n5.27%\n4.51%\n4.39%\n    Neclasificate\n11.99%\n11.39%\n10.88%\n  \n  \n  \n\n\n\n\n\nInteresant. Deşi sunt de zece ori mai multe decât restul companiilor împreună, microîntreprinderile plătesc doar 5 % din profit sub formă de impozit sub bilanţul simplificat, pe cifra de afaceri. E un regim foarte avantajos pentru ele, într-adevăr. La pragul foarte mare de 1 milion de EURO cifra de afaceri (din 2023 de “doar” 500.000 EURO), este clar că multe firme mari se ascund sub această umbrelă ca să scutească nişte bani la stat.\nCe mai observăm din Table 1 este că în 2021 au plătit cam toate categoriile şi mai puţin decât în 2020. Firmele neclasificate par a avea număr de salariaţi de ordinul zecilor, dar cifră de afaceri de microîntreprindere practic şi profituri de câteva sute de mii de RON. Sunt ceva mai ineficiente. De asemenea, sunt câteva firme care apar la bilanţ simplificat în date, dar nu sunt microîntreprinderi după clasificarea de mărime, nici după rata de taxare efectivă suportată. Alt viciu al datelor.\n\n\nCode\nconverteste &lt;- Vectorize(function(x){\n  if(nchar(x)==3){\n    paste0(\"0\", x)\n  } else { x }\n}, SIMPLIFY = TRUE)\n\nx &lt;- x %&gt;% mutate(caen= converteste(caen) %&gt;% substr(., 1, 2))\n\n\nSă vedem în următorul tabel rata taxării efective după sectoare CAEN, pentru anul 2020.\n\n\nCode\nx %&gt;% filter(cui!=42443305) %&gt;% filter(year==2020) %&gt;%\n  inner_join(read_delim(here::here(\"data\", \"caen.csv\"), delim='\\\",\\\"')) %&gt;% \n  select(-caen) %&gt;% relocate(sector) %&gt;% group_by(sector, tip) %&gt;% \n  summarise(rate = 100*(sum(profit_brut)-sum(profit_net))/sum(profit_brut)) %&gt;% ungroup() %&gt;% mutate(tip = gsub(\"[Îî]ntreprinderi\", \"\", tip)) %&gt;% \n  spread(tip, rate) %&gt;% #mutate_at(2:6, ~replace_na(., 0)) %&gt;% \n  relocate(sector, `Corporaţii`, ` medii`, \n           ` mici`, Micro, Neclasificate) %&gt;%\n  filter(!grepl(\"Învăţ|publică\", sector)) %&gt;%\n  gt::gt() %&gt;% gtExtras::gt_theme_538() %&gt;% \n  tab_style(cell_fill(color=\"#EEA100\"), cells_column_labels()) %&gt;% \n  gt::opt_table_font(font=\"Roboto\") %&gt;% \n  gtExtras::gt_color_rows(columns=2:6, palette=\"ggsci::orange_material\") %&gt;% \n  gt::fmt_percent(2:6, scale_values = F)\n\n\n\n\n\n\nTable 2:  Rata taxării efectivă după CAEN \n  \n    \n    \n      sector\n      Corporaţii\n       medii\n       mici\n      Micro\n      Neclasificate\n    \n  \n  \n    Activităţi profesionale \n14.71%\n14.13%\n6.92%\n3.27%\n9.65%\n    Agricultura\n11.23%\n11.73%\n10.34%\n4.89%\n10.33%\n    Alte servicii\nNA\n10.04%\n16.02%\n3.95%\n9.28%\n    Apă, salubritate, deşeuri\n18.85%\n15.09%\n13.87%\n4.25%\n13.83%\n    Comerţ\n14.04%\n14.60%\n14.12%\n7.61%\n13.79%\n    Construcţii\n10.66%\n13.56%\n14.63%\n4.23%\n10.90%\n    Energie\n14.35%\n10.72%\n10.38%\n2.54%\n5.99%\n    Finanţe & Asigurări\nNA\n15.72%\n6.51%\n0.55%\n9.21%\n    HORECA\n3.23%\n23.13%\n8.53%\n4.30%\n5.61%\n    Industrie extractivă\n10.06%\n10.76%\n12.10%\n3.09%\n3.14%\n    Industrie prelucrătoare\n15.31%\n13.48%\n13.56%\n5.09%\n11.89%\n    ITC\n14.86%\n13.25%\n13.84%\n3.12%\n12.59%\n    Recreative\n0.00%\n13.29%\n12.82%\n3.92%\n12.92%\n    Sănătate & asistenţă socială\n13.83%\n10.97%\n13.17%\n2.78%\n8.90%\n    Servicii administrative & suport\n13.52%\n20.97%\n13.62%\n3.76%\n11.12%\n    Transport şi depozitare\n15.18%\n14.15%\n14.38%\n6.29%\n11.99%\n    Tranzacţii imobiliare\nNaN\n13.44%\n16.79%\n4.92%\n12.01%\n  \n  \n  \n\n\n\n\n\nNe fac cu ochiul procentele mici plătite de firmele mici de asigurări şi intermedieri financiare, energie (însă nu corporaţiile) şi corporaţiile din construcţii care plătesc la jumătate, dar mai ales corporaţiile din HoReCa care plătesc un procent ruşinos în toţi aceşti ani. Dar sunt numai două la număr. Ca şi numărul de întreprinderi medii."
  },
  {
    "objectID": "posts/2023-06-11-cum-au-trecut-firmele-prin-pandemie/2023-06-11-cum-au-trecut-firmele-prin-pandemie.html#profitabilitatea",
    "href": "posts/2023-06-11-cum-au-trecut-firmele-prin-pandemie/2023-06-11-cum-au-trecut-firmele-prin-pandemie.html#profitabilitatea",
    "title": "Cum au trecut firmele prin pandemie ?",
    "section": "2 Profitabilitatea",
    "text": "2 Profitabilitatea\nŞi acum profitabilitatea calculată ca procent din cifra de afaceri netă. Acelaşi format de tabel, tot pentru 2020:\n\n\nCode\nx %&gt;% filter(cui!=42443305) %&gt;% filter(year==2020) %&gt;%\n    inner_join(read_delim(here::here(\"data\", \"caen.csv\"), delim='\\\",\\\"')) %&gt;%\n    select(-caen) %&gt;% relocate(sector) %&gt;% group_by(sector, tip) %&gt;% \n    summarise(rate = 100*(sum(profit_net))/sum(cifra_de_afaceri_neta)) %&gt;% ungroup() %&gt;% mutate(tip = gsub(\"[Îî]ntreprinderi\", \"\", tip)) %&gt;% \n    spread(tip, rate) %&gt;% #mutate_at(2:6, ~replace_na(., 0)) %&gt;% \n    relocate(sector, `Corporaţii`, ` medii`, \n             ` mici`, Micro, Neclasificate) %&gt;%\n    filter(!grepl(\"Învăţ|publică\", sector)) %&gt;%\n    gt::gt() %&gt;% gtExtras::gt_theme_538() %&gt;% \n    tab_style(cell_fill(color=\"#EEA100\"), cells_column_labels()) %&gt;% \n    gt::opt_table_font(font=\"Roboto\") %&gt;% \n    gtExtras::gt_color_rows(columns=2:6, palette=\"ggsci::orange_material\") %&gt;% \n    gt::fmt_percent(2:6, scale_values = F)\n\n\n\n\n\n\nTable 3:  Profitabilitatea după tip de firmă, 2020 \n  \n    \n    \n      sector\n      Corporaţii\n       medii\n       mici\n      Micro\n      Neclasificate\n    \n  \n  \n    Activităţi profesionale \n12.21%\n10.31%\n23.37%\n41.41%\n11.61%\n    Agricultura\n4.03%\n4.75%\n9.06%\n19.92%\n7.18%\n    Alte servicii\nNA\n5.10%\n8.37%\n24.67%\n9.16%\n    Apă, salubritate, deşeuri\n8.06%\n5.28%\n10.26%\n24.87%\n6.09%\n    Comerţ\n4.29%\n4.80%\n6.19%\n11.72%\n4.31%\n    Construcţii\n4.58%\n8.18%\n11.94%\n29.69%\n12.14%\n    Energie\n10.56%\n5.21%\n12.31%\n95.59%\n9.34%\n    Finanţe & Asigurări\nNA\n19.94%\n50.56%\n279.71%\n25.63%\n    HORECA\n8.89%\n0.20%\n13.34%\n20.95%\n11.13%\n    Industrie extractivă\n13.85%\n6.21%\n17.65%\n37.15%\n32.56%\n    Industrie prelucrătoare\n4.31%\n7.65%\n8.48%\n19.72%\n6.89%\n    ITC\n6.52%\n7.18%\n16.77%\n41.35%\n9.97%\n    Recreative\n2.60%\n14.85%\n6.75%\n30.34%\n7.58%\n    Sănătate & asistenţă socială\n4.59%\n5.44%\n13.73%\n38.47%\n11.98%\n    Servicii administrative & suport\n6.75%\n3.85%\n10.32%\n32.74%\n8.20%\n    Transport şi depozitare\n4.55%\n4.67%\n7.78%\n14.06%\n6.84%\n    Tranzacţii imobiliare\n0.00%\n20.06%\n48.01%\n48.19%\n18.63%\n  \n  \n  \n\n\n\n\n\nÎn mod suspect cele care plăteau cel mai puţin apar acum cu cea mai mare profitabilitate. Nu e un paradox, cel puţin la microîntreprinderi: dacă cifra de afaceri e mică, iar profitul mare, profitabilitatea e mare iar impozitul plătit mic, deci rata efectivă e tot mică. Să vedem rata de profitabilitate agregată pe ani.\n\n\nCode\nx %&gt;% filter(cui!=42443305) %&gt;%\n    inner_join(read_delim(here::here(\"data\", \"caen.csv\"), delim='\\\",\\\"')) %&gt;%\n    select(-caen) %&gt;% relocate(sector) %&gt;% group_by(year, sector) %&gt;% \n    summarise(rate = 100*(sum(profit_net))/sum(cifra_de_afaceri_neta)) %&gt;%       ungroup() %&gt;% \n    spread(year, rate) %&gt;% #mutate_at(2:6, ~replace_na(., 0)) \n    filter(!grepl(\"Învăţ|publică\", sector)) %&gt;%\n    gt::gt() %&gt;% gtExtras::gt_theme_538() %&gt;% \n    tab_style(cell_fill(color=\"#EEA100\"), cells_column_labels()) %&gt;% \n    gt::opt_table_font(font=\"Roboto\") %&gt;% \n    gtExtras::gt_color_rows(columns=2:4, palette=\"ggsci::orange_material\") %&gt;% \n    gt::fmt_percent(2:4, scale_values = F)\n\n\n\n\n\n\nTable 4:  Profitabilitatea agregată \n  \n    \n    \n      sector\n      2019\n      2020\n      2021\n    \n  \n  \n    Activităţi profesionale \n20.43%\n23.78%\n24.29%\n    Agricultura\n10.98%\n10.03%\n16.47%\n    Alte servicii\n14.86%\n17.80%\n19.01%\n    Apă, salubritate, deşeuri\n7.20%\n7.95%\n9.08%\n    Comerţ\n4.83%\n5.56%\n5.83%\n    Construcţii\n14.27%\n13.79%\n14.79%\n    Energie\n7.61%\n10.93%\n9.57%\n    Finanţe & Asigurări\n47.11%\n141.03%\n117.50%\n    HORECA\n17.08%\n14.04%\n19.96%\n    Industrie extractivă\n17.18%\n16.09%\n15.26%\n    Industrie prelucrătoare\n5.43%\n6.13%\n6.97%\n    ITC\n11.83%\n12.45%\n15.84%\n    Recreative\n15.97%\n12.41%\n14.65%\n    Sănătate & asistenţă socială\n19.06%\n19.45%\n22.46%\n    Servicii administrative & suport\n11.54%\n12.53%\n14.04%\n    Transport şi depozitare\n6.58%\n7.81%\n7.64%\n    Tranzacţii imobiliare\n33.37%\n32.09%\n38.01%\n  \n  \n  \n\n\n\n\n\nTable 4 vorbeşte de la sine. Profituri mai mari în 2019, cu singura excepţie a intermedierilor financiare & asigurărilor."
  },
  {
    "objectID": "posts/2021-06-02-cum-i-ct-s-a-construit-n-romnia-n-ultimii-30-de-ani/cum-i-ct-s-a-construit-n-romnia-n-ultimii-30-de-ani.html",
    "href": "posts/2021-06-02-cum-i-ct-s-a-construit-n-romnia-n-ultimii-30-de-ani/cum-i-ct-s-a-construit-n-romnia-n-ultimii-30-de-ani.html",
    "title": "Cum și cât s-a construit în România în ultimii 30 de ani ?",
    "section": "",
    "text": "Code\nlibrary(tidyverse)\nlibrary(sf)\nlibrary(hrbrthemes)\nlibrary(TEMPO)\nlibrary(gt)\nlibrary(gtExtras)\nlibrary(ggthemes)\n\n#TEMPO::tempo_bulk(codes=\"LOC103B\", directory = here::here(\"data\", \"post-2\"))\n\ntheme_set(hrbrthemes::theme_ipsum_tw(strip_text_size = 14, \n                                     strip_text_family = \"Roboto\",\n                                     strip_text_face = \"italic\",\n                                     axis_title_size = 12,\n                                     axis_text_size = 10,\n                                     base_family = \"Roboto\",\n                                     plot_title_family = \"Roboto\",\n                                     subtitle_family = \"Roboto\",\n                                     caption_family = \"Roboto\", \n                                     caption_size = 10,\n                                     plot_title_size = 16,\n                                     subtitle_size = 12) +\n  theme(legend.text = element_text(size=10), \n        legend.title = element_text(size=12),\n        legend.key.size = unit(0.5, \"cm\")))  #setam tema graficelor \n\n\nx &lt;- read_csv(here::here(\"data/post-2/LOC103B.csv\")) %&gt;%\n     set_names(c(\"forme\", \"judet\", \"loc\", \"ani\", \"indicator\", \"valoare\")) %&gt;%\n     select(-indicator) %&gt;% mutate(ani = parse_number(ani))\n\n\nDatele de la INS prezintă informații cu privire la suprafata locuibilă existentă în țară după localitate, forme de proprietate (public sau privat) și pentru fiecare an. Putem folosi aceste date pentru a înțelege tiparul construcțiilor la noi în țară în ultimii 30 de ani. Să vedem cât s-a construit în total.\n\n\nCode\nx %&gt;% \n  filter(forme!=\"Total\", judet==\"TOTAL\", loc==\"TOTAL\") %&gt;% \n  mutate(valoare = valoare/1000000) %&gt;%\n  ggplot(aes(x=ani, y=valoare, group=forme)) + \n  geom_bar(aes(fill=forme), stat=\"identity\") +\n  labs(title = \"Suprafața locuibilă existentă\", x=NULL, y=expr(km^2), \n       caption=\"Sursa: INS, LOC103B\") +\n  ggthemes::scale_fill_tableau()\n\n\n\n\n\n\n\n\n\nObservăm un trend descrescător pentru locuințele construite în regim public, de la 6.35 % din total în anul 1994 la 0.88 % în anul 2019, o scădere a ponderii de aproximativ 7 ori. Salturile din 2001 și 2011 sunt suspecte și trebuie puse pe seama recensămintelor din anii respectivi. Drept urmare, trendul nu este întocmai cel real.\n\n\nCode\nx &lt;- x %&gt;% \n  mutate(tip = str_extract(loc, \"ORAS|MUNICIPIUL\") %&gt;% \n               replace_na(., \"COMUNA\")) \n\nx %&gt;% \n  filter(forme!=\"Total\") %&gt;% \n  group_by(tip, ani, forme) %&gt;% \n  summarise(total = sum(valoare)/1000000) %&gt;% \n  ungroup() %&gt;% \n  ggplot(aes(x=ani, y=total, group=tip)) + \n  geom_line(aes(colour=tip), size=1.2) + \n  facet_wrap(~forme, ncol=2, scales='free') + \n  labs(title = \"Suprafața locuibilă existentă după medii de rezidență\",\n       colour=\"Mediu\", caption=\"Sursa: INS, LOC103B\",\n       x=NULL, y=expr(km^2)) + theme(legend.position = \"top\") +\n  scale_y_continuous(labels = scales::number_format(accuracy=1)) +\n  scale_colour_tableau()\n\n\n\n\n\n\n\n\n\nCel mai mult s-a construit în comune, însă acest lucru doar datorită numărului lor ridicat în comparație cu orașele și municipiile. Să vedem același grafic raportat la numărul de locuitori.\n\n\nCode\nharta &lt;- sf::read_sf(here::here(\"data\", \"post-2\", \"ro_uat_poligon.geojson\"))\n\nx %&gt;% filter(forme!=\"Total\") %&gt;% \n  mutate(natcode = parse_number(loc) %&gt;% as.character()) %&gt;% \n  inner_join(harta) %&gt;% group_by(natLevName, ani, forme) %&gt;% \n  summarise(total = mean(valoare/pop2015)) %&gt;% ungroup() %&gt;% \n  ggplot(aes(x=ani, y=total, group=natLevName)) + \n  geom_line(aes(colour=natLevName), size=1.2) + \n  facet_wrap(~forme, ncol=3, scales='free') +\n  labs(title = \"Suprafață locuibilă per locuitor\", \n       x=NULL, y=expr(m^2/loc), colour=\"Mediu\", \n       caption=\"Sursa: INS, LOC103B\") +\n  theme(legend.position = \"top\") +\n  scale_colour_tableau()\n\n\n\n\n\n\n\n\n\nComunele rămân mediul în care s-a construit cel mai mult raportat la numărul de locuitori. Observăm aceleași salturi suspecte. Care sunt localitățile cu cea mai mare suprafață locuibilă existentă în regim public în 2019 ? Putem explora acest lucru în tabelul de mai jos.\n\n\nCode\nx %&gt;% filter(grepl(\"public\", forme)) %&gt;% \n    mutate(natcode = parse_number(loc) %&gt;% as.character()) %&gt;% \n    inner_join(harta) %&gt;% \n    select(judet, name, natLevName, pop2020, valoare, ani) %&gt;% \n    mutate(suprafata = valoare/pop2020) %&gt;% filter(ani==2021) %&gt;% \n    select(-ani, -pop2020) %&gt;% arrange(desc(suprafata)) %&gt;% \n    slice(1:20) %&gt;% gt::gt() %&gt;% gtExtras::gt_theme_538() %&gt;% \n    gt::opt_table_font(font=\"Roboto\") %&gt;%\n    fmt_number(columns=4:5, decimals=2) %&gt;%\n    tab_header(title = \"Localităţile cu cea mai mare suprafaţă construită în regim public per locuitor\", subtitle=\"Sursa: INS, LOC103B, 2021\") %&gt;% \n    gt::tab_style(cell_fill(color=\"#EEA100\"), cells_column_labels()) %&gt;%\n    gt::tab_style(cell_text(weight = 'bold'), cells_title(groups='title'))\n\n\n\n\n\n\n  \n    \n      Localităţile cu cea mai mare suprafaţă construită în regim public per locuitor\n    \n    \n      Sursa: INS, LOC103B, 2021\n    \n    \n      judet\n      name\n      natLevName\n      valoare\n      suprafata\n    \n  \n  \n    Caras-Severin\nCiudanovița\nComuna\n8,597.00\n13.91\n    Gorj\nMătăsari\nComuna\n41,770.00\n8.45\n    Caras-Severin\nRusca Montană\nComuna\n9,143.00\n4.92\n    Mehedinti\nGogoșu\nComuna\n16,601.00\n3.90\n    Mehedinti\nIzvoru Bârzii\nComuna\n9,410.00\n3.44\n    Hunedoara\nGhelari\nComuna\n6,304.00\n3.15\n    Brasov\nPredeal\nOras\n14,662.00\n3.01\n    Hunedoara\nAninoasa\nOras\n11,408.00\n2.53\n    Suceava\nCrucea\nComuna\n4,298.00\n2.15\n    Caras-Severin\nAnina\nOras\n18,167.00\n2.03\n    Tulcea\nStejaru\nComuna\n2,866.00\n1.89\n    Sibiu\nBruiu\nComuna\n1,608.00\n1.72\n    Ilfov\nCorbeanca\nComuna\n13,761.00\n1.65\n    Timis\nNădrag\nComuna\n3,998.00\n1.41\n    Harghita\nBorsec\nOras\n3,707.00\n1.39\n    Hunedoara\nBănița\nComuna\n1,586.00\n1.31\n    Suceava\nCârlibaba\nComuna\n2,546.00\n1.31\n    Hunedoara\nLupeni\nMunicipiu, altul decat resedinta de judet\n33,205.00\n1.29\n    Harghita\nBălan\nOras\n9,559.00\n1.28\n    Sibiu\nBiertan\nComuna\n3,888.00\n1.27\n  \n  \n  \n\n\n\n\nDestule comune de care nu a auzit nimeni. Dar şi orăşele precum Predealul. Brașovul stă cel mai bine la capitolul suprafață locuită publică totală, nu per cap de locuitor. Însă chiar și în cazul lui declinul este semnificativ: în 1994 avea 912.000 metri pătrați locuiți în regim public față de 250.000 în 2019. Totuși, în ultimii ani a început să crească, întrucât valoarea era și mai scăzută în jurul anului 2010.\n\n\nCode\nx %&gt;% filter(grepl(\"BRASOV\", loc), grepl(\"public\", forme)) %&gt;% \n  ggplot(aes(x=ani, y=valoare)) + geom_line(size=1.5, colour=\"#EEA100\") +\n  labs(title = \"Suprafața în regim public - orașul Brașov\", \n       x=NULL, y=expr(m^2)) +\n  scale_y_continuous(labels=scales::number_format(big.mark = \",\"))\n\n\n\n\n\n\n\n\n\nÎn concluzie, locuințele publice în România au fost construite din ce în ce mai puțin în ultimii treizeci de ani. Dar înainte de a încheia, să vedem o hartă tematică cu suprafața totală per locuitor pentru anul 2019 clasificate după decile.\n\n\nCode\nharta[grepl(\"Bucure.ti\", harta$name), \"natcode\"] &lt;- rep(\"179132\", 6)\n\nx %&gt;% \n  filter(forme==\"Total\", ani==2021) %&gt;% \n  mutate(natcode = parse_number(loc) %&gt;% as.character()) %&gt;% \n  inner_join(harta) %&gt;% \n  mutate(valoare = cut_number(valoare/pop2015, n=10)) %&gt;% sf::st_as_sf() %&gt;% \n  ggplot() + geom_sf(aes(fill=valoare), colour=NA) +\n  scale_fill_tableau(palette = \"Classic Orange-Blue\", type=\"ordered-diverging\") +\n  labs(title = \"Suprafața totală per locuitor\", fill=expr(m^2/loc)) \n\n\n\n\n\n\n\n\n\nNe putem gândi la această hartă ca la o hartă a sărăciei - nordul Moldovei și sudul Dobrogei sunt zonele din prima decilă, cu 6-17 metri per locuitor. Zonele albastre au peste 27 de metri per locuitor, sunt în ultima decilă."
  },
  {
    "objectID": "posts/2023-06-12-povara-fiscala-conform-oecd/2023-06-01-povara-fiscala-conform-oecd.html",
    "href": "posts/2023-06-12-povara-fiscala-conform-oecd/2023-06-01-povara-fiscala-conform-oecd.html",
    "title": "Povara fiscală conform OECD",
    "section": "",
    "text": "E un lucru bine cunoscut că România are un sistem fiscal regresiv datorită cotei sale unice pe venituri şi contribuţiilor sociale foarte mari, contribuţii pe care cei cu venituri superioare (cum sunt cei cu PFA/PFI, meseriile liberale, microîntreprinderi) le pot evita într-o oarecare măsură. Astfel povara fiscală atârnă pe cei mai puţin norocoşi. OECD are un calculator online de taxe care oferă şi datele sub formă de Excel şi astfel ne permite să facem nişte calcule vis-a-vis de povara fiscală din fiecare ţară. Am ales să ne concentrăm pe anul 2022, aşadar vom avea o analiză cross-secţională.\n\n\nCode\nlibrary(tidyverse)\nlibrary(hrbrthemes)\nlibrary(ggthemes)\nlibrary(gt)\nlibrary(gtExtras)\ntheme_set(hrbrthemes::theme_ipsum_tw(strip_text_size = 14, \n                                     strip_text_family = \"Roboto\",\n                                     strip_text_face = \"italic\",\n                                     axis_title_size = 12,\n                                     axis_text_size = 10,\n                                     base_family = \"Roboto\",\n                                     plot_title_family = \"Roboto\",\n                                     subtitle_family = \"Roboto\",\n                                     caption_family = \"Roboto\", \n                                     caption_size = 10,\n                                     plot_title_size = 16,\n                                     subtitle_size = 12) +\n  theme(legend.text = element_text(size=10), \n        legend.title = element_text(size=12),\n        legend.key.size = unit(0.5, \"cm\")))  #setam tema graficelor \n\nx &lt;- read_csv(here::here(\"data/post-9\", \"povara_fiscala.csv\")) %&gt;%\n     select(-ub, -hb, -fb, -year)\n\n\nDatele sunt pentru adultul singur fără copii. Să vedem povara fiscală pentru salariatul ce câştigă 60 % din salariul mediu (aproape de minimum, unde există), salariul mediu şi de trei ori salariul mediu (în general top 10 %).\n\n\n\nCode\nx %&gt;% filter(earnings==100 | earnings==60 | earnings == 300) %&gt;% \n  mutate(it=-it, sc=-sc) %&gt;% \n  mutate(earnings=paste(earnings, \"%\")) %&gt;%\n  mutate(earnings=factor(earnings, \n                         levels=c(\"60 %\", \n                                  \"100 %\", \n                                  \"300 %\"))) %&gt;%\n  mutate_at(vars(net:sc), ~./`Average Wage`) %&gt;%\n  mutate(color = if_else(grepl(\"Romania\", Country), \n                         \"#ba0000\", \"#444444\"),\n  name = glue::glue(\"&lt;i style='color:{color}'&gt;{Country}&lt;/i&gt;\")) %&gt;%\n  mutate(name = tidytext::reorder_within(name, earnings, \n                                          by={abs(it+sc)})) %&gt;%\n  gather(gross:sc, key=\"Indicator\", value='valoare') %&gt;%\n  mutate(Indicator = factor(Indicator, \n                          levels=c(\"iw\", \"gross\",\"sa\",\"it\", \"sc\"))) %&gt;%\n  ggplot(aes(x=name, y=valoare, fill=Indicator)) + \n  geom_col(aes(fill=Indicator)) + scale_fill_tableau() + \n  geom_point(aes(x=name, y=net), shape=4, show.legend = FALSE) +\n  tidytext::scale_x_reordered() + \n  geom_hline(yintercept = 0, linetype=2) + \n  facet_wrap(~earnings, ncol=3, scales='free') + \n  coord_flip() +\n  labs(title=\"Povara fiscală după categorii de venit\",\n       subtitle=\"Taxe şi venituri ca procent din salariul mediu\", \n       x=NULL, y=NULL, caption=\"Sursa: OECD Tax Benefits Calculator\") +\n  theme(legend.position = \"top\",\n        axis.text.y = ggtext::element_markdown())\n\n\n\n\n\nFigure 1: Povara fiscală după clasa socială\n\n\n\n\n\nLegenda, din lipsă de spaţiu, o traducem aici: gross - venitul brut, it - impozitul pe venit, sc - contribuţiile sociale, iw - beneficii în muncă, sa - asistenţă socială şi venit minim garantat. Steluţa reprezintă venitul net - cât mai rămâne după taxe.\nCe observăm din acest grafic ? Că România are cea mai mare povara fiscală pe angajatul precar şi pe angajatul mediu, dar angajatul bogat este undeva prin treimea a doua a clasamentului, bine-merci. Vedem aşadar în practică efectele cotei unice: distribuţia poverii fiscale pe cei care nu au, lucru care necesită şi rate mai mari. Să nu ne mirăm că munca este taxată în România."
  },
  {
    "objectID": "posts/2023-06-12-povara-fiscala-conform-oecd/2023-06-01-povara-fiscala-conform-oecd.html#inechitatea-sistemului-fiscal-din-românia",
    "href": "posts/2023-06-12-povara-fiscala-conform-oecd/2023-06-01-povara-fiscala-conform-oecd.html#inechitatea-sistemului-fiscal-din-românia",
    "title": "Povara fiscală conform OECD",
    "section": "",
    "text": "E un lucru bine cunoscut că România are un sistem fiscal regresiv datorită cotei sale unice pe venituri şi contribuţiilor sociale foarte mari, contribuţii pe care cei cu venituri superioare (cum sunt cei cu PFA/PFI, meseriile liberale, microîntreprinderi) le pot evita într-o oarecare măsură. Astfel povara fiscală atârnă pe cei mai puţin norocoşi. OECD are un calculator online de taxe care oferă şi datele sub formă de Excel şi astfel ne permite să facem nişte calcule vis-a-vis de povara fiscală din fiecare ţară. Am ales să ne concentrăm pe anul 2022, aşadar vom avea o analiză cross-secţională.\n\n\nCode\nlibrary(tidyverse)\nlibrary(hrbrthemes)\nlibrary(ggthemes)\nlibrary(gt)\nlibrary(gtExtras)\ntheme_set(hrbrthemes::theme_ipsum_tw(strip_text_size = 14, \n                                     strip_text_family = \"Roboto\",\n                                     strip_text_face = \"italic\",\n                                     axis_title_size = 12,\n                                     axis_text_size = 10,\n                                     base_family = \"Roboto\",\n                                     plot_title_family = \"Roboto\",\n                                     subtitle_family = \"Roboto\",\n                                     caption_family = \"Roboto\", \n                                     caption_size = 10,\n                                     plot_title_size = 16,\n                                     subtitle_size = 12) +\n  theme(legend.text = element_text(size=10), \n        legend.title = element_text(size=12),\n        legend.key.size = unit(0.5, \"cm\")))  #setam tema graficelor \n\nx &lt;- read_csv(here::here(\"data/post-9\", \"povara_fiscala.csv\")) %&gt;%\n     select(-ub, -hb, -fb, -year)\n\n\nDatele sunt pentru adultul singur fără copii. Să vedem povara fiscală pentru salariatul ce câştigă 60 % din salariul mediu (aproape de minimum, unde există), salariul mediu şi de trei ori salariul mediu (în general top 10 %).\n\n\n\nCode\nx %&gt;% filter(earnings==100 | earnings==60 | earnings == 300) %&gt;% \n  mutate(it=-it, sc=-sc) %&gt;% \n  mutate(earnings=paste(earnings, \"%\")) %&gt;%\n  mutate(earnings=factor(earnings, \n                         levels=c(\"60 %\", \n                                  \"100 %\", \n                                  \"300 %\"))) %&gt;%\n  mutate_at(vars(net:sc), ~./`Average Wage`) %&gt;%\n  mutate(color = if_else(grepl(\"Romania\", Country), \n                         \"#ba0000\", \"#444444\"),\n  name = glue::glue(\"&lt;i style='color:{color}'&gt;{Country}&lt;/i&gt;\")) %&gt;%\n  mutate(name = tidytext::reorder_within(name, earnings, \n                                          by={abs(it+sc)})) %&gt;%\n  gather(gross:sc, key=\"Indicator\", value='valoare') %&gt;%\n  mutate(Indicator = factor(Indicator, \n                          levels=c(\"iw\", \"gross\",\"sa\",\"it\", \"sc\"))) %&gt;%\n  ggplot(aes(x=name, y=valoare, fill=Indicator)) + \n  geom_col(aes(fill=Indicator)) + scale_fill_tableau() + \n  geom_point(aes(x=name, y=net), shape=4, show.legend = FALSE) +\n  tidytext::scale_x_reordered() + \n  geom_hline(yintercept = 0, linetype=2) + \n  facet_wrap(~earnings, ncol=3, scales='free') + \n  coord_flip() +\n  labs(title=\"Povara fiscală după categorii de venit\",\n       subtitle=\"Taxe şi venituri ca procent din salariul mediu\", \n       x=NULL, y=NULL, caption=\"Sursa: OECD Tax Benefits Calculator\") +\n  theme(legend.position = \"top\",\n        axis.text.y = ggtext::element_markdown())\n\n\n\n\n\nFigure 1: Povara fiscală după clasa socială\n\n\n\n\n\nLegenda, din lipsă de spaţiu, o traducem aici: gross - venitul brut, it - impozitul pe venit, sc - contribuţiile sociale, iw - beneficii în muncă, sa - asistenţă socială şi venit minim garantat. Steluţa reprezintă venitul net - cât mai rămâne după taxe.\nCe observăm din acest grafic ? Că România are cea mai mare povara fiscală pe angajatul precar şi pe angajatul mediu, dar angajatul bogat este undeva prin treimea a doua a clasamentului, bine-merci. Vedem aşadar în practică efectele cotei unice: distribuţia poverii fiscale pe cei care nu au, lucru care necesită şi rate mai mari. Să nu ne mirăm că munca este taxată în România."
  },
  {
    "objectID": "posts/2021-06-06-geografia-excesului-de-mortalitate/geografia-excesului-de-mortalitate.html",
    "href": "posts/2021-06-06-geografia-excesului-de-mortalitate/geografia-excesului-de-mortalitate.html",
    "title": "Geografia excesului de mortalitate",
    "section": "",
    "text": "Să explorăm datele de la Eurostat, tabelul foarte mare cu date despre numărul de decese săptămânal la nivel de regiune NUTS 3 şi pe categorii de vârstă numit demo_r_mwk3_10. Vom calcula excesul de mortalitate în maniera uzuală, adică prin formula următoare:\n\\[\nExces_{w_i}^{y_j} = \\frac{Decese_{w_i}^{y_j} - \\frac{1}{4} \\sum_{j=2015}^{j=2019} Decese_{w_i}^{y_j}}{\\frac{1}{4} \\sum_{j=2015}^{j=2019} Decese_{w_i}^{y_j}}\n\\]\nUnde \\(Exces_{w_i, y_j}\\) este excesul de mortalitate din săptămâna i, anul j.\n\n\nCode\nlibrary(tidyverse)\nlibrary(eurostat)\nlibrary(hrbrthemes)\nlibrary(ggthemes)\nlibrary(sf)\nlibrary(gt)\nlibrary(gtExtras)\ntheme_set(hrbrthemes::theme_ipsum_tw(strip_text_size = 14, \n                                     strip_text_family = \"Roboto\",\n                                     strip_text_face = \"italic\",\n                                     axis_title_size = 12,\n                                     axis_text_size = 10,\n                                     base_family = \"Roboto\",\n                                     plot_title_family = \"Roboto\",\n                                     subtitle_family = \"Roboto\",\n                                     caption_family = \"Roboto\", \n                                     caption_size = 10,\n                                     plot_title_size = 16,\n                                     subtitle_size = 12) +\n  theme(legend.text = element_text(size=10), \n        legend.title = element_text(size=12),\n        legend.key.size = unit(0.5, \"cm\")))  #setam tema graficelor \n\n#x &lt;- get_eurostat(id=\"demo_r_mwk3_10\") \nx &lt;- read_csv(here::here(\"data\", \"post-5\", \"exces.csv\"))\n\nconvert &lt;-function(x){\n  if(nchar(x)==1){\n    paste0(\"0\", x)\n  } else {\n    x\n  }\n}\n\nconvert &lt;- Vectorize(convert, SIMPLIFY = TRUE)\n\n\n\n\nCode\nexces_2020 &lt;- x %&gt;% filter(year&gt;2014) %&gt;% filter(week&lt;54, year!=2023) %&gt;%\n  mutate(index = if_else(year%in%c(2015:2019), 0, year)) %&gt;% \n  group_by(age, geo, index, week) %&gt;% \n  summarise(normal = mean(values, na.rm=TRUE)) %&gt;% \n  ungroup() %&gt;% spread(index, normal) %&gt;% drop_na() %&gt;%\n  mutate(across(`2020`:`2022`, ~100*(.-`0`)/`0`))\n\nexces &lt;- exces_2020 %&gt;% \n  filter(week&lt;55) %&gt;% \n  gather(`2020`:`2022`, key='ani', value='exces') %&gt;% \n  mutate(time = paste0(ani, \"-W\",convert(week), \"-3\") %&gt;% \n                ISOweek::ISOweek2date(.))\n\n\nexces %&gt;% \n  filter(age=='TOTAL', grepl(\"^[A-Z]{2}$\",geo)) %&gt;% \n  ggplot(aes(x=time, y=exces, group=geo)) + geom_line(aes(colour=geo),\n                                                      size=1) +\n  gghighlight::gghighlight(geo%in%c(\"RO\",\"BG\",\"HU\",\"PL\",\"CZ\"),\n                           use_direct_label = FALSE,\n                           unhighlighted_params = list(size=0.5),\n                           calculate_per_facet = TRUE) +\n  scale_color_tableau() +\n  labs(title=\"Excesul de mortalitate în Europa\", x=NULL, y=\"Exces (%)\",\n       caption='Sursa: Eurostat, demo_r_mwk_3_10', \n       subtitle=\"Raportat la media 2015-2019\", colour='Ţară') +\n  scale_y_continuous(labels=scales::percent_format(scale=1)) +\n  geom_hline(yintercept=0, linetype=2)\n\n\n\n\n\n\n\n\n\nAm stat destul de rău, fiind destul de sus la mortalitate în perioadele-cheie ale pandemiei. Să vedem mortalităţile pe categorii de vârste.\n\n\nCode\nexces_age &lt;- x %&gt;% \n  filter(year&gt;2014) %&gt;% filter(week&lt;54, year!=2023) %&gt;%\n  filter(grepl(\"^[A-Z]{2}$\", geo)) %&gt;% \n  mutate(time = paste0(year, \"-W\", convert(week), \"-3\") %&gt;% ISOweek::ISOweek2date(.)) %&gt;%\n  mutate(month=lubridate::month(time)) %&gt;%\n  mutate(index = if_else(year%in%c(2015:2019), 0, year)) %&gt;% \n  group_by(age, index, month) %&gt;% \n  summarise(normal = mean(values, na.rm=TRUE)) %&gt;% \n  ungroup() %&gt;% spread(index, normal) %&gt;% drop_na() %&gt;%\n  mutate(across(`2020`:`2022`, ~100*(.-`0`)/`0`)) %&gt;%\n  gather(`2020`:`2022`, key='year', value='exces') %&gt;%\n  mutate(time = paste0(year, \"-\", convert(month), \"-01\") %&gt;% as.Date(.))\n\n\nexces_age %&gt;% filter(!grepl(\"TOTAL|UNK|GE80\", age)) %&gt;% \n    ggplot(aes(x=time, y=exces, fill=age)) + geom_col(aes(fill=age)) +\n    scale_y_continuous(labels=scales::percent_format(scale=1)) +\n    scale_fill_tableau() + facet_wrap(~age, ncol=2, scales='free') +\n    labs(title=\"Excesul de mortalitate pe vârste şi luni\", \n         caption='Sursa: Eurostat, r_demo_mwk_3_10', x=NULL, y=\"%\")\n\n\n\n\n\n\n\n\n\nInteresant, cei tineri au avut mortalităţi mai mici în general, abia la intervalul 50-59 ani începe să se balanseze situaţia. Categoria 60-69 de ani are deja mortalitate constant pozitivă în perioadele-cheie ale pandemiei.\nSă vizualizăm o hartă europeană cu excesul mediu de mortalitate după anul 2020 până în prezent.\n\n\nCode\nexces_geo &lt;- x %&gt;% \n    filter(year&gt;2014) %&gt;% filter(week&lt;54, year!=2023) %&gt;%\n    mutate(index = if_else(year%in%c(2015:2019), 0, 1)) %&gt;% \n    filter(age==\"TOTAL\") %&gt;%\n    group_by(age, geo, index) %&gt;% \n    summarise(normal = mean(values, na.rm=TRUE)) %&gt;% \n    ungroup() %&gt;% spread(index, normal) %&gt;% drop_na() %&gt;% select(-age) %&gt;%\n    mutate(exces = 100*(`1`-`0`)/`0`)\n\nharta &lt;- eurostat::eurostat_geodata_60_2016 %&gt;% as_tibble() %&gt;%\n         mutate(index = if_else(grepl(\"^DE\", geo) & LEVL_CODE&gt;1, 0, 1)) %&gt;% \n         filter(index!=0) %&gt;%\n         group_by(CNTR_CODE) %&gt;% slice_max(order_by=LEVL_CODE, n=1) %&gt;% ungroup() \n\nexces_geo %&gt;% inner_join(harta) %&gt;% \n  mutate(exces=cut_number(exces, n=10)) %&gt;% st_as_sf() %&gt;%\n  ggplot() + geom_sf(aes(fill=exces), colour=NA) +\n  geom_sf(data = {eurostat::eurostat_geodata_60_2016 %&gt;% filter(LEVL_CODE==0) %&gt;%\n                 st_as_sf() %&gt;% st_cast(., \"MULTILINESTRING\") %&gt;% \n                 as_tibble() %&gt;% st_as_sf()} , \n          colour='black') +\n  scale_fill_tableau(palette = \"Classic Orange-Blue\", \n                     type=\"ordered-diverging\", direction = -1) +\n  scale_x_continuous(limits = c(-11, 30)) +\n  scale_y_continuous(limits = c(35, 70))\n\n\n\n\n\n\n\n\n\nInteresant la această hartă este diviziunea Germaniei de Est de cea de Vest. Istoria contează aparent şi când e vorba de mortalitatea de COVID.\n\n\nCode\nmortalitati &lt;- x %&gt;% \n    filter(year&gt;2014) %&gt;% filter(week&lt;54, year!=2023) %&gt;%\n    filter(grepl(\"^[A-Z]{2}$\", geo)) %&gt;% \n    mutate(time = paste0(year, \"-W\", convert(week), \"-3\") %&gt;% \n                  ISOweek::ISOweek2date(.)) %&gt;%\n    mutate(month=lubridate::month(time)) %&gt;%\n    mutate(index = if_else(year%in%c(2015:2019), 0, year)) %&gt;% \n    mutate(spatial = if_else(grepl(\"RO\", geo), \"România\", \"Europa\")) %&gt;%\n    group_by(age, index, spatial) %&gt;% \n    summarise(normal = mean(values, na.rm=TRUE)) %&gt;% \n    ungroup() %&gt;% spread(index, normal) %&gt;% drop_na() %&gt;%\n    filter(age!=\"UNK\") %&gt;% filter(age!=\"Y_GE80\") %&gt;% filter(age!=\"TOTAL\") %&gt;%\n    mutate(age = fct_relevel(age, \"Y_GE90\", after=11)) %&gt;%\n    arrange(age)\n\nmortalitati %&gt;% rename(\"2015-2019\" = `0`) %&gt;% \n  gt(rowname_col=\"age\", groupname_col = 'spatial') %&gt;%\n  gtExtras::gt_theme_538() %&gt;%\n  gt::opt_table_font(font=\"Roboto\") %&gt;%\n  gt::cols_width(matches(\"[0-9]+\") ~ \"100px\") %&gt;%\n  gt::tab_stubhead(label = \"Regiune\") %&gt;%\n  gt::fmt_number(columns=2:6, sep_mark = \",\", decimals = 0) %&gt;%\n  gt::tab_style(style = cell_text(\"black\", weight = \"bold\"), \n                locations = cells_row_groups()) %&gt;%\n  gt::tab_style(style=cell_fill(color=\"#daae91\"), \n                locations=cells_row_groups()) %&gt;%\n  gt::tab_style(cell_text(color='black'), \n                locations=cells_column_labels()) %&gt;%\n  gt::tab_options(column_labels.background.color = \"#EEA100\") %&gt;%\n  gt::tab_header(title=\"Numărul mediu de decese săptămânale\", \n                 subtitle=\"Sursa: Eurostat, r_demo_mwk_3_10\") %&gt;%\n  gt::tab_style(cell_text(color='black', weight = \"bold\"), \n                cells_title(groups = \"title\")) %&gt;%\n  gt::tab_style(cell_text(weight='bold'), cells_column_labels()) %&gt;%\n  gtExtras::gt_color_rows(columns=2:6, palette = \"ggsci::orange_material\")\n\n\n\n\n\n\n  \n    \n    \n    \n    \n    \n  \n  \n    \n      Numărul mediu de decese săptămânale\n    \n    \n      Sursa: Eurostat, r_demo_mwk_3_10\n    \n    \n      Regiune\n      2015-2019\n      2020\n      2021\n      2022\n    \n  \n  \n    \n      Europa\n    \n    Y_LT10\n13\n12\n10\n11\n    Y10-19\n5\n5\n5\n5\n    Y20-29\n14\n13\n12\n13\n    Y30-39\n28\n28\n26\n26\n    Y40-49\n71\n70\n67\n64\n    Y50-59\n188\n190\n183\n173\n    Y60-69\n386\n415\n415\n393\n    Y70-79\n638\n716\n686\n673\n    Y80-89\n1,061\n1,180\n1,080\n1,098\n    Y_GE90\n610\n727\n655\n716\n    \n      România\n    \n    Y_LT10\n34\n28\n27\n26\n    Y10-19\n13\n11\n12\n11\n    Y20-29\n28\n24\n25\n21\n    Y30-39\n63\n63\n69\n54\n    Y40-49\n205\n201\n230\n183\n    Y50-59\n435\n470\n536\n434\n    Y60-69\n919\n1,090\n1,235\n939\n    Y70-79\n1,229\n1,396\n1,646\n1,283\n    Y80-89\n1,637\n1,847\n2,032\n1,655\n    Y_GE90\n451\n558\n614\n564"
  },
  {
    "objectID": "posts/2021-06-06-geografia-excesului-de-mortalitate/geografia-excesului-de-mortalitate.html#analiză-exploratorie",
    "href": "posts/2021-06-06-geografia-excesului-de-mortalitate/geografia-excesului-de-mortalitate.html#analiză-exploratorie",
    "title": "Geografia excesului de mortalitate",
    "section": "",
    "text": "Să explorăm datele de la Eurostat, tabelul foarte mare cu date despre numărul de decese săptămânal la nivel de regiune NUTS 3 şi pe categorii de vârstă numit demo_r_mwk3_10. Vom calcula excesul de mortalitate în maniera uzuală, adică prin formula următoare:\n\\[\nExces_{w_i}^{y_j} = \\frac{Decese_{w_i}^{y_j} - \\frac{1}{4} \\sum_{j=2015}^{j=2019} Decese_{w_i}^{y_j}}{\\frac{1}{4} \\sum_{j=2015}^{j=2019} Decese_{w_i}^{y_j}}\n\\]\nUnde \\(Exces_{w_i, y_j}\\) este excesul de mortalitate din săptămâna i, anul j.\n\n\nCode\nlibrary(tidyverse)\nlibrary(eurostat)\nlibrary(hrbrthemes)\nlibrary(ggthemes)\nlibrary(sf)\nlibrary(gt)\nlibrary(gtExtras)\ntheme_set(hrbrthemes::theme_ipsum_tw(strip_text_size = 14, \n                                     strip_text_family = \"Roboto\",\n                                     strip_text_face = \"italic\",\n                                     axis_title_size = 12,\n                                     axis_text_size = 10,\n                                     base_family = \"Roboto\",\n                                     plot_title_family = \"Roboto\",\n                                     subtitle_family = \"Roboto\",\n                                     caption_family = \"Roboto\", \n                                     caption_size = 10,\n                                     plot_title_size = 16,\n                                     subtitle_size = 12) +\n  theme(legend.text = element_text(size=10), \n        legend.title = element_text(size=12),\n        legend.key.size = unit(0.5, \"cm\")))  #setam tema graficelor \n\n#x &lt;- get_eurostat(id=\"demo_r_mwk3_10\") \nx &lt;- read_csv(here::here(\"data\", \"post-5\", \"exces.csv\"))\n\nconvert &lt;-function(x){\n  if(nchar(x)==1){\n    paste0(\"0\", x)\n  } else {\n    x\n  }\n}\n\nconvert &lt;- Vectorize(convert, SIMPLIFY = TRUE)\n\n\n\n\nCode\nexces_2020 &lt;- x %&gt;% filter(year&gt;2014) %&gt;% filter(week&lt;54, year!=2023) %&gt;%\n  mutate(index = if_else(year%in%c(2015:2019), 0, year)) %&gt;% \n  group_by(age, geo, index, week) %&gt;% \n  summarise(normal = mean(values, na.rm=TRUE)) %&gt;% \n  ungroup() %&gt;% spread(index, normal) %&gt;% drop_na() %&gt;%\n  mutate(across(`2020`:`2022`, ~100*(.-`0`)/`0`))\n\nexces &lt;- exces_2020 %&gt;% \n  filter(week&lt;55) %&gt;% \n  gather(`2020`:`2022`, key='ani', value='exces') %&gt;% \n  mutate(time = paste0(ani, \"-W\",convert(week), \"-3\") %&gt;% \n                ISOweek::ISOweek2date(.))\n\n\nexces %&gt;% \n  filter(age=='TOTAL', grepl(\"^[A-Z]{2}$\",geo)) %&gt;% \n  ggplot(aes(x=time, y=exces, group=geo)) + geom_line(aes(colour=geo),\n                                                      size=1) +\n  gghighlight::gghighlight(geo%in%c(\"RO\",\"BG\",\"HU\",\"PL\",\"CZ\"),\n                           use_direct_label = FALSE,\n                           unhighlighted_params = list(size=0.5),\n                           calculate_per_facet = TRUE) +\n  scale_color_tableau() +\n  labs(title=\"Excesul de mortalitate în Europa\", x=NULL, y=\"Exces (%)\",\n       caption='Sursa: Eurostat, demo_r_mwk_3_10', \n       subtitle=\"Raportat la media 2015-2019\", colour='Ţară') +\n  scale_y_continuous(labels=scales::percent_format(scale=1)) +\n  geom_hline(yintercept=0, linetype=2)\n\n\n\n\n\n\n\n\n\nAm stat destul de rău, fiind destul de sus la mortalitate în perioadele-cheie ale pandemiei. Să vedem mortalităţile pe categorii de vârste.\n\n\nCode\nexces_age &lt;- x %&gt;% \n  filter(year&gt;2014) %&gt;% filter(week&lt;54, year!=2023) %&gt;%\n  filter(grepl(\"^[A-Z]{2}$\", geo)) %&gt;% \n  mutate(time = paste0(year, \"-W\", convert(week), \"-3\") %&gt;% ISOweek::ISOweek2date(.)) %&gt;%\n  mutate(month=lubridate::month(time)) %&gt;%\n  mutate(index = if_else(year%in%c(2015:2019), 0, year)) %&gt;% \n  group_by(age, index, month) %&gt;% \n  summarise(normal = mean(values, na.rm=TRUE)) %&gt;% \n  ungroup() %&gt;% spread(index, normal) %&gt;% drop_na() %&gt;%\n  mutate(across(`2020`:`2022`, ~100*(.-`0`)/`0`)) %&gt;%\n  gather(`2020`:`2022`, key='year', value='exces') %&gt;%\n  mutate(time = paste0(year, \"-\", convert(month), \"-01\") %&gt;% as.Date(.))\n\n\nexces_age %&gt;% filter(!grepl(\"TOTAL|UNK|GE80\", age)) %&gt;% \n    ggplot(aes(x=time, y=exces, fill=age)) + geom_col(aes(fill=age)) +\n    scale_y_continuous(labels=scales::percent_format(scale=1)) +\n    scale_fill_tableau() + facet_wrap(~age, ncol=2, scales='free') +\n    labs(title=\"Excesul de mortalitate pe vârste şi luni\", \n         caption='Sursa: Eurostat, r_demo_mwk_3_10', x=NULL, y=\"%\")\n\n\n\n\n\n\n\n\n\nInteresant, cei tineri au avut mortalităţi mai mici în general, abia la intervalul 50-59 ani începe să se balanseze situaţia. Categoria 60-69 de ani are deja mortalitate constant pozitivă în perioadele-cheie ale pandemiei.\nSă vizualizăm o hartă europeană cu excesul mediu de mortalitate după anul 2020 până în prezent.\n\n\nCode\nexces_geo &lt;- x %&gt;% \n    filter(year&gt;2014) %&gt;% filter(week&lt;54, year!=2023) %&gt;%\n    mutate(index = if_else(year%in%c(2015:2019), 0, 1)) %&gt;% \n    filter(age==\"TOTAL\") %&gt;%\n    group_by(age, geo, index) %&gt;% \n    summarise(normal = mean(values, na.rm=TRUE)) %&gt;% \n    ungroup() %&gt;% spread(index, normal) %&gt;% drop_na() %&gt;% select(-age) %&gt;%\n    mutate(exces = 100*(`1`-`0`)/`0`)\n\nharta &lt;- eurostat::eurostat_geodata_60_2016 %&gt;% as_tibble() %&gt;%\n         mutate(index = if_else(grepl(\"^DE\", geo) & LEVL_CODE&gt;1, 0, 1)) %&gt;% \n         filter(index!=0) %&gt;%\n         group_by(CNTR_CODE) %&gt;% slice_max(order_by=LEVL_CODE, n=1) %&gt;% ungroup() \n\nexces_geo %&gt;% inner_join(harta) %&gt;% \n  mutate(exces=cut_number(exces, n=10)) %&gt;% st_as_sf() %&gt;%\n  ggplot() + geom_sf(aes(fill=exces), colour=NA) +\n  geom_sf(data = {eurostat::eurostat_geodata_60_2016 %&gt;% filter(LEVL_CODE==0) %&gt;%\n                 st_as_sf() %&gt;% st_cast(., \"MULTILINESTRING\") %&gt;% \n                 as_tibble() %&gt;% st_as_sf()} , \n          colour='black') +\n  scale_fill_tableau(palette = \"Classic Orange-Blue\", \n                     type=\"ordered-diverging\", direction = -1) +\n  scale_x_continuous(limits = c(-11, 30)) +\n  scale_y_continuous(limits = c(35, 70))\n\n\n\n\n\n\n\n\n\nInteresant la această hartă este diviziunea Germaniei de Est de cea de Vest. Istoria contează aparent şi când e vorba de mortalitatea de COVID.\n\n\nCode\nmortalitati &lt;- x %&gt;% \n    filter(year&gt;2014) %&gt;% filter(week&lt;54, year!=2023) %&gt;%\n    filter(grepl(\"^[A-Z]{2}$\", geo)) %&gt;% \n    mutate(time = paste0(year, \"-W\", convert(week), \"-3\") %&gt;% \n                  ISOweek::ISOweek2date(.)) %&gt;%\n    mutate(month=lubridate::month(time)) %&gt;%\n    mutate(index = if_else(year%in%c(2015:2019), 0, year)) %&gt;% \n    mutate(spatial = if_else(grepl(\"RO\", geo), \"România\", \"Europa\")) %&gt;%\n    group_by(age, index, spatial) %&gt;% \n    summarise(normal = mean(values, na.rm=TRUE)) %&gt;% \n    ungroup() %&gt;% spread(index, normal) %&gt;% drop_na() %&gt;%\n    filter(age!=\"UNK\") %&gt;% filter(age!=\"Y_GE80\") %&gt;% filter(age!=\"TOTAL\") %&gt;%\n    mutate(age = fct_relevel(age, \"Y_GE90\", after=11)) %&gt;%\n    arrange(age)\n\nmortalitati %&gt;% rename(\"2015-2019\" = `0`) %&gt;% \n  gt(rowname_col=\"age\", groupname_col = 'spatial') %&gt;%\n  gtExtras::gt_theme_538() %&gt;%\n  gt::opt_table_font(font=\"Roboto\") %&gt;%\n  gt::cols_width(matches(\"[0-9]+\") ~ \"100px\") %&gt;%\n  gt::tab_stubhead(label = \"Regiune\") %&gt;%\n  gt::fmt_number(columns=2:6, sep_mark = \",\", decimals = 0) %&gt;%\n  gt::tab_style(style = cell_text(\"black\", weight = \"bold\"), \n                locations = cells_row_groups()) %&gt;%\n  gt::tab_style(style=cell_fill(color=\"#daae91\"), \n                locations=cells_row_groups()) %&gt;%\n  gt::tab_style(cell_text(color='black'), \n                locations=cells_column_labels()) %&gt;%\n  gt::tab_options(column_labels.background.color = \"#EEA100\") %&gt;%\n  gt::tab_header(title=\"Numărul mediu de decese săptămânale\", \n                 subtitle=\"Sursa: Eurostat, r_demo_mwk_3_10\") %&gt;%\n  gt::tab_style(cell_text(color='black', weight = \"bold\"), \n                cells_title(groups = \"title\")) %&gt;%\n  gt::tab_style(cell_text(weight='bold'), cells_column_labels()) %&gt;%\n  gtExtras::gt_color_rows(columns=2:6, palette = \"ggsci::orange_material\")\n\n\n\n\n\n\n  \n    \n    \n    \n    \n    \n  \n  \n    \n      Numărul mediu de decese săptămânale\n    \n    \n      Sursa: Eurostat, r_demo_mwk_3_10\n    \n    \n      Regiune\n      2015-2019\n      2020\n      2021\n      2022\n    \n  \n  \n    \n      Europa\n    \n    Y_LT10\n13\n12\n10\n11\n    Y10-19\n5\n5\n5\n5\n    Y20-29\n14\n13\n12\n13\n    Y30-39\n28\n28\n26\n26\n    Y40-49\n71\n70\n67\n64\n    Y50-59\n188\n190\n183\n173\n    Y60-69\n386\n415\n415\n393\n    Y70-79\n638\n716\n686\n673\n    Y80-89\n1,061\n1,180\n1,080\n1,098\n    Y_GE90\n610\n727\n655\n716\n    \n      România\n    \n    Y_LT10\n34\n28\n27\n26\n    Y10-19\n13\n11\n12\n11\n    Y20-29\n28\n24\n25\n21\n    Y30-39\n63\n63\n69\n54\n    Y40-49\n205\n201\n230\n183\n    Y50-59\n435\n470\n536\n434\n    Y60-69\n919\n1,090\n1,235\n939\n    Y70-79\n1,229\n1,396\n1,646\n1,283\n    Y80-89\n1,637\n1,847\n2,032\n1,655\n    Y_GE90\n451\n558\n614\n564"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "Despre blog",
    "section": "",
    "text": "Acest blog are scopul de a informa opinia publică pe subiecte socio-economice în special axate pe România în contextul ei european. Autorul blogului, Petre Buciu, nu este de profesie economist, ci mai degrabă un amator de economie și statistică în timpul său liber când nu activează ca medic de laborator, profesia sa principală. Sper că veți găsi blogul interesant. Primesc sugestii la adresa de mail buciu_petre2013@yahoo.com. Dacă vă place ce citiți, poate vă gândiți să susțineți financiar blogul aici cu o sumă oricât de mică."
  },
  {
    "objectID": "posts/2023-06-12-povara-fiscala-conform-oecd/2023-06-12-povara-fiscala-conform-oecd.html",
    "href": "posts/2023-06-12-povara-fiscala-conform-oecd/2023-06-12-povara-fiscala-conform-oecd.html",
    "title": "Povara fiscală conform OECD",
    "section": "",
    "text": "E un lucru bine cunoscut că România are un sistem fiscal regresiv datorită cotei sale unice pe venituri şi contribuţiilor sociale foarte mari, contribuţii pe care cei cu venituri superioare (cum sunt cei cu PFA/PFI, meseriile liberale, microîntreprinderi) le pot evita într-o oarecare măsură. Astfel povara fiscală atârnă pe cei mai puţin norocoşi. OECD are un calculator online de taxe care oferă şi datele sub formă de Excel şi astfel ne permite să facem nişte calcule vis-a-vis de povara fiscală din fiecare ţară. Am ales să ne concentrăm pe anul 2022, aşadar vom avea o analiză cross-secţională.\n\n\nCode\nlibrary(tidyverse)\nlibrary(hrbrthemes)\nlibrary(ggthemes)\nlibrary(gt)\nlibrary(gtExtras)\ntheme_set(hrbrthemes::theme_ipsum_tw(strip_text_size = 14, \n                                     strip_text_family = \"Roboto\",\n                                     strip_text_face = \"italic\",\n                                     axis_title_size = 12,\n                                     axis_text_size = 10,\n                                     base_family = \"Roboto\",\n                                     plot_title_family = \"Roboto\",\n                                     subtitle_family = \"Roboto\",\n                                     caption_family = \"Roboto\", \n                                     caption_size = 10,\n                                     plot_title_size = 16,\n                                     subtitle_size = 12) +\n  theme(legend.text = element_text(size=10), \n        legend.title = element_text(size=12),\n        legend.key.size = unit(0.5, \"cm\")))  #setam tema graficelor \n\nx &lt;- read_csv(here::here(\"data/post-9\", \"povara_fiscala.csv\")) %&gt;%\n     select(-ub, -hb, -fb, -year)\n\n\nDatele sunt pentru adultul singur fără copii. Să vedem povara fiscală pentru salariatul ce câştigă 60 % din salariul mediu (aproape de minimum, unde există), salariul mediu şi de trei ori salariul mediu (în general top 10 %).\n\n\n\nCode\nx %&gt;% filter(earnings==100 | earnings==60 | earnings == 300) %&gt;% \n  mutate(it=-it, sc=-sc) %&gt;% \n  mutate(earnings=paste(earnings, \"%\")) %&gt;%\n  mutate(earnings=factor(earnings, \n                         levels=c(\"60 %\", \n                                  \"100 %\", \n                                  \"300 %\"))) %&gt;%\n  mutate_at(vars(net:sc), ~./`Average Wage`) %&gt;%\n  mutate(color = if_else(grepl(\"Romania\", Country), \n                         \"#ba0000\", \"#444444\"),\n  name = glue::glue(\"&lt;i style='color:{color}'&gt;{Country}&lt;/i&gt;\")) %&gt;%\n  mutate(name = tidytext::reorder_within(name, earnings, \n                                          by={abs(it+sc)})) %&gt;%\n  gather(gross:sc, key=\"Indicator\", value='valoare') %&gt;%\n  mutate(Indicator = factor(Indicator, \n                          levels=c(\"iw\", \"gross\",\"sa\",\"it\", \"sc\"))) %&gt;%\n  ggplot(aes(x=name, y=valoare, fill=Indicator)) + \n  geom_col(aes(fill=Indicator)) + scale_fill_tableau() + \n  geom_point(aes(x=name, y=net), shape=4, show.legend = FALSE) +\n  tidytext::scale_x_reordered() + \n  geom_hline(yintercept = 0, linetype=2) + \n  facet_wrap(~earnings, ncol=3, scales='free') + \n  coord_flip() +\n  labs(title=\"Povara fiscală după categorii de venit\",\n       subtitle=\"Taxe şi venituri ca procent din salariul mediu\", \n       x=NULL, y=NULL, caption=\"Sursa: OECD Tax Benefits Calculator\") +\n  theme(legend.position = \"top\",\n        axis.text.y = ggtext::element_markdown())\n\n\n\n\n\nFigure 1: Povara fiscală după clasa socială\n\n\n\n\n\nLegenda, din lipsă de spaţiu, o traducem aici: gross - venitul brut, it - impozitul pe venit, sc - contribuţiile sociale, iw - beneficii în muncă, sa - asistenţă socială şi venit minim garantat. Steluţa reprezintă venitul net - cât mai rămâne după taxe.\nCe observăm din acest grafic ? Că România are cea mai mare povara fiscală pe angajatul precar şi pe angajatul mediu, dar angajatul bogat este undeva prin treimea a doua a clasamentului, bine-merci. Vedem aşadar în practică efectele cotei unice: distribuţia poverii fiscale pe cei care nu au, lucru care necesită şi rate mai mari. Să nu ne mirăm că munca este taxată în România."
  },
  {
    "objectID": "posts/2023-06-12-povara-fiscala-conform-oecd/2023-06-12-povara-fiscala-conform-oecd.html#inechitatea-sistemului-fiscal-din-românia",
    "href": "posts/2023-06-12-povara-fiscala-conform-oecd/2023-06-12-povara-fiscala-conform-oecd.html#inechitatea-sistemului-fiscal-din-românia",
    "title": "Povara fiscală conform OECD",
    "section": "",
    "text": "E un lucru bine cunoscut că România are un sistem fiscal regresiv datorită cotei sale unice pe venituri şi contribuţiilor sociale foarte mari, contribuţii pe care cei cu venituri superioare (cum sunt cei cu PFA/PFI, meseriile liberale, microîntreprinderi) le pot evita într-o oarecare măsură. Astfel povara fiscală atârnă pe cei mai puţin norocoşi. OECD are un calculator online de taxe care oferă şi datele sub formă de Excel şi astfel ne permite să facem nişte calcule vis-a-vis de povara fiscală din fiecare ţară. Am ales să ne concentrăm pe anul 2022, aşadar vom avea o analiză cross-secţională.\n\n\nCode\nlibrary(tidyverse)\nlibrary(hrbrthemes)\nlibrary(ggthemes)\nlibrary(gt)\nlibrary(gtExtras)\ntheme_set(hrbrthemes::theme_ipsum_tw(strip_text_size = 14, \n                                     strip_text_family = \"Roboto\",\n                                     strip_text_face = \"italic\",\n                                     axis_title_size = 12,\n                                     axis_text_size = 10,\n                                     base_family = \"Roboto\",\n                                     plot_title_family = \"Roboto\",\n                                     subtitle_family = \"Roboto\",\n                                     caption_family = \"Roboto\", \n                                     caption_size = 10,\n                                     plot_title_size = 16,\n                                     subtitle_size = 12) +\n  theme(legend.text = element_text(size=10), \n        legend.title = element_text(size=12),\n        legend.key.size = unit(0.5, \"cm\")))  #setam tema graficelor \n\nx &lt;- read_csv(here::here(\"data/post-9\", \"povara_fiscala.csv\")) %&gt;%\n     select(-ub, -hb, -fb, -year)\n\n\nDatele sunt pentru adultul singur fără copii. Să vedem povara fiscală pentru salariatul ce câştigă 60 % din salariul mediu (aproape de minimum, unde există), salariul mediu şi de trei ori salariul mediu (în general top 10 %).\n\n\n\nCode\nx %&gt;% filter(earnings==100 | earnings==60 | earnings == 300) %&gt;% \n  mutate(it=-it, sc=-sc) %&gt;% \n  mutate(earnings=paste(earnings, \"%\")) %&gt;%\n  mutate(earnings=factor(earnings, \n                         levels=c(\"60 %\", \n                                  \"100 %\", \n                                  \"300 %\"))) %&gt;%\n  mutate_at(vars(net:sc), ~./`Average Wage`) %&gt;%\n  mutate(color = if_else(grepl(\"Romania\", Country), \n                         \"#ba0000\", \"#444444\"),\n  name = glue::glue(\"&lt;i style='color:{color}'&gt;{Country}&lt;/i&gt;\")) %&gt;%\n  mutate(name = tidytext::reorder_within(name, earnings, \n                                          by={abs(it+sc)})) %&gt;%\n  gather(gross:sc, key=\"Indicator\", value='valoare') %&gt;%\n  mutate(Indicator = factor(Indicator, \n                          levels=c(\"iw\", \"gross\",\"sa\",\"it\", \"sc\"))) %&gt;%\n  ggplot(aes(x=name, y=valoare, fill=Indicator)) + \n  geom_col(aes(fill=Indicator)) + scale_fill_tableau() + \n  geom_point(aes(x=name, y=net), shape=4, show.legend = FALSE) +\n  tidytext::scale_x_reordered() + \n  geom_hline(yintercept = 0, linetype=2) + \n  facet_wrap(~earnings, ncol=3, scales='free') + \n  coord_flip() +\n  labs(title=\"Povara fiscală după categorii de venit\",\n       subtitle=\"Taxe şi venituri ca procent din salariul mediu\", \n       x=NULL, y=NULL, caption=\"Sursa: OECD Tax Benefits Calculator\") +\n  theme(legend.position = \"top\",\n        axis.text.y = ggtext::element_markdown())\n\n\n\n\n\nFigure 1: Povara fiscală după clasa socială\n\n\n\n\n\nLegenda, din lipsă de spaţiu, o traducem aici: gross - venitul brut, it - impozitul pe venit, sc - contribuţiile sociale, iw - beneficii în muncă, sa - asistenţă socială şi venit minim garantat. Steluţa reprezintă venitul net - cât mai rămâne după taxe.\nCe observăm din acest grafic ? Că România are cea mai mare povara fiscală pe angajatul precar şi pe angajatul mediu, dar angajatul bogat este undeva prin treimea a doua a clasamentului, bine-merci. Vedem aşadar în practică efectele cotei unice: distribuţia poverii fiscale pe cei care nu au, lucru care necesită şi rate mai mari. Să nu ne mirăm că munca este taxată în România."
  },
  {
    "objectID": "posts/2023-06-13-povara-fiscala-asupra-factorilor-de-productie/2023-06-13-povara-fiscala-asupra-factorilor-de-productie.html",
    "href": "posts/2023-06-13-povara-fiscala-asupra-factorilor-de-productie/2023-06-13-povara-fiscala-asupra-factorilor-de-productie.html",
    "title": "Povara fiscală asupra factorilor de producţie",
    "section": "",
    "text": "Comisia Europeană şi Eurostat calculează anual pentru fiecare ţară a Uniunii Europene suma strânsă la bugetul propriu din diferite categorii de taxe, categorii gândite în jurul factorilor clasici de producţie (muncă, capital, dar şi consum, proprietate, taxe ecologice). Metodologia de calcul este complexă şi poate fi citită aici. Vom vedea în acest post cum stăm cu taxarea acestor categorii în contextul european.\n\n\nCode\nlibrary(tidyverse)\nlibrary(hrbrthemes)\nlibrary(ggthemes)\nlibrary(gt)\nlibrary(gtExtras)\ntheme_set(hrbrthemes::theme_ipsum_tw(strip_text_size = 14, \n                                     strip_text_family = \"Roboto\",\n                                     strip_text_face = \"italic\",\n                                     axis_title_size = 12,\n                                     axis_text_size = 10,\n                                     base_family = \"Roboto\",\n                                     plot_title_family = \"Roboto\",\n                                     subtitle_family = \"Roboto\",\n                                     caption_family = \"Roboto\", \n                                     caption_size = 10,\n                                     plot_title_size = 16,\n                                     subtitle_size = 12) +\n  theme(legend.text = element_text(size=10), \n        legend.title = element_text(size=12),\n        legend.key.size = unit(0.5, \"cm\")))  #setam tema graficelor \n\ndf &lt;- read_csv(here::here(\"data/post-10\", \n                          \"taxation_trends_eurostat.csv\")) %&gt;% \n      select(-contributii) \n\n\nPentru că România ar ieşi la coada clasamentului la mai toate categoriile, vom analiza şi procentul din totalul veniturilor la buget, nu doar procentul din PIB. În acest sens vedem structura veniturilor la buget mai clar.\n\n% din PIB% din total\n\n\n\n\nCode\ndf %&gt;% filter(what==\"PIB\") %&gt;% \n  select(-what) %&gt;% filter(time%in%c(2021)) %&gt;% \n  gather(3:6, key='Indicator', value='valoare') %&gt;% \n  mutate(geo = tidytext::reorder_within(geo, \n                                        within = Indicator, valoare)) %&gt;%\n  ggplot(aes(x=geo, y=valoare)) + \n  geom_col(aes(fill=grepl(\"Romania\", geo)), show.legend = FALSE) + \n  tidytext::scale_x_reordered() + coord_flip() + \n  scale_y_continuous(labels=scales::percent_format(scale=1)) +\n  facet_wrap(~Indicator, ncol=2, scales='free') +\n  scale_fill_tableau(direction = -1) +\n  labs(x=NULL, y=NULL)\n\n\n\n\n\nFigure 1: O imagine de ansamblu\n\n\n\n\n\n\n\n\nCode\ndf %&gt;% filter(what==\"Total\") %&gt;% \n  select(-what) %&gt;% filter(time%in%c(2021)) %&gt;% \n  gather(3:6, key='Indicator', value='valoare') %&gt;% \n  mutate(geo = tidytext::reorder_within(geo, \n                                        within = Indicator, valoare)) %&gt;%\n  ggplot(aes(x=geo, y=valoare)) + \n  geom_col(aes(fill=grepl(\"Romania\", geo)), show.legend = FALSE) + \n  tidytext::scale_x_reordered() + coord_flip() + \n  scale_y_continuous(labels=scales::percent_format(scale=1)) +\n  facet_wrap(~Indicator, ncol=2, scales='free') +\n  scale_fill_tableau(direction = -1) +\n  labs(x=NULL, y=NULL)\n\n\n\n\n\nFigure 2: O imagine de ansamblu\n\n\n\n\n\n\n\nCa procent din PIB suntem codaşi la toate aceste categorii, lucru explicabil prin procentul mic de venituri fiscale colectate din PIB în ţara noastră, unde suntem de asemenea ultimii. Nu mai ilustrez pentru că situaţia este ultra-cunoscută. Ca procent din total, suntem fruntaşi la taxarea consumului, împreună cu estul Europei."
  },
  {
    "objectID": "posts/2023-06-13-povara-fiscala-asupra-factorilor-de-productie/2023-06-13-povara-fiscala-asupra-factorilor-de-productie.html#tipuri-de-taxe",
    "href": "posts/2023-06-13-povara-fiscala-asupra-factorilor-de-productie/2023-06-13-povara-fiscala-asupra-factorilor-de-productie.html#tipuri-de-taxe",
    "title": "Povara fiscală asupra factorilor de producţie",
    "section": "",
    "text": "Comisia Europeană şi Eurostat calculează anual pentru fiecare ţară a Uniunii Europene suma strânsă la bugetul propriu din diferite categorii de taxe, categorii gândite în jurul factorilor clasici de producţie (muncă, capital, dar şi consum, proprietate, taxe ecologice). Metodologia de calcul este complexă şi poate fi citită aici. Vom vedea în acest post cum stăm cu taxarea acestor categorii în contextul european.\n\n\nCode\nlibrary(tidyverse)\nlibrary(hrbrthemes)\nlibrary(ggthemes)\nlibrary(gt)\nlibrary(gtExtras)\ntheme_set(hrbrthemes::theme_ipsum_tw(strip_text_size = 14, \n                                     strip_text_family = \"Roboto\",\n                                     strip_text_face = \"italic\",\n                                     axis_title_size = 12,\n                                     axis_text_size = 10,\n                                     base_family = \"Roboto\",\n                                     plot_title_family = \"Roboto\",\n                                     subtitle_family = \"Roboto\",\n                                     caption_family = \"Roboto\", \n                                     caption_size = 10,\n                                     plot_title_size = 16,\n                                     subtitle_size = 12) +\n  theme(legend.text = element_text(size=10), \n        legend.title = element_text(size=12),\n        legend.key.size = unit(0.5, \"cm\")))  #setam tema graficelor \n\ndf &lt;- read_csv(here::here(\"data/post-10\", \n                          \"taxation_trends_eurostat.csv\")) %&gt;% \n      select(-contributii) \n\n\nPentru că România ar ieşi la coada clasamentului la mai toate categoriile, vom analiza şi procentul din totalul veniturilor la buget, nu doar procentul din PIB. În acest sens vedem structura veniturilor la buget mai clar.\n\n% din PIB% din total\n\n\n\n\nCode\ndf %&gt;% filter(what==\"PIB\") %&gt;% \n  select(-what) %&gt;% filter(time%in%c(2021)) %&gt;% \n  gather(3:6, key='Indicator', value='valoare') %&gt;% \n  mutate(geo = tidytext::reorder_within(geo, \n                                        within = Indicator, valoare)) %&gt;%\n  ggplot(aes(x=geo, y=valoare)) + \n  geom_col(aes(fill=grepl(\"Romania\", geo)), show.legend = FALSE) + \n  tidytext::scale_x_reordered() + coord_flip() + \n  scale_y_continuous(labels=scales::percent_format(scale=1)) +\n  facet_wrap(~Indicator, ncol=2, scales='free') +\n  scale_fill_tableau(direction = -1) +\n  labs(x=NULL, y=NULL)\n\n\n\n\n\nFigure 1: O imagine de ansamblu\n\n\n\n\n\n\n\n\nCode\ndf %&gt;% filter(what==\"Total\") %&gt;% \n  select(-what) %&gt;% filter(time%in%c(2021)) %&gt;% \n  gather(3:6, key='Indicator', value='valoare') %&gt;% \n  mutate(geo = tidytext::reorder_within(geo, \n                                        within = Indicator, valoare)) %&gt;%\n  ggplot(aes(x=geo, y=valoare)) + \n  geom_col(aes(fill=grepl(\"Romania\", geo)), show.legend = FALSE) + \n  tidytext::scale_x_reordered() + coord_flip() + \n  scale_y_continuous(labels=scales::percent_format(scale=1)) +\n  facet_wrap(~Indicator, ncol=2, scales='free') +\n  scale_fill_tableau(direction = -1) +\n  labs(x=NULL, y=NULL)\n\n\n\n\n\nFigure 2: O imagine de ansamblu\n\n\n\n\n\n\n\nCa procent din PIB suntem codaşi la toate aceste categorii, lucru explicabil prin procentul mic de venituri fiscale colectate din PIB în ţara noastră, unde suntem de asemenea ultimii. Nu mai ilustrez pentru că situaţia este ultra-cunoscută. Ca procent din total, suntem fruntaşi la taxarea consumului, împreună cu estul Europei."
  },
  {
    "objectID": "posts/2023-06-13-povara-fiscala-asupra-factorilor-de-productie/2023-06-13-povara-fiscala-asupra-factorilor-de-productie.html#din-pib",
    "href": "posts/2023-06-13-povara-fiscala-asupra-factorilor-de-productie/2023-06-13-povara-fiscala-asupra-factorilor-de-productie.html#din-pib",
    "title": "Povara fiscală asupra factorilor de producţie",
    "section": "2 % din PIB",
    "text": "2 % din PIB\n\n\nCode\ndf %&gt;% filter(what==\"PIB\") %&gt;% \n  select(-what) %&gt;% filter(time%in%c(2021)) %&gt;% \n  gather(3:6, key='Indicator', value='valoare') %&gt;% \n  mutate(geo = tidytext::reorder_within(geo, \n                                        within = Indicator, valoare)) %&gt;%\n  ggplot(aes(x=geo, y=valoare)) + \n  geom_col(aes(fill=grepl(\"Romania\", geo))) + \n  tidytext::scale_x_reordered() + coord_flip() + \n  facet_wrap(~Indicator, ncol=2, scales='free') +\n  scale_fill_tableau(direction = -1)\n\n\n\n\n\nFigure 1: O imagine de ansamblu"
  },
  {
    "objectID": "posts/2023-06-13-povara-fiscala-asupra-factorilor-de-productie/2023-06-13-povara-fiscala-asupra-factorilor-de-productie.html#din-total",
    "href": "posts/2023-06-13-povara-fiscala-asupra-factorilor-de-productie/2023-06-13-povara-fiscala-asupra-factorilor-de-productie.html#din-total",
    "title": "Povara fiscală asupra factorilor de producţie",
    "section": "3 % din total",
    "text": "3 % din total\n\n\nCode\ndf %&gt;% filter(what==\"Total\") %&gt;% \n  select(-what) %&gt;% filter(time%in%c(2021)) %&gt;% \n  gather(3:6, key='Indicator', value='valoare') %&gt;% \n  mutate(geo = tidytext::reorder_within(geo, \n                                        within = Indicator, valoare)) %&gt;%\n  ggplot(aes(x=geo, y=valoare)) + \n  geom_col(aes(fill=grepl(\"Romania\", geo))) + \n  tidytext::scale_x_reordered() + coord_flip() + \n  facet_wrap(~Indicator, ncol=2, scales='free') +\n  scale_fill_tableau(direction = -1)\n\n\n\n\n\nFigure 2: O imagine de ansamblu"
  },
  {
    "objectID": "posts/2023-06-13-veniturile-din-taxarea-factorilor-de-productie/2023-06-13-veniturile-din-taxarea-factorilor-de-productie.html",
    "href": "posts/2023-06-13-veniturile-din-taxarea-factorilor-de-productie/2023-06-13-veniturile-din-taxarea-factorilor-de-productie.html",
    "title": "O analiză a veniturilor bugetare în Europa",
    "section": "",
    "text": "Eurostat are date şi despre veniturile bugetare, nu doar despre cheltuieli, pe care le-am analizat sumar într-un post anterior. Vom folosi în acest scop fişierul lor numit gov_10_taxag, cu informaţii despre veniturile din taxe, contribuţii, tot ce înseamnă venit fiscal.\n\n\nCode\nlibrary(tidyverse)\nlibrary(hrbrthemes)\nlibrary(ggthemes)\nlibrary(gt)\nlibrary(gtExtras)\ntheme_set(hrbrthemes::theme_ipsum_tw(strip_text_size = 14, \n                                     strip_text_family = \"Roboto\",\n                                     strip_text_face = \"italic\",\n                                     axis_title_size = 12,\n                                     axis_text_size = 10,\n                                     base_family = \"Roboto\",\n                                     plot_title_family = \"Roboto\",\n                                     subtitle_family = \"Roboto\",\n                                     caption_family = \"Roboto\", \n                                     caption_size = 10,\n                                     plot_title_size = 16,\n                                     subtitle_size = 12) +\n  theme(legend.text = element_text(size=10), \n        legend.title = element_text(size=12),\n        legend.key.size = unit(0.5, \"cm\")))  #setam tema graficelor \n\ndf &lt;- read_csv(here::here(\"data/post-10\", \"gov_10a_taxag_prelucrat.csv\")) \n\n\nSă vedem clasamentul per tipuri majore de taxe: pe consum, contribuţiile şi taxarea pe venit (care include impozitul pe venit personal şi impozitul pe profit). Avem trei categorii majore. Vom seta anul de referinţă 2021, ultimul pentru care avem date la toate ţările.\n\n\nCode\ndf %&gt;% \n  filter(grepl(\"Taxes on production and imports|Net social|Taxes on income$\",\n               na_item), time==\"2021-01-01\") %&gt;% \n  mutate(na_item = gsub(\"Taxes on produc.+\", \"Consum\", na_item) %&gt;% \n                   gsub(\"Net social contr.+\", \"Contribuţii\", .) %&gt;%\n                   gsub(\"Taxes on income\", \"Venit\", .)) %&gt;% \n  mutate(geo = tidytext::reorder_within(geo, within = na_item, values)) %&gt;%\n  ggplot(aes(x=geo, y=values)) + \n  geom_col(aes(fill=grepl(\"Romania\", geo)), show.legend = FALSE) + \n  tidytext::scale_x_reordered() +\n  coord_flip() + \n  scale_y_continuous(labels=scales::percent_format(scale=1)) +\n  scale_fill_tableau(direction = -1) +\n  facet_wrap(~na_item, ncol=3, scales='free') +\n  labs(x=NULL, y=NULL, title=\"Cele trei tipuri majore de taxare\", \n       subtitle=\"Anul 2021, % PIB\",\n       caption=\"Sursa: Eurostat, gov_10a_taxag\") + \n  theme(legend.position = \"top\")\n\n\n\n\n\nFigure 1: Tipuri principale de taxe\n\n\n\n\nCa procent din PIB suntem codaşi la toate aceste categorii, mai puţin contribuţii, lucru explicabil prin procentul mic de venituri fiscale colectate din PIB în ţara noastră, unde suntem de asemenea ultimii în afară de Irlanda. Nu mai ilustrez pentru că situaţia este ultra-cunoscută. Atenţie, ce vedem mai sunt sunt venituri din aceste taxe, nu taxarea efectivă pe care o resimte cetăţeanul. Cum e posibil să fim top la povară fiscală conform OECD (cum arătam într-un articol anterior) şi totuşi aşa de jos în clasamente la venituri ? O explicaţie ar fi baza scăzută de impozitare - avem foarte puţini salariaţi la mulţi pensionari, avem probleme de colectare la TVA, avem cotă unică de 10 % pe venituri, ceea ce ne face ultimii în Europa la procentul colectat din PIB la această categorie de venituri.\nDar cele trei tipuri sunt doar agregatele cele mai mari, Eurostat are date despre circa 93 de categorii de venituri, subcategorii ale categoriilor deja menţionate, dar nu vom intra în detalii de acest fel. În schimb, ne interesează desfăşurata în timp a acestor trei agregate principale.\n\n\nCode\ndf %&gt;% \n    filter(grepl(\"Taxes on production and imports|Net social|Taxes on income$\", na_item)) %&gt;% \n    mutate(na_item = gsub(\"Taxes on produc.+\", \"Consum\", na_item) %&gt;% \n               gsub(\"Net social contr.+\", \"Contribuţii\", .) %&gt;%\n               gsub(\"Taxes on income\", \"Venit\", .)) %&gt;% \n  filter(grepl(\"Romania|Bulgaria|Polonia|Ungaria\", geo)) %&gt;% \n  ggplot(aes(x=time, y=values, group=na_item)) + \n  geom_line(aes(colour=na_item), size=1) + \n  facet_wrap(~geo, ncol=2, scales='free') +\n  scale_y_continuous(labels=scales::percent_format(scale=1)) +\n  scale_color_tableau() +\n  labs(title=\"Principalele agregate fiscale în timp\", x=NULL, y=NULL,\n       caption=\"Sursa: Eurostat, gov_10a_taxag\", colour=\"Taxă\") +\n  theme(legend.position = \"top\")\n\n\n\n\n\nFigure 2: Principalele agregate desfăşurate în timp\n\n\n\n\nAcum vom face un lucru diferit şi vom studia veniturile din taxe după factorii de producţie implicaţi: capital, muncă, dar şi consum şi proprietate. Am ales aceste categorii pentru că ele sunt calculate special de Comisia Europeană şi Eurostat aici. Metodologia este şi ea tot în linkul respectiv. Vom vizualiza grafice în două axe şi doi ani distincţi: 2011 şi 2021. Pe orizontală avem procentul din total, pe verticală procentul din PIB. Săgeţile indică direcţia temporală, culoarea dacă vorbim de o creştere sau scădere.\n\n\nCode\nx &lt;- read_csv(here::here(\"data/post-10\", \"taxation_trends_eurostat.csv\")) %&gt;%\n     select(-contributii) %&gt;% mutate(time=as.character(time))\n\n\ngrafice &lt;- function(x, var, numar=10){\n  \n  segmente &lt;- x %&gt;% filter(time%in%c(\"2011\", \"2021\")) %&gt;% \n              select(geo, what, time, !!ensym(var)) %&gt;% \n              spread(what, !!ensym(var)) %&gt;% \n              pivot_wider(names_from = time, values_from = c(PIB, Total)) %&gt;%\n              filter(!grepl(\"Luxemb|Irlanda|Malta|Cipru\", geo)) %&gt;%\n              mutate(centru_x = 0.5*(Total_2011+Total_2021), \n                     centru_y=0.5*(PIB_2011+PIB_2021)) %&gt;%\n              mutate(delta = sqrt((PIB_2021-PIB_2011)^2 + (Total_2021-Total_2011)^2)) %&gt;%\n              mutate(directie = if_else(PIB_2021 &lt; PIB_2011 & Total_2021 &lt; Total_2011, \"Scădere\", \"Creştere\")) %&gt;%\n              arrange(desc(delta)) \n  \n  tari &lt;- segmente %&gt;% \n    arrange(desc(delta)) %&gt;%\n    mutate(index = if_else(row_number()&lt;numar | geo==\"Romania\", 1, 0)) %&gt;%\n    filter(index==1) %&gt;% select(-index) %&gt;% pull(geo)\n  \n  segmente %&gt;%\n    ggplot(aes(x=Total_2011, y=PIB_2011)) + \n    geom_point(colour='red3') + \n    geom_point(colour='red3', aes(x=Total_2021, y=PIB_2021)) +\n    geomtextpath::geom_textsegment(aes(x=Total_2011, xend=Total_2021, \n                                       y=PIB_2011, yend=PIB_2021, label=geo, size=delta,\n                                       colour=directie),\n                                   vjust=-0.3, arrow = arrow(length=unit(0.3, \"cm\")),\n                                   show.legend = FALSE) + \n    scale_x_continuous(labels=scales::percent_format(scale=1)) +\n    scale_y_continuous(labels=scales::percent_format(scale=1)) +\n    scale_size_continuous(range=c(2, 4)) +\n    scale_color_tableau() +\n    gghighlight::gghighlight(geo%in%tari) +\n    theme(legend.position = 'top')\n}\n\n\n\nCapitalMuncăConsumProprietate\n\n\n\n\nCode\ngrafice(x=x, var=capital, numar=10) +\n  labs(title = \"Taxarea capitalului\", \n       subtitle=\"2011 vs 2021\",\n       x=\"% din TOTAL\", y=\"% din PIB\",\n       caption=\"Sursa: Comisia Europeană\")\n\n\n\n\n\nFigure 3: Taxarea capitalului\n\n\n\n\n\n\n\n\nCode\n#| fig-width: 8\n#| fig-height: 6\n#| fig-dpi: 200\n#| label: fig-munca\n#| fig-cap: Taxarea muncii\n\ngrafice(x=x, var=munca, numar=10) +\n  labs(title = \"Taxarea muncii\", \n       subtitle=\"2011 vs 2021\", \n       x=\"% din TOTAL\", y=\"% din PIB\",\n       caption=\"Sursa: Comisia Europeană\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\ngrafice(x=x, var=consum, numar=10) +\n  labs(title = \"Taxarea consumului\", \n       subtitle = \"2011 vs 2021\",\n       x=\"% din TOTAL\", y=\"% din PIB\",\n       caption=\"Sursa: Comisia Europeană\")\n\n\n\n\n\nFigure 4: Taxarea consumului\n\n\n\n\n\n\n\n\nCode\n#| fig-width: 8\n#| fig-height: 6\n#| fig-dpi: 200\n#| label: fig-proprietate\n#| fig-cap: Taxarea proprietăţii\n\ngrafice(x=x, var=proprietate, numar=10) +\n  labs(title = \"Taxarea proprietăţilor\", \n       subtitle=\"2011 vs 2021\",\n       x=\"% din TOTAL\", y=\"% din PIB\",\n       caption=\"Sursa: Comisia Europeană\")\n\n\n\n\n\n\n\n\n\n\n\n\nObservăm că România a scăzut la venitul din capital, proprietate şi consum, dar a crescut la muncă. De asemnenea unele ţări au progresat enorm la taxarea capitalului, precum Danemarca şi Olanda."
  },
  {
    "objectID": "posts/2023-06-13-veniturile-din-taxarea-factorilor-de-productie/2023-06-13-veniturile-din-taxarea-factorilor-de-productie.html#tipuri-de-taxe",
    "href": "posts/2023-06-13-veniturile-din-taxarea-factorilor-de-productie/2023-06-13-veniturile-din-taxarea-factorilor-de-productie.html#tipuri-de-taxe",
    "title": "Veniturile din taxarea factorilor de producţie",
    "section": "",
    "text": "Comisia Europeană şi Eurostat calculează anual pentru fiecare ţară a Uniunii Europene suma strânsă la bugetul propriu din diferite categorii de taxe, categorii gândite în jurul factorilor clasici de producţie (muncă, capital, dar şi consum, proprietate, taxe ecologice). Metodologia de calcul este complexă şi poate fi citită aici. Vom vedea în acest post cum stăm cu taxarea acestor categorii în contextul european.\n\n\nCode\nlibrary(tidyverse)\nlibrary(hrbrthemes)\nlibrary(ggthemes)\nlibrary(gt)\nlibrary(gtExtras)\ntheme_set(hrbrthemes::theme_ipsum_tw(strip_text_size = 14, \n                                     strip_text_family = \"Roboto\",\n                                     strip_text_face = \"italic\",\n                                     axis_title_size = 12,\n                                     axis_text_size = 10,\n                                     base_family = \"Roboto\",\n                                     plot_title_family = \"Roboto\",\n                                     subtitle_family = \"Roboto\",\n                                     caption_family = \"Roboto\", \n                                     caption_size = 10,\n                                     plot_title_size = 16,\n                                     subtitle_size = 12) +\n  theme(legend.text = element_text(size=10), \n        legend.title = element_text(size=12),\n        legend.key.size = unit(0.5, \"cm\")))  #setam tema graficelor \n\ndf &lt;- read_csv(here::here(\"data/post-10\", \n                          \"taxation_trends_eurostat.csv\")) %&gt;% \n      select(-contributii) \n\n\nPentru că România ar ieşi la coada clasamentului la mai toate categoriile, vom analiza şi procentul din totalul veniturilor la buget, nu doar procentul din PIB. În acest sens vedem structura veniturilor la buget mai clar.\n\n% din PIB% din total\n\n\n\n\nCode\ndf %&gt;% filter(what==\"PIB\") %&gt;% \n  select(-what) %&gt;% filter(time%in%c(2021)) %&gt;% \n  gather(3:6, key='Indicator', value='valoare') %&gt;% \n  mutate(geo = tidytext::reorder_within(geo, \n                                        within = Indicator, valoare)) %&gt;%\n  ggplot(aes(x=geo, y=valoare)) + \n  geom_col(aes(fill=grepl(\"Romania\", geo)), show.legend = FALSE) + \n  tidytext::scale_x_reordered() + coord_flip() + \n  scale_y_continuous(labels=scales::percent_format(scale=1)) +\n  facet_wrap(~Indicator, ncol=2, scales='free') +\n  scale_fill_tableau(direction = -1) +\n  labs(x=NULL, y=NULL)\n\n\n\n\n\nFigure 1: O imagine de ansamblu\n\n\n\n\n\n\n\n\nCode\ndf %&gt;% filter(what==\"Total\") %&gt;% \n  select(-what) %&gt;% filter(time%in%c(2021)) %&gt;% \n  gather(3:6, key='Indicator', value='valoare') %&gt;% \n  mutate(geo = tidytext::reorder_within(geo, \n                                        within = Indicator, valoare)) %&gt;%\n  ggplot(aes(x=geo, y=valoare)) + \n  geom_col(aes(fill=grepl(\"Romania\", geo)), show.legend = FALSE) + \n  tidytext::scale_x_reordered() + coord_flip() + \n  scale_y_continuous(labels=scales::percent_format(scale=1)) +\n  facet_wrap(~Indicator, ncol=2, scales='free') +\n  scale_fill_tableau(direction = -1) +\n  labs(x=NULL, y=NULL)\n\n\n\n\n\nFigure 2: O imagine de ansamblu\n\n\n\n\n\n\n\nCa procent din PIB suntem codaşi la toate aceste categorii, lucru explicabil prin procentul mic de venituri fiscale colectate din PIB în ţara noastră, unde suntem de asemenea ultimii. Nu mai ilustrez pentru că situaţia este ultra-cunoscută. Ca procent din total, suntem fruntaşi la taxarea consumului, împreună cu estul Europei."
  },
  {
    "objectID": "posts/2023-06-13-veniturile-din-taxarea-factorilor-de-productie/2023-06-13-veniturile-din-taxarea-factorilor-de-productie.html#analiza-exploratorie",
    "href": "posts/2023-06-13-veniturile-din-taxarea-factorilor-de-productie/2023-06-13-veniturile-din-taxarea-factorilor-de-productie.html#analiza-exploratorie",
    "title": "O analiză a veniturilor bugetare în Europa",
    "section": "",
    "text": "Eurostat are date şi despre veniturile bugetare, nu doar despre cheltuieli, pe care le-am analizat sumar într-un post anterior. Vom folosi în acest scop fişierul lor numit gov_10_taxag, cu informaţii despre veniturile din taxe, contribuţii, tot ce înseamnă venit fiscal.\n\n\nCode\nlibrary(tidyverse)\nlibrary(hrbrthemes)\nlibrary(ggthemes)\nlibrary(gt)\nlibrary(gtExtras)\ntheme_set(hrbrthemes::theme_ipsum_tw(strip_text_size = 14, \n                                     strip_text_family = \"Roboto\",\n                                     strip_text_face = \"italic\",\n                                     axis_title_size = 12,\n                                     axis_text_size = 10,\n                                     base_family = \"Roboto\",\n                                     plot_title_family = \"Roboto\",\n                                     subtitle_family = \"Roboto\",\n                                     caption_family = \"Roboto\", \n                                     caption_size = 10,\n                                     plot_title_size = 16,\n                                     subtitle_size = 12) +\n  theme(legend.text = element_text(size=10), \n        legend.title = element_text(size=12),\n        legend.key.size = unit(0.5, \"cm\")))  #setam tema graficelor \n\ndf &lt;- read_csv(here::here(\"data/post-10\", \"gov_10a_taxag_prelucrat.csv\")) \n\n\nSă vedem clasamentul per tipuri majore de taxe: pe consum, contribuţiile şi taxarea pe venit (care include impozitul pe venit personal şi impozitul pe profit). Avem trei categorii majore. Vom seta anul de referinţă 2021, ultimul pentru care avem date la toate ţările.\n\n\nCode\ndf %&gt;% \n  filter(grepl(\"Taxes on production and imports|Net social|Taxes on income$\",\n               na_item), time==\"2021-01-01\") %&gt;% \n  mutate(na_item = gsub(\"Taxes on produc.+\", \"Consum\", na_item) %&gt;% \n                   gsub(\"Net social contr.+\", \"Contribuţii\", .) %&gt;%\n                   gsub(\"Taxes on income\", \"Venit\", .)) %&gt;% \n  mutate(geo = tidytext::reorder_within(geo, within = na_item, values)) %&gt;%\n  ggplot(aes(x=geo, y=values)) + \n  geom_col(aes(fill=grepl(\"Romania\", geo)), show.legend = FALSE) + \n  tidytext::scale_x_reordered() +\n  coord_flip() + \n  scale_y_continuous(labels=scales::percent_format(scale=1)) +\n  scale_fill_tableau(direction = -1) +\n  facet_wrap(~na_item, ncol=3, scales='free') +\n  labs(x=NULL, y=NULL, title=\"Cele trei tipuri majore de taxare\", \n       subtitle=\"Anul 2021, % PIB\",\n       caption=\"Sursa: Eurostat, gov_10a_taxag\") + \n  theme(legend.position = \"top\")\n\n\n\n\n\nFigure 1: Tipuri principale de taxe\n\n\n\n\nCa procent din PIB suntem codaşi la toate aceste categorii, mai puţin contribuţii, lucru explicabil prin procentul mic de venituri fiscale colectate din PIB în ţara noastră, unde suntem de asemenea ultimii în afară de Irlanda. Nu mai ilustrez pentru că situaţia este ultra-cunoscută. Atenţie, ce vedem mai sunt sunt venituri din aceste taxe, nu taxarea efectivă pe care o resimte cetăţeanul. Cum e posibil să fim top la povară fiscală conform OECD (cum arătam într-un articol anterior) şi totuşi aşa de jos în clasamente la venituri ? O explicaţie ar fi baza scăzută de impozitare - avem foarte puţini salariaţi la mulţi pensionari, avem probleme de colectare la TVA, avem cotă unică de 10 % pe venituri, ceea ce ne face ultimii în Europa la procentul colectat din PIB la această categorie de venituri.\nDar cele trei tipuri sunt doar agregatele cele mai mari, Eurostat are date despre circa 93 de categorii de venituri, subcategorii ale categoriilor deja menţionate, dar nu vom intra în detalii de acest fel. În schimb, ne interesează desfăşurata în timp a acestor trei agregate principale.\n\n\nCode\ndf %&gt;% \n    filter(grepl(\"Taxes on production and imports|Net social|Taxes on income$\", na_item)) %&gt;% \n    mutate(na_item = gsub(\"Taxes on produc.+\", \"Consum\", na_item) %&gt;% \n               gsub(\"Net social contr.+\", \"Contribuţii\", .) %&gt;%\n               gsub(\"Taxes on income\", \"Venit\", .)) %&gt;% \n  filter(grepl(\"Romania|Bulgaria|Polonia|Ungaria\", geo)) %&gt;% \n  ggplot(aes(x=time, y=values, group=na_item)) + \n  geom_line(aes(colour=na_item), size=1) + \n  facet_wrap(~geo, ncol=2, scales='free') +\n  scale_y_continuous(labels=scales::percent_format(scale=1)) +\n  scale_color_tableau() +\n  labs(title=\"Principalele agregate fiscale în timp\", x=NULL, y=NULL,\n       caption=\"Sursa: Eurostat, gov_10a_taxag\", colour=\"Taxă\") +\n  theme(legend.position = \"top\")\n\n\n\n\n\nFigure 2: Principalele agregate desfăşurate în timp\n\n\n\n\nAcum vom face un lucru diferit şi vom studia veniturile din taxe după factorii de producţie implicaţi: capital, muncă, dar şi consum şi proprietate. Am ales aceste categorii pentru că ele sunt calculate special de Comisia Europeană şi Eurostat aici. Metodologia este şi ea tot în linkul respectiv. Vom vizualiza grafice în două axe şi doi ani distincţi: 2011 şi 2021. Pe orizontală avem procentul din total, pe verticală procentul din PIB. Săgeţile indică direcţia temporală, culoarea dacă vorbim de o creştere sau scădere.\n\n\nCode\nx &lt;- read_csv(here::here(\"data/post-10\", \"taxation_trends_eurostat.csv\")) %&gt;%\n     select(-contributii) %&gt;% mutate(time=as.character(time))\n\n\ngrafice &lt;- function(x, var, numar=10){\n  \n  segmente &lt;- x %&gt;% filter(time%in%c(\"2011\", \"2021\")) %&gt;% \n              select(geo, what, time, !!ensym(var)) %&gt;% \n              spread(what, !!ensym(var)) %&gt;% \n              pivot_wider(names_from = time, values_from = c(PIB, Total)) %&gt;%\n              filter(!grepl(\"Luxemb|Irlanda|Malta|Cipru\", geo)) %&gt;%\n              mutate(centru_x = 0.5*(Total_2011+Total_2021), \n                     centru_y=0.5*(PIB_2011+PIB_2021)) %&gt;%\n              mutate(delta = sqrt((PIB_2021-PIB_2011)^2 + (Total_2021-Total_2011)^2)) %&gt;%\n              mutate(directie = if_else(PIB_2021 &lt; PIB_2011 & Total_2021 &lt; Total_2011, \"Scădere\", \"Creştere\")) %&gt;%\n              arrange(desc(delta)) \n  \n  tari &lt;- segmente %&gt;% \n    arrange(desc(delta)) %&gt;%\n    mutate(index = if_else(row_number()&lt;numar | geo==\"Romania\", 1, 0)) %&gt;%\n    filter(index==1) %&gt;% select(-index) %&gt;% pull(geo)\n  \n  segmente %&gt;%\n    ggplot(aes(x=Total_2011, y=PIB_2011)) + \n    geom_point(colour='red3') + \n    geom_point(colour='red3', aes(x=Total_2021, y=PIB_2021)) +\n    geomtextpath::geom_textsegment(aes(x=Total_2011, xend=Total_2021, \n                                       y=PIB_2011, yend=PIB_2021, label=geo, size=delta,\n                                       colour=directie),\n                                   vjust=-0.3, arrow = arrow(length=unit(0.3, \"cm\")),\n                                   show.legend = FALSE) + \n    scale_x_continuous(labels=scales::percent_format(scale=1)) +\n    scale_y_continuous(labels=scales::percent_format(scale=1)) +\n    scale_size_continuous(range=c(2, 4)) +\n    scale_color_tableau() +\n    gghighlight::gghighlight(geo%in%tari) +\n    theme(legend.position = 'top')\n}\n\n\n\nCapitalMuncăConsumProprietate\n\n\n\n\nCode\ngrafice(x=x, var=capital, numar=10) +\n  labs(title = \"Taxarea capitalului\", \n       subtitle=\"2011 vs 2021\",\n       x=\"% din TOTAL\", y=\"% din PIB\",\n       caption=\"Sursa: Comisia Europeană\")\n\n\n\n\n\nFigure 3: Taxarea capitalului\n\n\n\n\n\n\n\n\nCode\n#| fig-width: 8\n#| fig-height: 6\n#| fig-dpi: 200\n#| label: fig-munca\n#| fig-cap: Taxarea muncii\n\ngrafice(x=x, var=munca, numar=10) +\n  labs(title = \"Taxarea muncii\", \n       subtitle=\"2011 vs 2021\", \n       x=\"% din TOTAL\", y=\"% din PIB\",\n       caption=\"Sursa: Comisia Europeană\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\ngrafice(x=x, var=consum, numar=10) +\n  labs(title = \"Taxarea consumului\", \n       subtitle = \"2011 vs 2021\",\n       x=\"% din TOTAL\", y=\"% din PIB\",\n       caption=\"Sursa: Comisia Europeană\")\n\n\n\n\n\nFigure 4: Taxarea consumului\n\n\n\n\n\n\n\n\nCode\n#| fig-width: 8\n#| fig-height: 6\n#| fig-dpi: 200\n#| label: fig-proprietate\n#| fig-cap: Taxarea proprietăţii\n\ngrafice(x=x, var=proprietate, numar=10) +\n  labs(title = \"Taxarea proprietăţilor\", \n       subtitle=\"2011 vs 2021\",\n       x=\"% din TOTAL\", y=\"% din PIB\",\n       caption=\"Sursa: Comisia Europeană\")\n\n\n\n\n\n\n\n\n\n\n\n\nObservăm că România a scăzut la venitul din capital, proprietate şi consum, dar a crescut la muncă. De asemnenea unele ţări au progresat enorm la taxarea capitalului, precum Danemarca şi Olanda."
  },
  {
    "objectID": "posts/2023-06-16-tiparele-poluarii-cu-co2-in-capitala/main.html",
    "href": "posts/2023-06-16-tiparele-poluarii-cu-co2-in-capitala/main.html",
    "title": "Tiparele poluării cu dioxid de carbon în capitală",
    "section": "",
    "text": "Code\nlibrary(tidyverse)\nlibrary(hrbrthemes)\nlibrary(ggthemes)\nlibrary(sf)\nlibrary(forecast)\nlibrary(tsibble)\nlibrary(imputeTS)\n\ntheme_set(hrbrthemes::theme_ipsum_tw(strip_text_size = 14, \n                                     strip_text_family = \"Roboto\",\n                                     strip_text_face = \"italic\",\n                                     axis_title_size = 14,\n                                     axis_text_size = 12,\n                                     base_family = \"Roboto\",\n                                     plot_title_family = \"Roboto\",\n                                     subtitle_family = \"Roboto\",\n                                     caption_family = \"Roboto\", \n                                     caption_size = 10,\n                                     plot_title_size = 16,\n                                     subtitle_size = 12) +\n  theme(legend.text = element_text(size=10), \n        legend.title = element_text(size=12),\n        legend.key.size = unit(0.5, \"cm\")))  #setam tema graficelor \n\n\nedit_station &lt;- function(x){\n  lat = x$geo[[1]][[1]]\n  lon = x$geo[[2]][[1]]\n  address = x$n[[1]]\n  id = x$idx[[1]]\n  u = x$utime[[1]]\n  name = x$name[[1]]\n  aqi = x$aqi[[1]]\n  \n  return(data.frame(\"id\"=id,\"name\"=name, \"lat\"=lat,\n                    \"lon\"=lon, \"aqi\"=aqi, \"time\"=u))\n}\n\nextrage_info &lt;- function(file){\n  \nstatii &lt;- jsonlite::read_json(here::here(file[2])) %&gt;% \n          map_dfr(., edit_station) %&gt;% \n          mutate(id=gsub(\"A\",\"\",id)) %&gt;% as_tibble() %&gt;% select(-aqi)\n  \ninfo &lt;- jsonlite::fromJSON(here::here(file[1]))\ninfo &lt;- tibble(ceva=info) %&gt;% bind_cols(statii) %&gt;% \n        select(-time) %&gt;% mutate(indicator=map(ceva, names)) %&gt;% \n        unnest(c(indicator, ceva)) %&gt;% mutate(index = map_dbl(ceva, length)) %&gt;% \n        filter(index!=0) %&gt;% unnest(ceva) %&gt;% select(-index) %&gt;% \n        unnest(count:time) %&gt;% relocate(name, indicator, lat, lon) %&gt;%\n        mutate(time = lubridate::parse_date_time(time, orders=\"ymdHMS\") + lubridate::dhours(3))\nreturn(info)\n}\n\n#fisiere &lt;- here::here(\"data/post-11/airquality\", \"data\", \n #                     list.files(here::here(\"data/post-11/airquality\", \n #                                           \"data\"), pattern = \".json\"))\n\n#fisiere &lt;- matrix(data=fisiere, ncol=2, byrow=FALSE)\n#statii &lt;- map_dfr(1:nrow(fisiere), ~extrage_info(file = fisiere[.x, ])) %&gt;%\n #         distinct()\n\n#statii &lt;- statii %&gt;% \n #         group_by(name, indicator, time, lat, lon, id) %&gt;% \n  #        mutate(across(count:stddev, mean)) %&gt;% ungroup() %&gt;% \n   #       distinct()\nstatii &lt;- read_csv(here::here(\"data/post-11\", \"statii.csv\"))"
  },
  {
    "objectID": "posts/2023-06-16-tiparele-poluarii-cu-co2-in-capitala/main.html#analize-exploratorii",
    "href": "posts/2023-06-16-tiparele-poluarii-cu-co2-in-capitala/main.html#analize-exploratorii",
    "title": "Tiparele poluării cu dioxid de carbon în capitală",
    "section": "1 Analize exploratorii",
    "text": "1 Analize exploratorii\nÎn acest articol vom investiga tiparele temporale ale poluării cu \\(CO_2\\) în Bucureşti. Folosim date de la aqicn.org pe care le accesăm prin interfaţa lor programatică. Datele au fost descărcate în fiecare zi de pe toată aria Bucureştiului şi salvate într-un repositoriu de pe Github folosind mecanismul lor automat numit Github Actions. Avem aşadar doar 14 staţii în tot Bucureştiul care măsoară concentraţia de \\(CO_2\\) la fiecare oră pe perioada studiului nostru de circa două luni jumătate (29 martie 2023 - 16 iunie 2023). Dar nu am descărcat numai datele referitoare la acest poluant ci şi alţii, precum şi temperatura la nivel de staţie, umiditatea, compuşi volatili organici (VOC), etc. Să vedem o matrice a corelaţiilor cu toţi aceşti indicatori pe această perioadă.\n\n\nCode\nstatii %&gt;% group_by(time, indicator) %&gt;% \n  summarise(medie=mean(mean))%&gt;% spread(indicator, medie) %&gt;% \n  drop_na() %&gt;% ungroup() %&gt;% select(-1) %&gt;% cor() %&gt;% \n  corrplot::corrplot(method='square', order=\"hclust\")\n\n\n\n\n\nfig-corelatii\n\n\n\n\nVedem corelaţii foarte puternice, pozitive, între \\(CO_2\\) şi umiditate (met.h), \\(O_3\\) şi negative între \\(CO_2\\) şi temperatură (met.t). Particulele (pm-urile) se corelează aproape perfect între ele. Să vedem câteva trenduri agregate la nivel de Bucureşti.\n\n\nCode\nstatii %&gt;% filter(indicator%in%c(\"co2\", \"o3\", \"voc\", \"pm25\")) %&gt;% \n  group_by(time, indicator) %&gt;% \n  summarise(medie = mean(mean, na.rm=TRUE, trim=0.1)) %&gt;% \n  ungroup() %&gt;% ggplot(aes(x=time, y=medie)) + \n  geom_line(aes(colour=indicator), size=1) + \n  facet_wrap(~indicator, ncol=1, scales='free') + \n  scale_color_tableau() + \n  labs(title = \"Trenduri medii pentru poluanţii principali\", \n       x=NULL, y=NULL)\n\n\n\n\n\nfig-trenduri\n\n\n\n\nObservăm nivele destul de mari de \\(CO_2\\) , valorile ajungând chiar şi la 600 ppm. Valoarea medie pe glob în 2022 este de 417 ppm şi a reprezentat un nou record. În Bucureşti media pe această perioadă este de 482 ppm. Aşadar, există amplitudini mari care par să aibă sezonalitate zilnică. Noaptea nivelul este mai ridicat, ziua mai scăzut. Să vizualizăm în aceeaşi scală valorile la \\(CO_2\\), temperatură şi umiditate. Vom standardiza datele ca să le putem vizualiza trendurile suprapuse în aceeaşi unitate de măsură (deviaţii standard). Vom vizualiza doar luna aprilie ca să ne facem o idee din grafic de corelaţiile seriilor de timp distincte.\n\n\nCode\nstatii %&gt;% filter(indicator%in%c(\"co2\", \"met.h\", \"met.t\")) %&gt;% \n  group_by(time, indicator) %&gt;% \n  summarise(medie = mean(mean, na.rm=TRUE, trim=0.1)) %&gt;% \n  ungroup() %&gt;% spread(indicator, medie) %&gt;% drop_na() %&gt;% \n  mutate(across(co2:met.t, ~scale(.)[,1])) %&gt;% \n  gather(co2:met.t, key='indicator', value='medie') %&gt;% \n  filter(as.Date(time)&lt;\"2023-05-01\") %&gt;% \n  ggplot(aes(x=time, y=medie)) + \n  geom_line(aes(colour=indicator), size=0.8) + \n  scale_color_tableau() + \n  labs(title = \"Trenduri suprapuse pentru dioxidul de carbon şi condiţiile atmosferice\", \n       subtitle=\"Date standardizate\", x=NULL, y=NULL) \n\n\n\n\n\nfig-suprapuse\n\n\n\n\nObservăm cum temperatura e invers corelată cu \\(CO_2\\). Mai interesant, observăm cum episoadele de umiditate crescută şi constantă se asociază cu aceleaşi perioade în trendul de \\(CO_2\\). Acestea sunt ploile. Ploile rup întrerup practic sezonalitatea dioxidului de carbon, menţinându-l ridicat."
  },
  {
    "objectID": "posts/2023-06-16-tiparele-poluarii-cu-co2-in-capitala/main.html#analiza-statistică",
    "href": "posts/2023-06-16-tiparele-poluarii-cu-co2-in-capitala/main.html#analiza-statistică",
    "title": "Tiparele poluării cu dioxid de carbon în capitală",
    "section": "2 Analiza statistică",
    "text": "2 Analiza statistică\nAcum vom încerca să prezicem nivelul orar de \\(CO_2\\) cu două modele bazate pe serii de timp: este vorba de ARIMA. Unul cu şi altul fără condiţiile atmosferice incluse. Ambele vor avea doi termeni periodici: un sinus şi un cosinus cu frecvenţa de 24 de ore - ca să surprindem sezonalitatea zilnică a valorilor. Practic modelele noastre sunt mai mult SARIMA şi SARIMAX (ARIMA cu sezonalitate şi regresori exogeni - adică condiţiile atmosferice, temperatura şi umiditatea). Vom vedea câtă precizie obţinem cu şi fără condiţiile atmosferice încercând să prezicem ultimele două săptămâni de date, oră cu oră. E cam mare perioada, dar datele au suficientă regularitate şi s-ar putea să iasă o precizie ridicată. În Figure 1 avem predicţiile fără condiţii atmosferice.\n\n\nCode\nco2 &lt;- statii %&gt;% filter(grepl(\"co2|met.h|met.t|met.p|pm25|o3|voc\", \n                               indicator)) %&gt;% \n       group_by(indicator, time) %&gt;% \n       summarise(medie = mean(mean, na.rm=TRUE,trim=0.1)) %&gt;% \n       spread(indicator, medie) %&gt;% drop_na() %&gt;% \n       as_tsibble() %&gt;% group_by_key(hour=lubridate::hour(time)) %&gt;%\n       fill_gaps() %&gt;% \n       mutate(ora=lubridate::hour(time) %&gt;% as.factor(),\n              zi = lubridate::wday(time)%in%c(1, 7)) \n\n\nco2$co2 &lt;- na_kalman(co2$co2)\nco2$met.h &lt;- na_kalman(co2$met.h)\nco2$met.p &lt;- na_kalman(co2$met.p)\nco2$met.t &lt;- na_kalman(co2$met.t)\nco2$o3 &lt;- na_kalman(co2$o3)\nco2$pm25 &lt;- na_kalman(co2$pm25)\nco2$voc &lt;- na_kalman(co2$voc)\n\n\nmake_fourier &lt;- function(k, df){\nx &lt;- matrix(data=numeric(length(k)*2*nrow(df)), \n            ncol=nrow(df), nrow=2*length(k))\n\n  for(i in 1:length(k)){\n      x[(2*i-1):(2*i), ] &lt;- rbind(sin(2*pi*(1:nrow(df))/k[i]), \n                                  cos(2*pi*(1:nrow(df))/k[i]))\n  }\nx\n}\n\ny &lt;- co2 %&gt;% select(-time) %&gt;% \n  select(co2, met.h, met.t, voc, ora) %&gt;% \n  mutate_all(~as.numeric(.)) %&gt;% as.matrix()\n\nindex &lt;- 1:1500\ntrain &lt;- y[index,]\ntest &lt;- y[-index,]\n\nd &lt;- t(matrix(train[,2:3], ncol=2))\nd &lt;- rbind(d, make_fourier(k=c(24), df=train))\nrownames(d) &lt;- c(\"met.h\", \"met.t\", \"sin24\", \"cos24\")\n\nd_new &lt;- t(matrix(test[,2:3], ncol=2))\nd_new &lt;- rbind(d_new, make_fourier(k=c(24), df=test))\nrownames(d_new) &lt;- rownames(d)\n\narima_model &lt;- forecast::auto.arima(y=train[,1],xreg=t(d)) \narima_model_0 &lt;- forecast::auto.arima(y=train[,1], xreg=t(d[-c(1:2), ]))\n\nforecast::forecast(arima_model_0, xreg=t(d_new[-c(1:2),])) %&gt;% \n  autoplot() +\n  geom_line(data=enframe(test[,1]) %&gt;% \n            mutate(name=name+1500), aes(x=name, y=value)) +\n  labs(title=\"Predicţii dintr-un model SARIMA (2,1,1)\", x=NULL, y=NULL)\n\n\n\n\n\nFigure 1: Predicţii fără condiţii atmosferice\n\n\n\n\nÎn Figure 2 avem predicţiile cu condiţiile atmosferice incluse. Evident, şi modelul are alţi coeficienţi pentru acei parametri comuni. Dacă primul model abia se descurcă, al doilea chiar prezice cu exactitate valorile orare ale nivelului de \\(CO_2\\) cu două săptămâni în viitor !\n\n\nCode\nforecast::forecast(arima_model, xreg=t(d_new)) %&gt;% \n  autoplot() + \n  geom_line(data=enframe(test[,1]) %&gt;% mutate(name=name+1500), \n            aes(x=name, y=value)) +\n  labs(title=\"Predicţii dintr-un model SARIMAX (2,1,1)\", \n       subtitle=\"Cu condiţiile atmosferice incluse\", x=NULL, y=NULL)\n\n\n\n\n\nFigure 2: Predicţii cu condiţii atmosferice\n\n\n\n\nAvem o reducere în erorile de predicţie de circa 48.46 %. Dar acest factor nu reprezintă şi procentul de variabilitate explicată de condiţiile atmosferice, pentru că în primul model sezonalitatea are o influenţă mai mare, influenţă care ajustează cumva în mod ascuns şi pentru condiţiile atmosferice (şi ele sezoniere). În al doilea model efectul sinusoidelor este redus pentru că condiţiile atmosferice apar explicit şi reduc din efectul lor. Deci factorul acesta este unul care se referă la măsuri predictive, nu cauzale. Corelaţia între cele 300 şi ceva de puncte prezise de model şi realitate este de circa 0.92. Foarte mare. Oricum, putem concluziona că o parte semnificativă a variaţiilor zilnice ale nivelului de \\(CO_2\\) din Bucureşti este cauzat de condiţiile atmosferice mai degrabă decât de trafic. Traficul sigur că explică media în general ridicată din acest oraş, dar nu neapărat oscilaţiile în jurul acestei medii."
  },
  {
    "objectID": "posts/2023-06-17-tiparele-geografice-ale-mortalitatii-infantile/tiparele-mortalitatii-infantile.html",
    "href": "posts/2023-06-17-tiparele-geografice-ale-mortalitatii-infantile/tiparele-mortalitatii-infantile.html",
    "title": "Tiparele geografice ale mortalităţii infantile",
    "section": "",
    "text": "În acest articol vom analiza rata mortalităţii infantile conform Eurostat, la nivel NUTS 2 (regiuni de dezvoltare). Vom folosi fişierul de la ei numit demo_r_minfind care conţine date până în anul 2021 inclusiv. Vom face media la nivelul anilor 2017-2021 pentru a vizualiza mortalitatea infantilă la nivelul continentului.\n\n\nCode\nlibrary(tidyverse)\nlibrary(hrbrthemes)\nlibrary(ggthemes)\nlibrary(gt)\nlibrary(gtExtras)\nlibrary(lme4)\nlibrary(sf)\nlibrary(eurostat)\ntheme_set(hrbrthemes::theme_ipsum_tw(strip_text_size = 14, \n                                     strip_text_family = \"Roboto\",\n                                     strip_text_face = \"italic\",\n                                     axis_title_size = 14,\n                                     axis_text_size = 12,\n                                     base_family = \"Roboto\",\n                                     plot_title_family = \"Roboto\",\n                                     subtitle_family = \"Roboto\",\n                                     caption_family = \"Roboto\", \n                                     caption_size = 10,\n                                     plot_title_size = 16,\n                                     subtitle_size = 12) +\n  theme(legend.text = element_text(size=10), \n        legend.title = element_text(size=12),\n        legend.key.size = unit(0.6, \"cm\")))  #setam tema graficelor \n\ndf &lt;- get_eurostat(id=\"demo_r_minfind\") %&gt;% \n      label_eurostat(fix_duplicated = TRUE, code = \"geo\")\nharta &lt;- eurostat::eurostat_geodata_60_2016 %&gt;% as_tibble() %&gt;% \n         rename(geo_code=geo)\n\ndf %&gt;% filter(time &gt; \"2016-01-01\") %&gt;% \n  group_by(geo_code, geo) %&gt;% \n  summarise(values=mean(values, na.rm=TRUE)) %&gt;% \n  ungroup() %&gt;% inner_join(harta) %&gt;% \n  group_by(CNTR_CODE) %&gt;% slice_max(order_by = LEVL_CODE, n = 1) %&gt;% \n  ungroup() %&gt;% mutate(values=cut_number(values, n=10)) %&gt;% \n  st_as_sf() %&gt;% ggplot() + \n  geom_sf(aes(fill=values), colour=NA) + \n  scale_fill_tableau(palette = \"Classic Orange-Blue\", \n                     type=\"ordered-diverging\", direction = -1) + \n  geom_sf(data=harta %&gt;% filter(LEVL_CODE==0) %&gt;% st_as_sf() %&gt;% \n            st_cast(., \"MULTILINESTRING\"), colour='black') +\n  scale_x_continuous(limits = c(-10, 30)) + \n  scale_y_continuous(limits=c(34, 70)) +\n  labs(caption=\"Sursa: Eurostat, demo_r_minfind\", fill=\"NUTS 2\")\n\n\n\n\n\nFigure 1: Rata mortalităţii infantile la nivel NUTS 2\n\n\n\n\nVedem că marea majoritate a României se încadrează în intervalul 7.03-14 %, adică decila a 9-a (penultima). Suntem aşadar până în top 20 % la mortalitatea infantilă ca ţară, având şi o zonă în top 10 %. Este interesant şi greu de explicat tiparul din Germania. Să vedem trendurile în decursul anilor.\n\n\nCode\ndf %&gt;% filter(grepl(\"^[A-Z]{2}$\", geo_code)) %&gt;% \n  ggplot(aes(x=time, y=values, group=geo)) + \n  geom_line(aes(colour=geo)) + \n  gghighlight::gghighlight(grepl(\"Romania|Bulgaria|Poland|Czechia|Finland\",\n                                 geo), use_direct_label = F) +\n  scale_colour_tableau() + \n  labs(title=\"Trendurile mortalităţii infantile\", \n       caption = \"Sursa: Eurostat, demo_r_minfind\", x=NULL, \n       y=NULL, colour=\"Ţară\") +\n  scale_y_continuous(labels = function(x) paste(x, \"‰\"))\n\n\n\n\n\nFigure 2: Trendurile mortalităţii infantile"
  },
  {
    "objectID": "posts/2023-06-17-tiparele-geografice-ale-mortalitatii-infantile/tiparele-mortalitatii-infantile.html#analiza-exploratorie",
    "href": "posts/2023-06-17-tiparele-geografice-ale-mortalitatii-infantile/tiparele-mortalitatii-infantile.html#analiza-exploratorie",
    "title": "Tiparele geografice ale mortalităţii infantile",
    "section": "",
    "text": "În acest articol vom analiza rata mortalităţii infantile conform Eurostat, la nivel NUTS 2 (regiuni de dezvoltare). Vom folosi fişierul de la ei numit demo_r_minfind care conţine date până în anul 2021 inclusiv. Vom face media la nivelul anilor 2017-2021 pentru a vizualiza mortalitatea infantilă la nivelul continentului.\n\n\nCode\nlibrary(tidyverse)\nlibrary(hrbrthemes)\nlibrary(ggthemes)\nlibrary(gt)\nlibrary(gtExtras)\nlibrary(lme4)\nlibrary(sf)\nlibrary(eurostat)\ntheme_set(hrbrthemes::theme_ipsum_tw(strip_text_size = 14, \n                                     strip_text_family = \"Roboto\",\n                                     strip_text_face = \"italic\",\n                                     axis_title_size = 14,\n                                     axis_text_size = 12,\n                                     base_family = \"Roboto\",\n                                     plot_title_family = \"Roboto\",\n                                     subtitle_family = \"Roboto\",\n                                     caption_family = \"Roboto\", \n                                     caption_size = 10,\n                                     plot_title_size = 16,\n                                     subtitle_size = 12) +\n  theme(legend.text = element_text(size=10), \n        legend.title = element_text(size=12),\n        legend.key.size = unit(0.6, \"cm\")))  #setam tema graficelor \n\ndf &lt;- get_eurostat(id=\"demo_r_minfind\") %&gt;% \n      label_eurostat(fix_duplicated = TRUE, code = \"geo\")\nharta &lt;- eurostat::eurostat_geodata_60_2016 %&gt;% as_tibble() %&gt;% \n         rename(geo_code=geo)\n\ndf %&gt;% filter(time &gt; \"2016-01-01\") %&gt;% \n  group_by(geo_code, geo) %&gt;% \n  summarise(values=mean(values, na.rm=TRUE)) %&gt;% \n  ungroup() %&gt;% inner_join(harta) %&gt;% \n  group_by(CNTR_CODE) %&gt;% slice_max(order_by = LEVL_CODE, n = 1) %&gt;% \n  ungroup() %&gt;% mutate(values=cut_number(values, n=10)) %&gt;% \n  st_as_sf() %&gt;% ggplot() + \n  geom_sf(aes(fill=values), colour=NA) + \n  scale_fill_tableau(palette = \"Classic Orange-Blue\", \n                     type=\"ordered-diverging\", direction = -1) + \n  geom_sf(data=harta %&gt;% filter(LEVL_CODE==0) %&gt;% st_as_sf() %&gt;% \n            st_cast(., \"MULTILINESTRING\"), colour='black') +\n  scale_x_continuous(limits = c(-10, 30)) + \n  scale_y_continuous(limits=c(34, 70)) +\n  labs(caption=\"Sursa: Eurostat, demo_r_minfind\", fill=\"NUTS 2\")\n\n\n\n\n\nFigure 1: Rata mortalităţii infantile la nivel NUTS 2\n\n\n\n\nVedem că marea majoritate a României se încadrează în intervalul 7.03-14 %, adică decila a 9-a (penultima). Suntem aşadar până în top 20 % la mortalitatea infantilă ca ţară, având şi o zonă în top 10 %. Este interesant şi greu de explicat tiparul din Germania. Să vedem trendurile în decursul anilor.\n\n\nCode\ndf %&gt;% filter(grepl(\"^[A-Z]{2}$\", geo_code)) %&gt;% \n  ggplot(aes(x=time, y=values, group=geo)) + \n  geom_line(aes(colour=geo)) + \n  gghighlight::gghighlight(grepl(\"Romania|Bulgaria|Poland|Czechia|Finland\",\n                                 geo), use_direct_label = F) +\n  scale_colour_tableau() + \n  labs(title=\"Trendurile mortalităţii infantile\", \n       caption = \"Sursa: Eurostat, demo_r_minfind\", x=NULL, \n       y=NULL, colour=\"Ţară\") +\n  scale_y_continuous(labels = function(x) paste(x, \"‰\"))\n\n\n\n\n\nFigure 2: Trendurile mortalităţii infantile"
  },
  {
    "objectID": "posts/2023-06-17-tiparele-geografice-ale-mortalitatii-infantile/tiparele-mortalitatii-infantile.html#analiză-statistică",
    "href": "posts/2023-06-17-tiparele-geografice-ale-mortalitatii-infantile/tiparele-mortalitatii-infantile.html#analiză-statistică",
    "title": "Tiparele geografice ale mortalităţii infantile",
    "section": "2 Analiză statistică",
    "text": "2 Analiză statistică\nToate ţările au făcut progrese uimitoare în aceşti 30 de ani, iar noi am prins din urmă Bulgaria. Dar încă avem rate duble faţă de media UE. Mai observăm că trendurile sunt exponenţial-descrescătoare. Aplicând un model liniar mixt descoperim un fenomen de convergenţă. Acest model aplică fiecărei ţări câte o pantă şi un intercept diferite, având grijă să fie într-o oarecare măsură centrate în jurul mediilor globale. Corelaţia dintre pante şi intercepturi este, conform modelului, -0.69. Acest lucru înseamnă că ţările cu intercepturi mari au pante şi mai abrupt-negative (mici), ceea ce ne duce cu gândul la fenomenul de convergenţă: cele care pornesc de sus le vor ajunge din urmă pe celelalte.\n\n\nCode\nmodel &lt;- df %&gt;% filter(grepl(\"^[A-Z]{2}$\", geo_code)) %&gt;% \n  drop_na() %&gt;% select(-unit, -geo_code) %&gt;% \n  filter(!grepl(\"Lie\", geo)) %&gt;% \n  mutate(time=lubridate::year(time)-1990) %&gt;% \n  lme4::lmer(log10(values) ~ time + (1+time|geo), data=.) \n\ndf %&gt;% filter(grepl(\"^[A-Z]{2}$\", geo_code)) %&gt;% \n    drop_na() %&gt;% select(-unit, -geo_code) %&gt;% \n    filter(!grepl(\"Lie\", geo)) %&gt;% \n    mutate(time=lubridate::year(time)-1990) %&gt;% \n    mutate(fit = 10^(predict(model))) %&gt;% \n    ggplot(aes(x=time, y=fit, group=geo)) + \n    geom_line(aes(colour=geo), size=0.8) + \n    geom_point(aes(x=time, y=values, colour=geo)) +\n    gghighlight::gghighlight(grepl(\"Romania|Bulgaria|Czechia|Poland\", geo),\n                             use_direct_label = F) + \n    scale_color_tableau() + labs(colour=\"Ţară\",x=NULL, y=NULL,\n                                 title=\"Traiectorii prezise de model\",\n                                 caption=\"Sursa: calcule proprii\") +\n    scale_y_continuous(labels = function(x) paste(x, \"‰\"))\n\n\n\n\n\nFigure 3: Trendurile prezise ale mortalităţii infantile\n\n\n\n\nRomânia pleacă de la mortalitate de 3 % şi ajunge la aproximativ 0.52 %. De şase ori reducere în 30 de ani, echivalent cu o înjumătăţire în 12 ani sau reducere cu 5.3 % per an. Mai jos coeficienţii de reducere per an a mortalitătii infantile pentru fiecare ţară împreună cu timpii de înjumătăţire:\n\n\nCode\nmodel %&gt;% ranef() %&gt;% as_tibble(rownames=\"geo\") %&gt;% \n  select(grp, term,condval) %&gt;% spread(term, condval) %&gt;% \n  janitor::clean_names() %&gt;% \n  mutate(intercept_0 = 10^fixef(model)[1], \n         intercept=10^intercept, time_0 = fixef(model)[2], \n         time_t=time+time_0) %&gt;% \n  mutate(intercept_t = (intercept)*intercept_0) %&gt;% \n  select(grp, time_t) %&gt;% mutate(reducere = 100-100*10^time_t) %&gt;% \n  mutate(timp = log10(0.5)/time_t) %&gt;% select(-time_t) %&gt;% \n  rename(geo=grp) %&gt;% \n  inner_join(read_csv(here::here(\"data\", \"dictionar_tari.csv\"))) %&gt;% \n  select(-geo) %&gt;% rename(geo=tari) %&gt;% relocate(geo) %&gt;% \n  arrange((timp)) %&gt;% gt::gt() %&gt;% gt_theme_538() %&gt;% \n  gtExtras::gt_highlight_rows(rows=grepl(\"Romania\", geo)) %&gt;% \n  opt_table_font(font=\"Roboto\") %&gt;%\n  tab_style(style=cell_fill(color=\"#EEA100\"), \n            locations = cells_column_labels()) %&gt;% \n  fmt_percent(columns=2, scale_values = FALSE) %&gt;% \n  fmt_number(columns=3, decimals = 1) %&gt;% \n  gt::cols_label(timp ~ (\"Înjumătăţire\"), geo ~ \"Ţară\") %&gt;% \n  tab_footnote(footnote = \"Numărul de ani în care s-a înjumătăţit mortalitatea\", locations=cells_column_labels(columns=3)) %&gt;% \n  tab_header(title=\"Performanţele ţărilor europene în reducerea mortalităţii infantile\", subtitle=\"Sursa: calcule proprii\") %&gt;% \n  tab_style(cell_text(weight = \"bold\"), \n            cells_title(groups='title')) %&gt;% \n  opt_row_striping() %&gt;%\n  cols_width(everything() ~ '150px')\n\n\n\n\n\n\n  \n    \n    \n    \n  \n  \n    \n      Performanţele ţărilor europene în reducerea mortalităţii infantile\n    \n    \n      Sursa: calcule proprii\n    \n    \n      Ţară\n      reducere\n      Înjumătăţire1\n    \n  \n  \n    Estonia\n7.50%\n8.9\n    Letonia\n6.24%\n10.8\n    Cipru\n5.37%\n12.6\n    Polonia\n5.31%\n12.7\n    Romania\n5.26%\n12.8\n    Lituania\n5.24%\n12.9\n    Slovenia\n5.04%\n13.4\n    Ungaria\n4.86%\n13.9\n    Cehia\n4.76%\n14.2\n    Portugalia\n4.49%\n15.1\n    Bulgaria\n3.96%\n17.2\n    Italia\n3.88%\n17.5\n    Islanda\n3.80%\n17.9\n    Finlanda\n3.61%\n18.8\n    Norvegia\n3.58%\n19.0\n    Spania\n3.46%\n19.7\n    Grecia\n3.45%\n19.7\n    Croatia\n3.30%\n20.7\n    Irlanda\n3.28%\n20.8\n    Slovacia\n3.22%\n21.2\n    Suedia\n3.13%\n21.8\n    Austria\n3.10%\n22.0\n    Germania\n2.60%\n26.3\n    Belgia\n2.51%\n27.3\n    Danemarca\n2.30%\n29.7\n    Olanda\n2.29%\n29.9\n    Franta\n2.00%\n34.3\n    Elvetia\n1.97%\n34.8\n  \n  \n  \n    \n      1 Numărul de ani în care s-a înjumătăţit mortalitatea\n    \n  \n\n\n\n\nVedem că sunt şi alte ţări care au reuşit o reducere şi mai drastică, chiar dacă nu au pornit aşa de rău ca România."
  },
  {
    "objectID": "posts/2023-06-27-factorii-determinanti-ai-importurilor-romanesti/importurile-romanesti.html",
    "href": "posts/2023-06-27-factorii-determinanti-ai-importurilor-romanesti/importurile-romanesti.html",
    "title": "Factorii determinaţi ai importurilor româneşti",
    "section": "",
    "text": "În acest articol folosi tabele de tip input-output pentru a determina cauza importurilor româneşti. Aceste tabele sunt puse la dispoziţie de institutele naţionale de statistică ale statelor, dar există şi tabele care înregistrează tranzacţiile între sectoare din diferite ţări, mult mai detaliate şi interesante decât cele naţionale. Aşa sunt cele puse la dispoziţia publicului de către OECD sau WIOD. Pe coloane sunt trecute industriile care cumpără, pe linii sunt industriile de la care se cumpără (care vând). Transformăm aceste tabele de tranzacţii monetare în coeficienţi, matrici şi aflăm lucruri neaşteptate despre economie. Voi avea un post sau mai multe dedicate doar teoriei modelelor input-output, dar pentru moment voi expune câteva din fundamente aici. Din păcate sunt greu de înţeles fără un background elementar în algebră liniară."
  },
  {
    "objectID": "posts/2023-06-27-factorii-determinanti-ai-importurilor-romanesti/importurile-romanesti.html#puţină-teorie",
    "href": "posts/2023-06-27-factorii-determinanti-ai-importurilor-romanesti/importurile-romanesti.html#puţină-teorie",
    "title": "Factorii determinaţi ai importurilor româneşti",
    "section": "1 Puţină teorie",
    "text": "1 Puţină teorie\nVom calcula matricea producţiei sau tehnologiei, \\(\\textbf{A}\\), folosind următoarea formulă matriceală:\n\\[\n\\textbf{A} = \\textbf{Z}\\textbf{x}^{-1}\n\\]\nUnde \\(\\textbf{Z}\\) este matricea tranzacţiilor de care am vorbit mai sus, iar \\(\\textbf{x}\\) este matricea diagonală care are în intrările sale (diagonale, evident) inversul producţiei totale pe fiecare sector. Practic împărţim coloanele producţia totală ca să avem nişte coeficienţi (subunitari). Aceasta este matricea de bază inter-industrii, de producţie sau tehnologică (există diferite denumiri).\nAcum vom calcula ceva derivat din această matrice, anume matricea inversă Leontief, \\((\\textbf{I}-\\textbf{A})^{-1}\\) care este fundamentală în aceste analize. Premultiplicând această matrice cu \\(\\textbf{f}\\) , o altă matrice sau vector, după caz, cu cererea finală, obţinem cât trebuie să producă fiecare sector în totalitate ca să satisfacă această cerere finală dar şi consumul intermediar al industriilor. Matricea inversă Leontief poate fi scrisă ca serie infinită de matrici, aratând astfel că există mai multe runde (infinite teoretic) de producţie. Practic orice cantitate de cerere finală pune în funcţiune mai multe runde de producţie succesive.\n\\[\n(\\textbf{I}-\\textbf{A})^{-1} = \\textbf{I} + \\textbf{A} + \\textbf{A}^2 + …\n\\]\nPutem calcula conţinutul de importuri din exporturi, de exemplu (un simplu exemplu de cerere finală) cu următoarea formulă.\n\\[\nr = \\frac{\\textbf{s}^T\\textbf{M}(\\textbf{I}-\\textbf{A})^{-1}\\textbf{e}}{\\textbf{s}^T\\textbf{e}}\n\\]\nUnde \\(\\textbf{s}^T\\) este vectorul sumă, \\(\\textbf{M}\\) matricea coeficienţilor de import \\(\\textbf{e}\\) matricea de exporturi sau vectorul exporturi dacă le adunăm la nivel de ţară. Putem să nu folosim vectorul sumă şi să avem importuri dezagregate pe surse de cerere finală sau exporturi. De exemplu putem răspunde unor întrebări de genul: cu cât cresc importurile de petrol din Rusia în România pentru a satisface un dolar de producţie auto exportată în Germania. La acest nivel se poate merge, dar va fi foarte greu să-ţi prezinţi rezultatele neavând decât matrici de valori. Mai sunt posibile şi multe alte calcule în acest cadru teoretic dar în acest articol vom analiza importurile după cauzele lor corespunzătoare din cererea finală ca să vedem cât e fiecare categorie responsabilă de aceste importuri."
  },
  {
    "objectID": "posts/2023-06-27-factorii-determinanti-ai-importurilor-romanesti/importurile-romanesti.html#analize-exploratorii",
    "href": "posts/2023-06-27-factorii-determinanti-ai-importurilor-romanesti/importurile-romanesti.html#analize-exploratorii",
    "title": "Factorii determinaţi ai importurilor româneşti",
    "section": "2 Analize exploratorii",
    "text": "2 Analize exploratorii\n\n\nCode\nlibrary(tidyverse)\nlibrary(ggthemes)\nlibrary(gt)\nlibrary(gtExtras)\ntheme_set(hrbrthemes::theme_ipsum_tw(strip_text_size = 14, \n                                     strip_text_family = \"Roboto\",\n                                     strip_text_face = \"italic\",\n                                     axis_title_size = 14,\n                                     axis_text_size = 12,\n                                     base_family = \"Roboto\",\n                                     plot_title_family = \"Roboto\",\n                                     subtitle_family = \"Roboto\",\n                                     caption_family = \"Roboto\", \n                                     caption_size = 10,\n                                     plot_title_size = 16,\n                                     subtitle_size = 12) +\n  theme(legend.text = element_text(size=10), \n        legend.title = element_text(size=12),\n        legend.key.size = unit(0.6, \"cm\")))  #setam tema graficelor \n\nimporturi &lt;- read_csv(here::here(\"data\", \"post-12\", \"eastern.csv\")) %&gt;%\n             mutate(country=countrycode::countrycode(country, \n                                                     origin='iso3c', \n                                                     destination='country.name'))\n\n\nVom folosi tabelele de la OECD care acoperă perioada 1995-2018 şi vom descompune variaţiile anuale în importuri după cauzele care le generează. Am calculat matrici cu aceste importuri de dimensiuni 45 x 4 (45 de sectoare de import şi 4 categorii de cerere finală - Consum privat, Stat, Investiţii, Exporturi) pentru fiecare din cele 66 de ţări şi 24 de ani. Dar ne vom axa pe România în principal şi pe ţările est-europene. Să descompunem importurile pentru România.\n\n\nCode\nimporturi %&gt;% filter(country==\"Romania\") %&gt;% \n  group_by(year, component) %&gt;%\n  summarise(valoare=sum(valoare)) %&gt;% ungroup() %&gt;%\n  ggplot(aes(x=year, y=valoare, fill=component)) + \n  geom_col() + scale_fill_tableau() +\n  labs(title=\"Importurile după sursa de cerere finală\", subtitle=\"România\", \n       caption=\"Sursa: calcule pe OECD ICIO, 2021\") +\n  scale_y_continuous(labels=scales::number_format(big.mark = \",\"))\n\n\n\n\n\n\n\n\n\nObservăm că majoritatea importurilor sunt determinate de consumul gospodăriilor private, o parte de investiţii şi o parte de exporturi. Statul, prea puţin. Trebuie să facem o menţiune aici şi să spunem că acestea nu sunt importuri cerute în mod direct de fiecare din categoriile respective, ci aceste categorii, prin consumul lor - ele pot cumpăra pur domestic, determină producţie pe lanţuri de valoare care vor necesita şi importuri. Acest lucru calculăm aici. Toate, cu excepţia exporturile, au şi consum din import în mod direct, fără să mai treacă prin lanţurile autohtone ca materie de procesat, iar în cazul gospodăriilor procentul este cam jumătate - jumătate din importurile totale generate sunt directe. Restul indirecte - adică trec prin lanţuri de procesare autohtone înainte de a fi vândute. Să vedem acum, sub formă de tabel, importurile pe sectoare după cererea finală. Am ales top 10 sectoare cu cele mai mari variaţii de la o perioadă la alta (cu Marea Criză ca punct de reper).\n\n\nCode\nimporturi %&gt;% filter(country==\"Romania\") %&gt;% \n  filter(year!=2008) %&gt;% group_by(year) %&gt;% \n  mutate(total=sum(valoare)) %&gt;% ungroup() %&gt;%\n  group_by(sectoare, component,\n           year=if_else(year&lt;2008, '1995-2007', '2009-2018')) %&gt;% \n  summarise(valoare=100*mean(valoare)/mean(total)) %&gt;% ungroup() %&gt;% \n  spread(year, valoare) %&gt;% \n  mutate(delta=`2009-2018`-`1995-2007`) %&gt;% \n  group_by(component) %&gt;% slice_max(abs(delta), n=10) %&gt;% \n  arrange(desc(delta)) %&gt;%\n  gt::gt() %&gt;% gt_theme_538() %&gt;% \n    opt_table_font(font=\"Roboto\") %&gt;%\n    tab_style(style=cell_fill(color=\"#EEA100\"), \n              locations = cells_column_labels()) %&gt;% \n    fmt_percent(columns=3:5, scale_values = FALSE) %&gt;% \n    tab_header(title=\"Procent importuri din total generate\", \n               subtitle=\"După categorii de cerere finală\") %&gt;% \n    tab_style(cell_text(weight = \"bold\"), \n              cells_title(groups='title')) %&gt;% \n    gt::opt_row_striping() %&gt;% \n    gt::tab_style(cell_fill(color=\"grey90\"), cells_row_groups()) %&gt;%\n    tab_style(cell_text(weight = 'bold'), cells_title(groups='title')) %&gt;%\n    tab_style(cell_text(weight='bold'), cells_row_groups())\n\n\n\n\n\n\n  \n    \n      Procent importuri din total generate\n    \n    \n      După categorii de cerere finală\n    \n    \n      sectoare\n      1995-2007\n      2009-2018\n      delta\n    \n  \n  \n    \n      Exporturi\n    \n    Motor vehicles, trailers and semi-trailers\n0.19%\n1.68%\n1.49%\n    Chemical and chemical products\n0.89%\n2.02%\n1.13%\n    Rubber and plastics products\n0.57%\n1.23%\n0.67%\n    Wholesale and retail trade; repair of motor vehicles\n1.66%\n2.27%\n0.61%\n    Professional, scientific and technical activities\n0.20%\n0.79%\n0.60%\n    Basic metals\n0.94%\n1.50%\n0.56%\n    IT and other information services\n0.10%\n0.63%\n0.54%\n    Computer, electronic and optical equipment\n0.58%\n1.11%\n0.52%\n    Electrical equipment\n0.66%\n1.15%\n0.50%\n    Textiles, textile products, leather and footwear\n1.73%\n0.86%\n−0.87%\n    \n      Gospodării\n    \n    Food products, beverages and tobacco\n3.30%\n4.68%\n1.38%\n    Agriculture, hunting, forestry\n1.21%\n2.36%\n1.15%\n    IT and other information services\n0.23%\n0.98%\n0.75%\n    Motor vehicles, trailers and semi-trailers\n2.07%\n2.73%\n0.65%\n    Coke and refined petroleum products\n1.26%\n1.80%\n0.55%\n    Professional, scientific and technical activities\n0.66%\n1.15%\n0.49%\n    Manufacturing nec; repair and installation of machinery and equipment\n0.67%\n1.12%\n0.45%\n    Land transport and transport via pipelines\n2.69%\n1.65%\n−1.04%\n    Mining and quarrying, energy producing products\n3.92%\n2.20%\n−1.72%\n    Textiles, textile products, leather and footwear\n5.45%\n2.77%\n−2.68%\n    \n      Investiţii\n    \n    Machinery and equipment, nec\n5.15%\n6.00%\n0.85%\n    IT and other information services\n0.72%\n1.02%\n0.29%\n    Other non-metallic mineral products\n0.55%\n0.80%\n0.25%\n    Wholesale and retail trade; repair of motor vehicles\n2.71%\n2.50%\n−0.22%\n    Fabricated metal products\n1.00%\n0.77%\n−0.23%\n    Mining and quarrying, non-energy producing products\n0.47%\n0.22%\n−0.24%\n    Electrical equipment\n1.32%\n1.05%\n−0.28%\n    Other transport equipment\n0.80%\n0.21%\n−0.59%\n    Motor vehicles, trailers and semi-trailers\n3.52%\n2.77%\n−0.75%\n    Computer, electronic and optical equipment\n3.62%\n2.17%\n−1.45%\n    \n      Stat\n    \n    Pharmaceuticals, medicinal chemical and botanical products\n0.58%\n1.07%\n0.49%\n    IT and other information services\n0.06%\n0.21%\n0.15%\n    Computer, electronic and optical equipment\n0.37%\n0.24%\n−0.13%\n    Air transport\n0.21%\n0.04%\n−0.17%\n    Paper products and printing\n0.30%\n0.12%\n−0.18%\n    Chemical and chemical products\n0.63%\n0.43%\n−0.20%\n    Wholesale and retail trade; repair of motor vehicles\n0.97%\n0.74%\n−0.23%\n    Land transport and transport via pipelines\n0.85%\n0.43%\n−0.42%\n    Mining and quarrying, energy producing products\n0.65%\n0.20%\n−0.46%\n    Textiles, textile products, leather and footwear\n0.83%\n0.24%\n−0.59%\n  \n  \n  \n\n\n\n\nAparent ne-am integrat mai bine în lanţurile de producţie auto (mai mult cu Germania) şi le-am părăsit pe cele de materii prime şi textile. La gospodării se vede o creştere a importurilor alimentare. Statul cauzează de două ori mai multe importuri de medicamente decât înainte de Criză.\n\n\nCode\nimporturi %&gt;% \n  group_by(year, component, country) %&gt;%\n  summarise(valoare=sum(valoare)) %&gt;% ungroup() %&gt;%\n  ggplot(aes(x=year, y=valoare, fill=component)) + \n  geom_col() + scale_fill_tableau() +\n  labs(title=\"Importurile după sursa de cerere finală\", \n       caption=\"Sursa: calcule pe OECD ICIO, 2021\") +\n  facet_wrap(~country, ncol=2, scales='free') +\n  scale_y_continuous(labels=scales::number_format(big.mark = \",\"))\n\n\n\n\n\n\n\n\n\nSă vedem şi contribuţia relativă la creştere sumarizată în două perioade - înainte şi după criză.\n\n\nCode\nimporturi %&gt;% group_by(year, component, country) %&gt;% \n  summarise(total=sum(valoare)) %&gt;% ungroup() %&gt;% \n  spread(component, total) %&gt;% \n  mutate(total=Exporturi+Investiţii+Gospodării+Stat) %&gt;% \n  group_by(country) %&gt;% \n  mutate(across(Exporturi:total, ~c(0, diff(.)))) %&gt;% \n  ungroup() %&gt;% \n  group_by(country, year=if_else(year&lt;2008, \"1995-2007\", \"2008-2018\")) %&gt;%\n  summarise(across(Exporturi:Stat, ~100*mean(.)/mean(total))) %&gt;% \n  drop_na() %&gt;% ungroup() %&gt;% \n  gather(3:6, key='component', value='valoare') %&gt;% \n  ggplot(aes(x=year, y=valoare, fill=component)) + \n  geom_col() + facet_wrap(~country, ncol=2, scales='free') + \n  scale_fill_tableau() + \n  labs(title=\"Contribuţia relativă la creştere a importurilor\", \n       subtitle=\"1995-2007 vs 2008-2018\", x=NULL, y=NULL, \n       caption='Sursa: OECD ICIO, 2021') + \n  scale_y_continuous(labels=scales::percent_format(scale=1))\n\n\n\n\n\n\n\n\n\nObservăm că peste tot ponderea exporturilor în rata de creştere a importurilor a crescut. Lumea devine din ce în ce mai interconectată economic."
  },
  {
    "objectID": "posts/2023-08-15-despre-profitabilitatea-multinationalelor/profitabilitatea-multionationalelor.html",
    "href": "posts/2023-08-15-despre-profitabilitatea-multinationalelor/profitabilitatea-multionationalelor.html",
    "title": "Despre profitabilitatea multinaţionalelor",
    "section": "",
    "text": "S-a tot vorbit în spaţiul public despre profitabilitatea multinaţionalelor, despre cum ar declara profituri mai mici ca să se fenteze plata impozitelor (ca şi cum cele mici n-ar face tot la fel). Totul a plecat de la un articol cu ton naţionalist virulent despre presupusele “căpuşe”, 50 de multinaţionale, care ar “suge sângele poporului român” prin neplata taxelor. Mulţi economişti autohtoni au ieşit să apere onoarea multinaţionalelor - că ar investi, că de fapt doar în 2022 au declarat profituri mai mici, că au plătit deja contribuţii sociale şi salarii, că iniţiatorul discuţiei e un analfabet economic şi funcţional, etc. Multe din aceste articole sunt în regulă şi aduc perspective necesare discuţiei. Dar nu am văzut însă o analiză sistematică a profitabilităţii firmelor mari pe subgrupuri: capital majoritar străin vs capital majoritar românesc. Şi nu doar top 50 sau top 100, ci pe toate firmele mari. Poate că firmele mari străine nu au profit neapărat mai mic decât cele româneşti, caz în care discuţia ar trebui încheiată. Sigur, există şi contrarienii: pentru ei nimic nu e bun. Dacă fac profit mai mic, mint, dacă fac profit mai mare, ne fură. Deci practic ne fură oricum o dai. Dar vom asuma că cititorul este o persoană de bună credinţă fără biasuri de acest fel. M-am gândit că e o ocazie bună să fac eu o asemenea analiză care lipseşte momentan.\nÎn acest scop am folosit baza de date a platformei listafirme.ro pentru că datele despre firme puse la dispoziţia publicului de către instituţiile statului nu conţin câmpuri referitoare la tipul de acţionariat (străin sau românesc). A trebuit să-mi fac un cont şi să plătesc circa 30 de RON pentru toate CUI-urile firmelor cu capital străin şi românesc clasificate drept “întreprinderi mari şi foarte mari”, circa 800 de firme în fiecare categorie. Apoi am folosit CUI-urile ca să identific firmele din baza de date a platformei coduricaen.ro, de data aceasta oferite gratis pentru cei cu cont (tot gratuit). Puteam folosi datele de pe data.gov.ro ca în analizele precedente, dar erau deja identificate şi prelucrate de erorile obişnuite. Singurul dezavantaj e că nu s-au actualizat încă pe anul 2022. Dar avem de la 2018 încolo.\nPentru început vom ilustra câteva statistici exploratorii prin grafice şi tabele şi apoi vom trece la modelarea statistică efectivă."
  },
  {
    "objectID": "posts/2023-08-15-despre-profitabilitatea-multinationalelor/profitabilitatea-multionationalelor.html#ocazia-articolului",
    "href": "posts/2023-08-15-despre-profitabilitatea-multinationalelor/profitabilitatea-multionationalelor.html#ocazia-articolului",
    "title": "Despre profitabilitatea multinaţionalelor",
    "section": "",
    "text": "S-a tot vorbit în spaţiul public despre profitabilitatea multinaţionalelor, despre cum ar declara profituri mai mici ca să se fenteze plata impozitelor (ca şi cum cele mici n-ar face tot la fel). Totul a plecat de la un articol cu ton naţionalist virulent despre presupusele “căpuşe”, 50 de multinaţionale, care ar “suge sângele poporului român” prin neplata taxelor. Mulţi economişti autohtoni au ieşit să apere onoarea multinaţionalelor - că ar investi, că de fapt doar în 2022 au declarat profituri mai mici, că au plătit deja contribuţii sociale şi salarii, că iniţiatorul discuţiei e un analfabet economic şi funcţional, etc. Multe din aceste articole sunt în regulă şi aduc perspective necesare discuţiei. Dar nu am văzut însă o analiză sistematică a profitabilităţii firmelor mari pe subgrupuri: capital majoritar străin vs capital majoritar românesc. Şi nu doar top 50 sau top 100, ci pe toate firmele mari. Poate că firmele mari străine nu au profit neapărat mai mic decât cele româneşti, caz în care discuţia ar trebui încheiată. Sigur, există şi contrarienii: pentru ei nimic nu e bun. Dacă fac profit mai mic, mint, dacă fac profit mai mare, ne fură. Deci practic ne fură oricum o dai. Dar vom asuma că cititorul este o persoană de bună credinţă fără biasuri de acest fel. M-am gândit că e o ocazie bună să fac eu o asemenea analiză care lipseşte momentan.\nÎn acest scop am folosit baza de date a platformei listafirme.ro pentru că datele despre firme puse la dispoziţia publicului de către instituţiile statului nu conţin câmpuri referitoare la tipul de acţionariat (străin sau românesc). A trebuit să-mi fac un cont şi să plătesc circa 30 de RON pentru toate CUI-urile firmelor cu capital străin şi românesc clasificate drept “întreprinderi mari şi foarte mari”, circa 800 de firme în fiecare categorie. Apoi am folosit CUI-urile ca să identific firmele din baza de date a platformei coduricaen.ro, de data aceasta oferite gratis pentru cei cu cont (tot gratuit). Puteam folosi datele de pe data.gov.ro ca în analizele precedente, dar erau deja identificate şi prelucrate de erorile obişnuite. Singurul dezavantaj e că nu s-au actualizat încă pe anul 2022. Dar avem de la 2018 încolo.\nPentru început vom ilustra câteva statistici exploratorii prin grafice şi tabele şi apoi vom trece la modelarea statistică efectivă."
  },
  {
    "objectID": "posts/2023-08-15-despre-profitabilitatea-multinationalelor/profitabilitatea-multionationalelor.html#analize-exploratorii",
    "href": "posts/2023-08-15-despre-profitabilitatea-multinationalelor/profitabilitatea-multionationalelor.html#analize-exploratorii",
    "title": "Despre profitabilitatea multinaţionalelor",
    "section": "2 Analize exploratorii",
    "text": "2 Analize exploratorii\n\n\nCode\nlibrary(tidyverse)\nlibrary(ggthemes)\nlibrary(gt)\nlibrary(gtExtras)\nlibrary(INLA)\nlibrary(MatchIt)\n\ntheme_set(hrbrthemes::theme_ipsum_tw(strip_text_size = 14, \n                                     strip_text_family = \"Roboto\",\n                                     strip_text_face = \"italic\",\n                                     axis_title_size = 14,\n                                     axis_text_size = 12,\n                                     base_family = \"Roboto\",\n                                     plot_title_family = \"Roboto\",\n                                     subtitle_family = \"Roboto\",\n                                     caption_family = \"Roboto\", \n                                     caption_size = 10,\n                                     plot_title_size = 16,\n                                     subtitle_size = 12) +\n  theme(legend.text = element_text(size=10), \n        legend.title = element_text(size=12),\n        legend.key.size = unit(0.6, \"cm\")))  #setam tema graficelor \n\nselectie &lt;- read_csv(here::here(\"data/post-14\", \"multinationale.csv\")) %&gt;%\n            mutate(caen = substr(CodCAEN, 1, 2) %&gt;% as.character()) %&gt;%\n            select(-CodCAEN) %&gt;% \n            inner_join(read_csv(here::here(\"data/caen.csv\")))\n\n\nSă începem cu cel mai evident lucru, o medie pe ani a profitabilităţii din cifra de afaceri.\n\n\nCode\nselectie %&gt;% \n  group_by(actionariat, year) %&gt;% \n  summarise(profit = 100*mean(ProfitNetRON, trim=0.1, na.rm=T)/mean(CifraDeAfaceriNetaRON, trim=0.1, na.rm=T)) %&gt;%\n  ungroup() %&gt;% spread(year, profit) %&gt;% gt::gt() %&gt;% \n  gtExtras::gt_theme_538() %&gt;% \n  gt::fmt_percent(2:5, decimals = 2, scale_values = FALSE)\n\n\n\n\n\n\n  \n    \n    \n      actionariat\n      2018\n      2019\n      2020\n      2021\n    \n  \n  \n    roman\n4.06%\n4.40%\n4.89%\n5.01%\n    strain\n4.05%\n3.82%\n3.88%\n4.44%\n  \n  \n  \n\n\n\n\nVedem o uşoară scădere pentru media profitabilităţii firmelor străine. Deşi în 2018 era egalitate, în ultimii ani apare un ecart uşor, mai mare în 2020 decât în 2021. Deci fără o direcţie evidentă.\nMai departe, să vizualizăm nişte distribuţii. Tot pe ani. Liniile negre orizontale sunt mediana şi cele două cuartile ale distribuţiei.\n\n\nCode\nselectie %&gt;% \n  mutate(profit = 100*ProfitNetRON/CifraDeAfaceriNetaRON) %&gt;% \n  filter(!is.infinite(profit)) %&gt;%\n  ggplot(aes(x=actionariat, y=profit)) + \n  geom_violin(draw_quantiles = c(0.25, 0.5, 0.75), fill='steelblue3', alpha=0.7) +\n  geom_jitter(width = 0.04, size=0.5) +\n  scale_y_continuous(labels=scales::percent_format(scale=1), \n                     trans = 'log10') + \n  facet_wrap(~year, ncol=2, scales='free') +\n  labs(title = \"Profitabilitatea din cifra de afaceri\", \n       subtitle=\"Întreprinderi mari şi foarte mari (N=1659)\", \n       y=\"Profitabilitate\", x=\"Acţionariat\", caption='Sursă: listafirme.ro') +\n  theme(panel.grid.minor.y = element_blank(),\n        strip.background = element_rect(fill='black', colour = 'white'),\n        strip.text=element_text(colour='white'))\n\n\n\n\n\n\n\n\n\nCe răzbate în acest grafic e similaritatea celor două distribuţii. Sunt foarte asemănătoare având în vedere ce eterogenă e orice economie, nu doar cea românească. De fapt nu e aşa surprinzător. Raportul a două variabile distribute gausian e distribuit la rândul lui după distribuţia Cauchy, o distribuţie cu “fat tails”. Distribuţia T cu un grad de libertate este tot distribuţia Cauchy, şi vom folosi distribuţia T ca să modelăm profitabilitatea (pentru că nu e tocmai gausiană după cum am spus). Gradul de libertate ales e cel care se potriveşte cel mai bine datelor. Dar până atunci, să vedem profitabilitatea după sectorul de activitate şi să numărăm câte firme din fiecare categorie sunt în fiecare range de profitabilitate. Pentru ultimul scop vom împărţi profitabilitatea în decile (intervale de 10 %) şi vom număra ce procent din total din cele două categorii se află în fiecare decilă de profitabilitate.\n\n\nCode\nselectie %&gt;% filter(year==2021) %&gt;% filter(!is.infinite(ROS), ROS&gt;0) %&gt;%\n  mutate(ROS=cut_number(ROS, n=10)) %&gt;% \n  count(ROS, actionariat) %&gt;% spread(actionariat, n) %&gt;% \n  mutate(across(roman:strain, ~100*./sum(.))) %&gt;%\n  rename(Profitabilitate=ROS) %&gt;%\n  gt::gt() %&gt;% \n  gtExtras::gt_theme_538() %&gt;% \n  gt::fmt_percent(2:3, decimals = 2, scale_values = FALSE)\n\n\n\n\n\n\n  \n    \n    \n      Profitabilitate\n      roman\n      strain\n    \n  \n  \n    [0.0122,1.06]\n9.93%\n10.19%\n    (1.06,1.99]\n9.34%\n10.59%\n    (1.99,2.96]\n8.76%\n11.13%\n    (2.96,3.94]\n10.07%\n9.92%\n    (3.94,5]\n9.05%\n10.86%\n    (5,6.38]\n9.93%\n10.05%\n    (6.38,8.23]\n9.64%\n10.32%\n    (8.23,11]\n10.07%\n9.92%\n    (11,16.4]\n10.95%\n9.12%\n    (16.4,113]\n12.26%\n7.91%\n  \n  \n  \n\n\n\n\nFoarte similare procentele, ceea ce ne spune că atât firmele străine cât şi cele româneşti se află destul de uniform distribuite în toate intervalele de profitabilitate. Doar la top 10 % cele mai profitabile firme sunt destul de multe firme româneşti vs străine. (12.26 % vs 7.91 %). Profiturile super mari tind să fie făcute de firme româneşti mai degrabă, dar nu exclusiv.\nSă vedem şi după sector.\n\n\nCode\nselectie %&gt;% group_by(year,sector) %&gt;% \n  summarise(ROS = 100*sum(ProfitNetRON)/sum(CifraDeAfaceriNetaRON)) %&gt;%\n  spread(year, ROS) %&gt;% drop_na() %&gt;% \n  gt::gt() %&gt;% \n  gtExtras::gt_theme_538() %&gt;% \n  gt::fmt_percent(2:5, decimals = 2, scale_values = FALSE) %&gt;%\n  gtExtras::gt_color_rows(columns=2:5)\n\n\n\n\n\n\n  \n    \n    \n      sector\n      2018\n      2019\n      2020\n      2021\n    \n  \n  \n    Activităţi profesionale\n7.88%\n5.82%\n7.86%\n8.87%\n    Administraţie publică & apărare\n2.50%\n1.86%\n1.60%\n1.79%\n    Agricultura\n6.12%\n5.01%\n3.50%\n4.02%\n    Alte servicii\n4.85%\n3.52%\n5.89%\n7.81%\n    Apă, salubritate, deşeuri\n6.65%\n5.70%\n5.87%\n6.55%\n    Comerţ\n3.41%\n3.39%\n3.80%\n4.01%\n    Construcţii\n5.41%\n7.44%\n6.24%\n7.94%\n    Energie\n8.48%\n8.43%\n10.11%\n8.80%\n    Finanţe & Asigurări\n49.63%\n14.28%\n310.18%\n61.61%\n    HORECA\n10.65%\n11.82%\n5.80%\n9.00%\n    Industrie extractivă\n22.10%\n17.72%\n13.56%\n15.16%\n    Industrie prelucrătoare\n5.19%\n4.21%\n4.78%\n5.34%\n    ITC\n4.96%\n6.83%\n6.70%\n7.29%\n    Recreative\n13.22%\n13.78%\n5.68%\n9.98%\n    Sănătate & asistenţă socială\n3.86%\n3.62%\n5.02%\n6.71%\n    Servicii administrative & suport\n4.55%\n5.10%\n5.58%\n6.34%\n    Transport şi depozitare\n6.21%\n5.87%\n4.47%\n4.41%\n    Tranzacţii imobiliare\n9.62%\n13.74%\n15.52%\n17.50%\n  \n  \n  \n\n\n\n\nSe pare că avem marje destul de diferite între sectoare şi ar trebui să ţinem cont şi de această variabilă în comparaţii.\nDat fiind că avem date referitoare la salariaţi şi cotă de piaţă (un indicator important al gradului de oligopol/monopol) şi sector de activitate trecem la modelarea statistică. Încercăm să ajustăm printr-o regresie robustă la outlieri (cu distribuţia T-student cum am zis, cu cinci grade de libertate care a fost selectată ca fiind cea mai potrivită) la numărul de salariaţi, cota de piaţă şi sectorul de activitate. Mai jos este modelul sumarizat.\n\n\nCode\nmodel_total &lt;- brms::brm(log10(ROS) ~ (1|sector)+actionariat + \n                          log10(Salariati) +\n                          log10(CotaDePiata), \n              data=selectie %&gt;% filter(!is.infinite(ROS)) %&gt;% \n                   filter(Salariati&gt;0, CotaDePiata&gt;0, ROS&gt;0, year==2021), \n              family = \"student\", backend = \"cmdstanr\")\nmodel_total\n\n\n Family: student \n  Links: mu = identity; sigma = identity; nu = identity \nFormula: log10(ROS) ~ (1 | sector) + actionariat + log10(Salariati) + log10(CotaDePiata) \n   Data: selectie %&gt;% filter(!is.infinite(ROS)) %&gt;% filter( (Number of observations: 1410) \n  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;\n         total post-warmup draws = 4000\n\nGroup-Level Effects: \n~sector (Number of levels: 18) \n              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\nsd(Intercept)     0.15      0.04     0.09     0.25 1.00     1258     1863\n\nPopulation-Level Effects: \n                  Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\nIntercept             1.24      0.09     1.07     1.42 1.00     2486     2734\nactionariatstrain    -0.08      0.03    -0.13    -0.03 1.00     4042     2972\nlog10Salariati       -0.18      0.03    -0.24    -0.12 1.00     3740     2716\nlog10CotaDePiata      0.09      0.02     0.05     0.13 1.00     3814     3076\n\nFamily Specific Parameters: \n      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\nsigma     0.38      0.01     0.36     0.41 1.00     2819     2659\nnu        5.22      0.75     3.97     6.99 1.00     2848     2864\n\nDraws were sampled using sample(hmc). For each parameter, Bulk_ESS\nand Tail_ESS are effective sample size measures, and Rhat is the potential\nscale reduction factor on split chains (at convergence, Rhat = 1).\n\n\nAu fost logaritmate şi variabilele independente şi cea dependentă (profitabilitatea) pentru a avea distribuţii cât de cât simetrice şi pe aceiaşi scală numerică. Altfel estimarea va avea de suferit. Avem deci un model dublu-logaritmic (coeficienţii au semnificaţia unor elasticităţi) cu erori robuste şi potrivit pentru ‘fat tails’. Ce observăm ? Cota de piaţă se asociază pozitiv cu profitabilitatea (logic), iar mărimea prin numărul de salariaţi negativ (de asemenea de aşteptat cumva). Acţionariatul străin scade cu 0.08 % profitabilitatea per firmă ajustat la cotă, salariaţi şi sector. E o diferenţă mai mică decât a relevat analiza simplă a mediilor pe ani. Doar că avem aici şi un interval de încredere aici, între -0.13 % şi -0.02 %. Acest lucru înseamnă că statistic suntem destul de siguri că acţionariatul străin are un efect negativ asupra profitabilităţii doar că efectul poate fi destul de mic, mult mai mic de 0.08 %, practic neglijabil. Trebuie să comparăm mere cu mere şi pere cu pere. Dar ne permite oare metoda de mai sus să facem acest lucru ?\nNu întocmai. Regresiile simple de acest fel suferă de ceea ce se cheamă “model dependence”: specificaţiile funcţionale ale covariatelor (cota şi salariaţii) ne dictează în mare măsură efectul descoperit. Cu alte cuvinte dacă am fi asumat polinomiale sau alte funcţii pentru cotă şi salariaţi, efectul ar fi fost altul. Nu vrem ca nişte specificaţii “out of the box” să ne afecteze interpretarea prea mult. Ca să evităm acest lucru încercăm o tehnică de inferenţă cauzală (quasi-experimentală) numită matching."
  },
  {
    "objectID": "posts/2023-08-15-despre-profitabilitatea-multinationalelor/profitabilitatea-multionationalelor.html#inferenţă-cauzală-prin-matching",
    "href": "posts/2023-08-15-despre-profitabilitatea-multinationalelor/profitabilitatea-multionationalelor.html#inferenţă-cauzală-prin-matching",
    "title": "Despre profitabilitatea multinaţionalelor",
    "section": "3 Inferenţă cauzală prin matching",
    "text": "3 Inferenţă cauzală prin matching\nMatching-ul încearcă să asocieze observaţii similare din punct de vedere al covariatelor (cotă şi salariaţi, de exemplu) din cele două grupuri. Astfel, într-o versiune de matching (există multiple forme şi algoritmi) o observaţie din grupul de firme româneşti primeşte cea mai apropiată observaţie din grupul de firme străine şi tot aşa. Fiecare observaţie primeşte o “greutate”, un fel de coeficient în funcţie de distanţele dintre ele, greutate care e folosită în modelul regresiei prin OLS şi astfel obţinem efectul “cauzal”. Nu am intrat în detalii prea tehnice pentru a nu lungi o discuţie deja lungă.\n\n\nCode\ndf &lt;- selectie %&gt;% \n  mutate(actionariat_num=as.factor(actionariat) %&gt;% \n           as.integer(.) %&gt;% `-`(., 1)) %&gt;% \n  filter(!is.infinite(ROS)) %&gt;% \n  filter(Salariati&gt;0, CotaDePiata&gt;0, year==2021, ROS&gt;0)\n\nm &lt;- matchit(actionariat_num ~ log10(Salariati) + log10(CotaDePiata),\n                  data=df,\n                  method = \"full\", distance = \"mahalanobis\")\n\noutcome &lt;- lm(log10(ROS) ~ actionariat, data=match.data(m),weights=weights) \n\n\nImpactul cauzal conform acestui model este de numai -0.077 %, semnificativă statistic, deviaţia standard a efectului fiind de 0.027 %. Practic nu mai mult decât -0.12 % este de aşteptat să fie impactul acţionariatului străin asupra profitabilităţii firmei. Practic la fel ca metoda regresiei.\nOricum ar fi, că optăm pentru modelul quasi-cauzal, cel al ajustării prin regresie simplă sau chiar media neajustată, diferenţa este, cred eu, mică şi nu poate fi spus mare lucru pe seama ei. Ca de obicei, pe teme economice e mult zgomot care acoperă o realitate mai complexă şi mai frustrantă pentru cei ce vânează slogane şi soluţii simple. Profitabilitatea nu e un indicator care să trezească suspiciuni vis-a-vis de practicile de business ale marilor corporaţii străine, aşa cum am arătat aici. Mai interesant e că circa 20-25 % din ele declară profit mai mic de 1 % în aceşti ani. Cele româneşti 21.5 %, cele străine 25.4 %. Deci departe de a ne “fura” NUMAI străinii."
  },
  {
    "objectID": "posts/2023-08-15-despre-profitabilitatea-multinationalelor/profitabilitatea-multionationalelor.html#completare",
    "href": "posts/2023-08-15-despre-profitabilitatea-multinationalelor/profitabilitatea-multionationalelor.html#completare",
    "title": "Despre profitabilitatea multinaţionalelor",
    "section": "4 Completare !",
    "text": "4 Completare !\nDe fapt coeficientul calculat pentru acţionariat are efect multiplicativ (din cauza logaritmilor) şi trebuie exponenţiat în baza 10. Practic profitabilitatea firmelor străine este 83.7 % din cea a firmelor româneşti (\\(10^{-0.07}\\)), cu limite între 74.6 % şi 94.6 %. Acum e mai aproape de ceea ce spune media simplă. Pentru anul 2018, profitabilitatea e mai mare la cea străine, din nou în corcondanţă cu ce spune media simplă. Deci analiza nu ne ajută foarte mult, profiturile sunt variabile, ceea ce e şi de aşteptat."
  }
]